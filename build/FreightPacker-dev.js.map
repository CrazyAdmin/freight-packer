{"version":3,"sources":["webpack:///webpack/bootstrap 0053528f91b80ec8befb","webpack:///./src/api/utils/cik/Utils.js","webpack:///./src/api/utils/cik/Signaler.js","webpack:///./src/api/utils/cik/Logger.js","webpack:///./src/api/utils/cik/config/datGUIConsole.js","webpack:///./src/api/components/assets/Asset.js","webpack:///./src/api/components/box/BoxEntry.js","webpack:///./src/api/components/common/CargoEntry.js","webpack:///./src/api/packer/cub/Components.js","webpack:///./src/api/utils/cik/config/Config.js","webpack:///./src/api/packer/container/Container.js","webpack:///./src/api/packer/cub/Region.js","webpack:///./src/api/components/LightDispatcher.js","webpack:///./src/api/App.js","webpack:///./src/api/packer/Packer.js","webpack:///./src/api/packer/container/ContainingVolume.js","webpack:///./src/api/packer/cub/PackedComponents.js","webpack:///./src/api/view/SceneSetup.js","webpack:///./src/api/scene/Camera.js","webpack:///./src/api/utils/cik/Tween.js","webpack:///./src/api/utils/cik/Pool.js","webpack:///./src/api/view/CargoBoxView.js","webpack:///./src/api/view/CargoView.js","webpack:///./src/api/UX.js","webpack:///./src/api/view/CargoListView.js","webpack:///./src/api/utils/cik/config/Smart.js","webpack:///./src/api/utils/cik/config/Control3D.js","webpack:///./src/api/packer/cub/RegionsTree.js","webpack:///./src/api/packer/cub/Heuristic.js","webpack:///./src/api/components/box/Dimensions.js","webpack:///./src/api/Resources.js","webpack:///./src/api/packer/CargoGroup.js","webpack:///./src/api/utils/cik/config/UIUtils.js","webpack:///./src/api/packer/CargoList.js","webpack:///./src/api/packer/PackingSpace.js","webpack:///(webpack)/buildin/global.js","webpack:///./src/api/utils/cik/input/UpdateComponent.js","webpack:///./src/api/utils/cik/input/RaycastGroup.js","webpack:///./src/api/scene/Controller.js","webpack:///./src/api/view/EntryInputView.js","webpack:///./src/api/components/common/TextField.js","webpack:///./src/api/view/components/TextLabelView.js","webpack:///./src/api/Constants.js","webpack:///./src/api/utils/cik/config/datGUIExtensions.js","webpack:///./src/api/packer/cub/Math2D.js","webpack:///./src/api/packer/cub/CUBDebug.js","webpack:///./src/api/debug/Debug.js","webpack:///./src/api/view/PackingSpaceView.js","webpack:///./src/api/view/ContainerView.js","webpack:///./src/api/view/PackResultView.js","webpack:///./src/api/view/dom/DomUI.js","webpack:///./src/api/components/CargoInput.js","webpack:///./src/api/components/PackingSpaceInput.js","webpack:///./src/api/components/PackerInterface.js","webpack:///./src/dev.js","webpack:///./src/FreightPacker.js","webpack:///./src/api/utils/Capabilities.js","webpack:///./src/api/utils/cik/input/Input.js","webpack:///./src/min-dependencies/lib/keypress.js","webpack:///./src/api/utils/cik/Quality.js","webpack:///./src/api/scene/Renderer.js","webpack:///./src/min-dependencies/lib/three/controls/OrbitControls.js","webpack:///./src/api/view/HUDView.js","webpack:///./src/api/scene/Transform.js","webpack:///./src/api/components/box/PackingProperty.js","webpack:///./src/api/components/assets/ColorTemplate.js","webpack:///./src/api/utils/cik/transitions/Transition.js","webpack:///./src/api/components/Visualization.js","webpack:///./src/api/components/User.js","webpack:///./src/api/packer/Cargo.js","webpack:///./src/api/view/components/FloatingShelf.js","webpack:///./src/api/view/components/Outline.js","webpack:///./src/min-dependencies/lib/three/controls/TransformControls.js","webpack:///./src/api/packer/container/Volume.js","webpack:///./src/api/packer/cub/CUB.js","webpack:///./src/api/packer/afit/AFitTest.js","webpack:///./src/api/packer/afit/components/Item.js","webpack:///./src/api/packer/afit/components/Container.js","webpack:///./src/api/packer/cub/HeuLessWaste.js","webpack:///./src/api/packer/cub/HeuRegular.js","webpack:///./src/api/packer/cub/HeuParametric1.js","webpack:///./src/api/view/View.js","webpack:///./src/api/view/PackedCargoBoxView.js","webpack:///./src/api/view/components/Musipack.js","webpack:///./src/api/view/OrthoviewsNavigator.js"],"names":["trimVariableRegex","RegExp","twopi","Math","PI","goldenRatio","sqrt","goldenRatioConjugate","typeofObject","Utils","object","constructor","classProperties","instanceProperties","prototype","def","Object","assign","defineProperties","getOwnPropertyDescriptors","target","source","keys","forEach","key","AssignUndefined","undefined","obj","JSON","parse","stringify","element","style","window","getComputedStyle","marginLeft","parseFloat","marginTop","paddingLeft","paddingTop","x","y","input","replace","str","length","substring","i","len","divisions","callback","da","a","cos","b","sin","nc","ns","t","c","d","color","THREE","Color","r","g","z","set","base","vector","fixed","toFixed","w","Signaler","signals","dispatches","event","args","On","push","eventCallbacks","once","splice","indexOf","callbacks","index","logType","trace","normal","warn","logTypeLabel","defaultPrintFilter","programStartTime","Date","now","messages","warnOnce","Message","type","timestamp","content","arg","json","substr","err","Logger","message","_active","AddLog","_toConsole","_traceToConsole","groupCollapsed","console","groupEnd","log","id","Log","Warn","filter","output","ToString","value","active","defaultGUIParams","publish","dat","guis","controllers","Controller","label","onChangeCallback","onChange","valueProp","get","defineProperty","list","isFunction","step","listen","updateDisplay","GUI","params","data","__controllers","__folders","add","controller","toString","addFolder","folder","open","domElement","document","createElement","result","iKey","listProp","destroy","SolidMaterialType","MeshStandardMaterial","TransparentMaterialType","InvisibleMaterialType","MeshBasicMaterial","defaultGeometry","CubeGeometry","defaultMeshMaterial","objectLoader","ObjectLoader","jsonLoader","JSONLoader","castShadow","receiveShadow","colorTemplates","Map","signaler","resourcesSet","_resources","Symbol","Asset","url","material","mapName","Promise","resolve","reject","OnIncludingPrior","texture","Texture","TextureLoader","load","resources","texturesPath","roughness","metalness","geometry","mesh","Mesh","modified","setHex","getHex","reduce","clamp","opacity","transparent","texturePath","CastReceiveShadow","traverse","child","colors","template","ColorTemplate","Dispatch","CreateColorTemplate","numEntries","getDefaultLabel","epsilon","pow","numberType","BoxEntry","dimensions","Dimensions","weight","quantity","properties","stacking","StackingProperty","rotation","RotationConstraint","translation","TranslationConstraint","descriptions","TextField","Reset","defaultContent","clear","entry","Copy","field","own","Clone","Assert","CargoEntry","_weight","uid","generateUUID","has","delete","typeofNumber","_maxHeight","_validOrientations","orientations","Item","width","height","validOrientations","stackingCapacity","grounded","volume","orientation","xyz","zyx","yxz","yzx","zxy","xzy","vo","toLowerCase","maxHeight","GetOrientedDimensions","items","minDimensions","Number","MAX_SAFE_INTEGER","iItem","numItems","item","iOrient","Container","weightCapacity","serializeModes","none","property","min","max","createKeyInfo","isFolderGrouped","propertyPath","split","slice","join","shift","owner","getKey","setKey","val","endKey","download","filename","file","Blob","navigator","msSaveOrOpenBlob","URL","createObjectURL","href","body","appendChild","click","setTimeout","removeChild","revokeObjectURL","defaultEditParams","save","debug","Shortcut","Config","shortcutsGUI","shortcuts","instances","ignoreKeys","isController","keyInfo","keyValue","ignoredKey","saveValue","isColor","parseInt","toJSON","Update","Snapshot","guiChanged","gui","require","default","autoPlace","editing","updateAll","find","addFunction","addColor","call","scope","editor","Save","Debug","Serialize","defaultsFolder","serializeMode","unrolled","subProperties","subProperty","category","shortcut","Add","combinedVolume","ContainingVolume","volumes","WarnOnce","numVolumes","minX","minY","minZ","maxX","MIN_SAFE_INTEGER","maxY","maxZ","combinedWeightCapacity","pos","position","dim","container","Set","containingVolume","FromJSON","setRectangleWeights","rect","Array","smallValue","smallValueSqrt","maxWeightValue","Region","preferredX","SetWeights","region","offset","h","l","tempCorners","tempPoints","px","py","pz","subRegion","rx","ry","rz","rw","rh","rl","other","tempRegion","fit","weightFit","minRegionAxis","newRegions","axis","size","east","west","over","south","ptsA","GetFloorPoints","ptsB","tempPoints2","adjacent","intersections","iA","nextA","ax","az","nax","naz","iB","nextB","bx","bz","nbx","nbz","intersection","rectangles","rectA","p1","p2","p3","p4","rectB","format","nf","n","numberFormat","_signals","_dispatches","LightDispatcher","start","App","containerDiv","ux","cargoInput","packingSpaceInput","packerInterface","packerParams","packer","Packer","extendedParams","CargoInput","insert","boxEntry","cargoList","modify","Modify","SolveAgain","remove","Remove","PackingSpaceInput","containerLoaded","packingSpace","AddContainer","PackerInterface","solveRequest","solverParams","Solve","domUI","DomUI","sceneSetup","SceneSetup","Init","then","Start","bind","viewParams","view","View","_Bind","resetColor","show","existingEntry","GetEntry","previewColorBackup","Description","hud","Preview","hideEntryPreview","hide","onPackUpdate","packingResult","_Notify","solved","packUpdate","onPackFailed","error","failed","packFailed","autoUpdatePack","solveAgain","ClearPackingResults","PackedCargo","UnpackedCargo","unpackedQuantity","PackingResult","numTotalItems","runtime","packed","unpacked","defaultParams","_solverParams","PackingSpace","CargoList","solverExecutionsCount","algorithm","algorithmParams","SolveCUB","ready","current","entries","groups","values","group","enabled","allowedOrientations","capacity","defaultStackingFactor","CUB","startTime","performance","pack","cubRuntime","cubRuntime2Dec","round","packedItems","packedItem","ref","Vector3","packedWidth","packedHeight","packedLength","ResolveOrientation","packedCargo","unpackedItems","unpackedItem","unpackedCargo","_weightCapacity","SetUID","Volume","PackedItem","PackedContainer","cumulatedWeight","placement","numPackedItems","iPacked","packedRegion","tempRegion2","intersects","Intersects","init","started","paused","stopped","quality","Quality","Common","units","controllerParams","sceneController","rendererParams","clearColor","backgroundColor","sceneRenderer","Renderer","renderer","toneMappingExposure","cameraParams","fov","aspect","near","far","cameraController","Camera","OrbitControls","Input","camera","sceneRendererRef","appCameraRef","onResize","screen","ReconfigureViewport","hudParams","hudCameraParams","HUDView","hudCameraRef","AdjustCamera","autoClear","setupParams","gridHelper","SetTarget","GridHelper","AddDefault","configure","Configure","scene1","scene","camera1","scene2","camera2","animationFrameID","requestAnimationFrame","Render","clearDepth","screenNeedsUpdate","cameraNeedsUpdate","cancelAnimationFrame","Dispose","helpers","ambientLight","AmbientLight","directionalLight","DirectionalLight","ambientContainer","directionalLightComplem","onGUIChanged","dl","shadow","updateProjectionMatrix","UpdateShadowMaps","map","mapSize","manhattanDistanceTo","copy","dispose","dlHelper","update","dlCameraHelper","Smart","Control3D","smart","MakeShortcut","lightController","shadowControllers","shadowCameraControllers","Unroll","DirectionalLightHelper","CameraHelper","global","clone","appControl3D","control","hudControl3D","toggle","toggleOrbitOwner","orbitControls","Hold","Release","hudCam","print","config","VecToString","rotationProperties","rotationControllers","Multiple","tempCoords","ownCoords","center","tempVec3","tempVec3_b","change","userChange","PerspectiveCamera","name","changed","dollyAnimation","Tween","Combo","RequestN","functions","ease","easeInOutQuad","lookAt","onDollyAnimationComplete","onComplete","Hook","fovAnimation","onFOVAnimationComplete","fpsControls","Navigation","FirstPerson","speed","speedX","speedY","damping","momentum","limitPhi","moveSpeed","keyControls","controls","lookTarget","getWorldDirection","multiplyScalar","addEventListener","e","distanceTo","v","subVectors","saveState","reset","maxDistance","maxPolarAngle","autoRotate","LerpRotation","FirstPersonControls","point","quat","Quaternion","applyQuaternion","getWorldQuaternion","normalize","box3","distanceMultiplier","extent","getSize","frameSize","distance","abs","getCenter","coords","CalcFrameCoords","duration","endCoords","TransitionFromToCoords","startCoords","SetDurations","p","SetStartValues","tp","SetDeltas","Restart","deltaFOV","startValue","delta","TweenCallback","time","TweenCompletedCallback","clock","Clock","poolNewFN","poolResetFN","tween","pool","Pool","linear","easeOutElastic","ts","tc","easeOutQuad","easeOutCubic","special","pingPong","TweenComboCompletedCallback","TweenCombo","tweens","completed","Unhook","Return","startValue0","delta0","startValue1","delta1","startValue2","delta2","tween0","Request","tween1","tween2","combo","getElapsedTime","endValue","_new","_reset","fnNew","fnReset","objects","unitCubeGeometry","BoxBufferGeometry","materialTemplate","flatShading","brightnessRange","hueBase","random","nextColor","setHSL","GoldenSeries","_materialSettings","_color","typeofString","CargoBoxView","colorHex","scale","vec3","labelView","s","SetScale","RestoreMaterial","SetMaterialFocus","focus","CargoView","dummyGeometry","SphereBufferGeometry","dummyMaterial","_entry","_focus","Object3D","floor","tlvParams","font","backColor","fontColor","textAlign","sidePadding","ratioToX","TextLabelView","rotateY","rotateX","UpdateText","cargoView","scaleRefFigure","Constants","man","UX","app","visualization","Visualization","user","User","_selectedEntryUID","labels","tempBox","Box3","tempVec","sort","select","deselect","interact","outlineOffset","CargoListView","templatesView","cargoTemplateViews","fsParams","padding","ColorTemplates","Apply","floatingShelf","FloatingShelf","raycastGroupItems","raycastGroup","RaycastGroup","OnInteract","outline","Outline","offsetFactor","slidingAnimation","originalPosition","onAnimationComplete","templateCargoView","ticketParams","Dummy","UpdateItems","Sort","ReflectEntry","SetOutline","raycastGroupIndex","box","entryUID","GetTemplate","targetY","deltaY","CargoGroup","cargoGroup","textColor","textLabelView","SortMapBySize","updateMatrixWorld","worldToLocal","Matrix4","getInverse","matrixWorld","cargoes","next","done","setFromObject","applyMatrix4","halfSize","Compare","onFocus","onFocusLost","draggable","Draggable","closeBtn","onclick","Hide","ui","Element","Delete","UpdateGUI","visible","SetCurrent","oldPos","GetPosition","SetPosition","Show","AddStyle","styles","UIWiggleAnim","folderName","Track","Edit","iFocus","folders","spaces","world","local","modes","translate","rotate","defaultControls","TransformControls","renderOrder","attach","detach","Detach","space","setMode","RegionsTree","root","regions","thisArg","numRegions","iRegion","search","Subtract","regionIndex","debugUIDs","toInt","coordID","levels","neighbours","regionA","jRegion","regionB","numNeighbours","iNeighbour","neighbourA","jNeighbour","neighbourB","connectedNeighbours","ConnectFloorRects","yCat","levelsYCats","iYCat","numYCats","level","regionY","regionHeight","iRect","numRects","newRegion","volumeA","volumeB","ContainsRegion","sortFunction","HeuristicResult","containingRegion","_workingSet","Heuristic","Result","_vec3","Resources","Cargo","currentQuantity","stopPropagation","stylesheet","createCSS","css","getElementsByTagName","innerHTML","UIFitContent","UIHideMenu","UIDraggable","UIDHeader","UIDCloseButton","_domElement","removeEventListener","RemoveStyle","text","attributes","_span","_Span","crel","eStyle","cssText","widths","small","medium","large","title","dom","move","xpos","ypos","left","top","diffX","diffY","eWi","eHe","cWi","cHe","onMouseMove","evt","posX","clientX","posY","clientY","aX","aY","startMoving","parentNode","divTop","divLeft","cursor","stopMoving","domStyle","head","header","onmousedown","onmouseup","close","Close","EnableChildInput","elt","stringType","groupAdded","groupRemoved","groupModified","containerAdded","_currentIndex","containers","currentIndex","UpdateComponent","interval","lastUpdateTime","collectionQuery","updateProperty","recursive","raycastItems","GetRaycastItems","rItem","Cik","raycastItem","raycaster","UpdateRaycastItems","intersectObjects","raycastItemIndex","BubbleUpForIndex","collection","nestLimit","numCollection","parent","itemsContainer","miscContainer","defaults","Scene","objName","getObjectByName","tempBox3","_scaleFigure","scaleFigure","woman","EntryInputView","preview","previewTypes","offsetX","side","DoubleSide","SetTextureMap","alphaMap","repeat","setX","refMesh","PlaneGeometry","bkgMesh","depthWrite","depthFunc","NeverDepth","transition","Transition","slideIn","Slide","slideOut","onTransitionComplete","transitionController","complete","valid","End","children","boxView","previewing","deltaTime","tlWatchTimer","tlWatchEntries","tlWatchUpdater","newValue","propertyName","savedValue","tl","addTLWatch","setInterval","_value","TextLabel","GetString","textLabel","canvas2d","context2d","getContext","fillStyle","fillRect","textBaseline","fillText","CanvasTexture","minFilter","LinearFilter","anisotropy","image","needsUpdate","OnChange","Label","guiExtensions","blockEvent","CreateCSS","datDisabled","_onGUIEvent","folderKeys","closed","onGUIEvent","hasAttribute","setAttribute","parentElement","removeAttribute","enumerable","enable","disabled","_tooltip","class","classList","setTooltip","tooltip","segmentIntersect","x1","y1","x2","y2","x3","y3","x4","y4","denominator","ua","ub","linesIntersect","ay","by","cx","cy","dx","dy","a1","b1","c1","a2","b2","c2","determinant","rectangleContainsPoint","rectangleContainsRectangle","ox","oy","ow","oh","rectanglesFromPoints","points","xs","xCat","ys","iY","sortYCat","xsKeys","iX","intersectedXs","xCat1","ys1","iX2","xCat2","ys2","yIntersect","xIntersect","iY1","iY2","iIX","intersectedX","rectangle","reduceRectangles","ra","aw","ah","jRect","rb","bw","bh","segmentContainsPoint","vx","vy","vxa","vya","vxb","vyb","db","sleep","debugLog","keypress","debugRegion","debugClear","debugging","ListenKeys","ms","force","execute","tid","clearTimeout","solid","checkered","debugUID","Viz","DrawVolume","Boolean","uids","RemoveObjectByUID","ClearAll","numberFormatDefault","nStr","delay","debugGeometry","debugMaterial","wrapS","wrapT","RepeatWrapping","debugBox","DebugBox","alphaHexMask","debugObjects","tVec3","tPos","tScale","DebugViz","wireframe","packingSpaceView","packResultView","cargoViews","o","AFitTest","Box","api","yRotation","makeRotationY","tempMatrix4","PackingSpaceView","containerViews","containerView","ContainerView","cv","containingVolumeUID","iCView","iCVolume","FindContainingVolume","identity","makeTranslation","ContainerBox","createContainerBoxes","boxes","CreateMesh","BackSide","polygonOffset","polygonOffsetFactor","polygonOffsetUnits","views","WeakMap","initializationBox3","StandardSceneObject","containerBoxes","platformMesh","planeGeom","BoxGeometry","planeMaterial","CreateSolidMaterialMatte","ReceiveShadow","object3d","animationDuration","packedCargoView","PackedCargoBoxView","Extend","getOrientationAngles","getOrientationEuler","rad","Euler","packVizStart","packVizEnd","cargoVizCreate","cargoVizPack","cargoVizUnpack","PackResultView","cargoListView","animatingViews","Pizzicato","musipack","matrix","GetMatrix","decompose","packedQuantities","zEntry","delayPerItem","cargoViewTemplate","packedQuantity","totalQuantity","UpdateLabel","SetRotationAngles","posTweenCombo","onTweenComplete","OnCargoFirstTweenComplete","extraData","unpackedOffset","numUnpackedItems","j","OnTweenComplete","scaleTweenCombo","DisableHighlights","Highlight","numCargoViews","cvEntry","halfHeight","low","high","animatingView","fn","nodeType","textContent","attrMapString","isNodeString","isElementString","isType","isNode","Node","ownerDocument","isElement","isArray","subChild","createTextNode","arguments","settings","childIndex","argumentsLength","attributeMap","attr","Proxy","proxy","defaultFormatParams","orthoViewSelected","orthoviews","home","front","icons","margin","dispatch","icon","right","imageURL","div","onmouseover","backgroundPositionX","onmouseout","preventDefault","_cargoList","boxEntryPool","renewBoxEntry","GetNextColor","entryMirror","IsVolume","Abs","commitedEntry","existing","sliderValueChange","sliderValueStop","createContainerView","model","thickness","PlatformVisibility","jsonObject","ResultSpace","ResultEntry","packingSpaces","totalPacked","totalUnpacked","solveDuration","toInterfaceResults","getSpace","containerUID","ps","packEntry","resultEntry","isFirst","defaultSolverParams","FreightPacker","utils","devSetup","domain","fp","toConsole","traceToConsole","SetViewParent","auto","uxParams","cargoInputParams","packingSpaceInputParams","appParams","webgl","Capabilities","IsWebGLReady","canvas","gl","WebGLRenderingContext","defaultKeysListen","concat","domContainer","_camera","_mouse","mouseScreen","Vector2","mouseViewport","mouseDelta","lastMouseDownTime","ComputeScreen","Raycaster","_raycastGroups","Update25","Update10","OnMouseDown","OnDoubleClick","OnMouseUp","OnRightClick","OnClick","updateComponents","fireOnce","onMouseDown","onMouseUp","onRightClick","onDoubleClick","onClick","onDrag","onDragEvent","mouseEvent","sx","sy","minDist","onDragStatus","doubleClickTime","OnMouseMove","thisOnMouseWheel","OnMouseWheel","attachEvent","OnScroll","OnResize","keyboard","Listener","on","simple_combo","unregister","unregister_combo","register_combo","prevent_repeat","on_keydown","on_keyup","getBoundingClientRect","bottom","button","UpdateScreenAndMouse","_dridMouseDown","AbortDelayedAction","_status","DelayedAction","_mouseDownDelayed","UpdateRaycast","ExecuteDelayedMD","distanceToSquared","noMouseDrag","m","wheelDelta","detail","lerp","isNaN","eventType","iCallback","FireOnce","UpdateRaycaster","iUpdate","updateComponent","OnMouseDrag","LerpZoom","action","drid","_repeats","clearInterval","intersectObject","groupID","setFromCamera","raycastGroupsKeys","numRaycastGroups","reverse","iGroup","Raycast","_change_keycodes_by_browser","_compare_arrays","_compare_arrays_sorted","_convert_key_to_readable","_convert_to_shifted_key","_decide_meta_key","_factory_defaults","_filter_array","_index_of_in_array","_is_array_in_array","_is_array_in_array_sorted","_key_is_valid","_keycode_alternate_names","_keycode_dictionary","_keycode_shifted_keys","_log_error","_metakey","_modifier_event_mapping","_modifier_keys","_validate_combo","__hasProp","hasOwnProperty","__indexOf","is_unordered","is_counting","is_exclusive","is_solitary","prevent_default","dictionary","count","allows_key_repeat","keyup_fired","attach_handler","jQuery","should_suppress_event_defaults","should_force_event_defaults","sequence_delay","_registered_combos","_keys_down","_active_combos","_sequence","_sequence_timer","_prevent_capture","_defaults","handler","keydown_event","_this","_receive_input","_bug_catcher","keyup_event","blur_event","_i","_len","_ref","_key_up","remove_handler","removeEvent","_ref1","keyCode","_cmd_bug_check","combo_keys","_prevent_default","should_prevent","returnValue","_get_active_combos","active_combos","keys_down","down_key","_match_combo_arrays","match","_fuzzy_match_combo_arrays","_get_potential_combos","potentials","is_sequence","_add_to_active_combos","active_combo","active_key","active_keys","already_replaced","combo_key","should_prepend","should_replace","_j","_k","_len1","unshift","_remove_from_active_combos","_get_possible_sequences","matches","sequence","_ref2","_add_key_to_sequence","sequence_combos","_get_sequence","seq_key","is_keydown","_key_down","_fire","key_event","is_autorepeat","potential_match","match_handler","source_combo","_keys_remain","keys_remain","combos","event_mod","mod","potential","potential_combos","sequence_combo","shifted_key","_handle_combo_down","is_other_exclusive","potential_combo","active_combos_length","unshifted_key","_l","_len2","_ref3","shiftKey","_handle_combo_up","keys_remaining","counting_combo","count_callback","combo_dictionary","register_many","combo_array","_results","keys_or_combo","unregister_many","get_registered_combos","stop_listening","get_meta_key","userAgent","k","array","prev","apply","valid_key","_","alt_name","mod_key","non_modifier_keys","validated","define","exports","testCallback","composer","antialias","shadows","renderSizeMul","OnTestComplete","shadowMapType","PCFSoftShadowMap","shadowsAutoUpdate","WebGLRenderer","shadowMap","autoUpdate","physicallyCorrectLights","gammaInput","gammaOutput","toneMapping","Uncharted2ToneMapping","maxTextureSize","context","getParameter","MAX_TEXTURE_SIZE","pixelRatio","devicePixelRatio","setPixelRatio","setClearColor","ResizeRenderer","newWidth","newHeight","setSize","render","ResizeDomElement","UseComposer","EffectComposer","renderPass","RenderPass","renderToScreen","addPass","renderPasses","UseCamera","ignoredAreas","minDistance","Infinity","minZoom","maxZoom","minPolarAngle","minAzimuthAngle","maxAzimuthAngle","enableDamping","dampingFactor","enableZoom","zoomSpeed","enableRotate","rotateSpeed","enablePan","panningMode","ScreenSpacePanning","keyPanSpeed","autoRotateSpeed","enableKeys","LEFT","UP","RIGHT","BOTTOM","mouseButtons","ORBIT","MOUSE","ZOOM","MIDDLE","PAN","target0","position0","zoom0","zoom","getPolarAngle","spherical","phi","getAzimuthalAngle","theta","dispatchEvent","changeEvent","state","STATE","NONE","setFromUnitVectors","up","quatInverse","inverse","lastPosition","lastQuaternion","sub","setFromVector3","rotateLeft","getAutoRotationAngle","sphericalDelta","makeSafe","radius","panOffset","setFromSpherical","zoomChanged","EPS","dot","quaternion","onContextMenu","onMouseWheel","onTouchStart","onTouchEnd","onTouchMove","onKeyDown","startEvent","endEvent","ROTATE","DOLLY","TOUCH_ROTATE","TOUCH_DOLLY","TOUCH_PAN","Spherical","rotateStart","rotateEnd","rotateDelta","panStart","panEnd","panDelta","dollyStart","dollyEnd","dollyDelta","getZoomScale","angle","rotateUp","panLeft","objectMatrix","setFromMatrixColumn","panUp","HorizontalPanning","crossVectors","pan","deltaX","isPerspectiveCamera","targetDistance","tan","clientHeight","isOrthographicCamera","clientWidth","dollyIn","dollyScale","dollyOut","handleMouseDownRotate","handleMouseDownDolly","handleMouseDownPan","handleMouseMoveRotate","handleMouseMoveDolly","handleMouseMovePan","handleMouseUp","handleMouseWheel","handleKeyDown","handleTouchStartRotate","touches","pageX","pageY","handleTouchStartDolly","handleTouchStartPan","handleTouchMoveRotate","handleTouchMoveDolly","handleTouchMovePan","handleTouchEnd","checkIgnoredAreas","rects","ContainsPoint","create","EventDispatcher","noZoom","noRotate","noPan","noKeys","staticMoving","dynamicDampingFactor","defaultCamTRS","Transform","cameraTransform","entryInputViewParams","entryInputView","_position","_rotation","transform","_enabled","PackingProperty","prop","Constraint","_allowedOrientations","allowX","allowY","allowZ","allowed","allowWH","allowLH","allowWL","findNearest","dMin","nearest","vz","tempColor","mapColor","Material","TransitionController","from","to","bounds","OnComplete","_controller","boundsView","transformView","_app","PackResults","Slice","visualizationSignals","packResults","highlightPackedInstances","Select","SelectEntry","boxEntryInteract","onCargoInteract","cargoEntry","PackingItem","cargo","targetView","cubeGeometry","outlineMaterial","depthTest","boxOutlineMaterial","offsetUnits","outlines","Disable","oChild","outlineReady","boxMaterial","boxMesh","addScalar","applyMatrix","GizmoMaterial","parameters","FrontSide","setValues","oldColor","oldOpacity","highlight","highlighted","setRGB","GizmoLineMaterial","LineBasicMaterial","linewidth","pickerMaterial","TransformGizmo","handles","pickers","planes","planeGeometry","PlaneBufferGeometry","activePlane","setupGizmos","gizmoMap","handleGizmos","pickerGizmos","updateMatrix","tempGeometry","eye","vec1","vec2","lookAtMatrix","setFromRotationMatrix","setFromEuler","TransformGizmoTranslate","arrowGeometry","Geometry","CylinderGeometry","merge","lineXGeometry","BufferGeometry","addAttribute","Float32BufferAttribute","lineYGeometry","lineZGeometry","X","Line","Y","Z","XYZ","OctahedronGeometry","XY","YZ","XZ","CylinderBufferGeometry","setActivePlane","tempMatrix","extractRotation","TransformGizmoRotate","CircleGeometry","facing","arc","vertices","E","XYZE","TorusBufferGeometry","eye2","worldRotation","tempQuaternion","unitX","unitY","unitZ","quaternionX","quaternionY","quaternionZ","makeRotationFromQuaternion","setFromAxisAngle","atan2","multiplyQuaternions","TransformGizmoScale","translationSnap","rotationSnap","_mode","_dragging","_gizmo","gizmoObj","mouseDownEvent","mouseUpEvent","mode","objectChangeEvent","ray","pointerVector","offsetRotation","tempVector","quaternionXYZ","quaternionE","oldPosition","oldScale","oldRotationMatrix","parentRotationMatrix","parentScale","worldPosition","worldRotationMatrix","camPosition","camRotation","onPointerDown","onPointerHover","onPointerMove","onPointerUp","getMode","setTranslationSnap","setRotationSnap","setSpace","setFromMatrixPosition","OrthographicCamera","pointer","changedTouches","intersect","planeIntersect","setFromMatrixScale","multiply","cross","angleTo","TouchEvent","_box3","setFromCenterAndSize","packingAssistant","PackingAssistant","heuLessWaste","HeuLessWaste","heuParametric1","heuParams","HeuParametric1","Params","heuristics","minZ_weight","minWaste_weight","defaultPackingAssitantParams","minDimensionsNoWasteFactor","packedContainer","firstRegion","regionsTree","workingItem","harsh","itemVolume","regionRemains","Occupy","ProcessRegionsPerPackedItem","containerWidth","containerHeight","ProcessRegionsPreferredX","ProcessRegionsMergeExpand","ProcessRegionsForPackedItems","ProcessRegionsForZeroRegions","ProcessRegionsEnclosed","SortDeepestSmallest","WeightPass","Fit","unpackItem","Unpack","packItem","Pack","workingSet","heuRegular","HeuRegular","ProcessRegions","FitUsingHeuristic","toItems","TestData","containerData","ID","Name","Length","Width","Height","itemsData","Quantity","WeightCapacity","StackingCapacity","almost","n1","n2","dim1","dim2","dim3","IsPacked","Dim1","Dim2","Dim3","CoordX","CoordY","CoordZ","PackDimX","PackDimY","PackDimZ","sortByN","rateFit","containerLength","minZScore","minWasteScore","scoreW","scoreH","scoreL","score","highestScoreFunction","regionScoreTable","orientationScoreTable","volumeItem","dummyRegion","regionFitTest","FitTest","orientationScore","regionScore","pop","workingItems","VolumeSort","GetMinDimensionsOverall","testSuccessfulRegions","Find","highestScore","highestScored","GetPlacementWithHighestScore","firstFitFunction","firstFit","HeuParametric1Params","cubParams","cub","HeuParametric1Set","bestFit","GetBestFit","transitionDuration","paddingZ","paddingY","orthoviewsNavigator","Navigate","OrthoviewsNavigator","DisplayPackingResult","CreateOrthoViewsIcons","OnOrthoViewSelected","lights","DefaultLights","light","dlData","Load","dlComp","orthoviewsNavParams","onContainerAdded","TransitionToFrame","containerSize","AddRaycastGroup","onCargoListViewChanged","listViewCenterX","getWorldPosition","centerX","onCargoGroupAdded","onCargoGroupRemoved","onCargoGroupModified","UpdateGroup","boundingView","HUDSetup","Clear","viewType","Toggle","unitCubeEdgeGeometry","EdgesGeometry","wireframeMaterialTemplate","_wireMaterialSettings","meshMaterial","blending","NormalBlending","wireMesh","LineSegments","tempRange","Range","halfLength","range","frequency","_playing","_iid","Note","wave","Sound","options","play","onNoteComplete","Stop","stop","note","Toner","ranges","divs","divLength","Evaluate","GetNote","Play","RelaseNote","Musipack","toner","Once","OnItemPacked","OnItemUnpacked","EvaluateItem","Coords","tempCamOffset","_cargoListView","_boundingView","changeFOV","slideDown","SlideUp","SlideDown","TransitionToFOV"],"mappings":"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","file":"FreightPacker-dev.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 53);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0053528f91b80ec8befb","\r\nconst trimVariableRegex = new RegExp(/(?:\\d|_|-)+$/);\r\nconst twopi = 2 * Math.PI;\r\nconst goldenRatio = (1 + Math.sqrt(5)) / 2;\r\nconst goldenRatioConjugate = goldenRatio - 1;\r\n\r\nconst typeofObject = 'object';\r\n\r\nclass Utils {\r\n\r\n    static Redefine(object, constructor){\r\n        var classProperties = object;\r\n        var instanceProperties = object.prototype;\r\n    \r\n        var def = constructor(instanceProperties);\r\n    \r\n        Object.assign(def, classProperties);\r\n        Object.assign(def.prototype, instanceProperties);\r\n        Object.defineProperties(def, Object.getOwnPropertyDescriptors(classProperties));\r\n        Object.defineProperties(def.prototype, Object.getOwnPropertyDescriptors(instanceProperties));\r\n\r\n        return def;\r\n    }\r\n\r\n    /**\r\n     * @template T\r\n     * @param {T} target \r\n     * @param {Object} source \r\n     * @returns {T}\r\n     */\r\n    static AssignUndefined(target, source){\r\n        if(typeof target !== typeofObject){\r\n            target = {};\r\n            Object.assign(target, source);\r\n            return target;\r\n        }\r\n\r\n        var keys = Object.keys(source);\r\n        keys.forEach(key => {\r\n            if(typeof source[key] === typeofObject) Utils.AssignUndefined(target[key], source[key]);\r\n            if(target[key] === undefined) target[key] = source[key];\r\n        });\r\n        return target;\r\n    }\r\n\r\n    static Snapshot(obj){\r\n        return JSON.parse(JSON.stringify(obj));\r\n    }\r\n\r\n    static GetRectOffset(element){\r\n        var style = window.getComputedStyle(element),\r\n            marginLeft = parseFloat(style.marginLeft),\r\n            marginTop = parseFloat(style.marginTop),\r\n            paddingLeft = parseFloat(style.paddingLeft),\r\n            paddingTop = parseFloat(style.paddingTop);\r\n        return {x: marginLeft + paddingLeft, y: marginTop + paddingTop};\r\n    }\r\n\r\n    static TrimVariable(input){\r\n        return input.replace(trimVariableRegex, '');\r\n    }\r\n\r\n    static LimitString(str, length){\r\n        if(str.length > length) str = str.substring(str.length - length);\r\n        return str;\r\n    }\r\n\r\n    static LoopIndex(i, len){\r\n        i = i % len;\r\n        if(i < 0) i = len + i;\r\n        return i;\r\n    }\r\n\r\n    static FastCircleLoop(divisions, callback){\r\n        // ref: http://iquilezles.org/www/articles/sincos/sincos.htm\r\n        var da = twopi / divisions;\r\n        var a = Math.cos(da);\r\n        var b = Math.sin(da);\r\n        var cos = 1;\r\n        var sin = 0;\r\n        for( var i = 0; i < divisions; i++ )\r\n        {\r\n            var nc = a*cos - b*sin;\r\n            var ns = b*cos + a*sin;\r\n            cos = nc;\r\n            sin = ns;\r\n            callback(cos, sin);\r\n        }\r\n    }\r\n\r\n    static ColorPaletteAsVec3(t, a, b, c, d, color){\r\n        // ref: http://iquilezles.org/www/articles/palettes/palettes.htm\r\n        // return a + b * cos( 6.28318 * ( c * t + d ) );\r\n        color = color || new THREE.Color();\r\n        var r = a.x + b.x * Math.cos( twopi * (c.x * t + d.x) ), \r\n            g = a.y + b.y * Math.cos( twopi * (c.y * t + d.y) ),\r\n            b = a.z + b.z * Math.cos( twopi * (c.z * t + d.z) );\r\n        return color.set(r, g, b);\r\n    }\r\n\r\n    /**\r\n     * Returns the next value [0, 1] in the golden series\r\n     * @param {Number} base \r\n     */\r\n    static GoldenSeries(base){\r\n\t\treturn (base + goldenRatioConjugate) % 1;\r\n    }\r\n\r\n    static VecToString(vector, fixed){\r\n        fixed = fixed || 8;\r\n        return vector.x.toFixed(fixed) + ', ' + vector.y.toFixed(fixed) + (vector.z !== undefined ? ', ' + vector.z.toFixed(fixed) + (vector.w !== undefined ? ', ' + vector.w.toFixed(fixed) : '') : '');\r\n    }\r\n}\r\n\r\nexport default Utils;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/Utils.js","\r\n/** SignalerCallback \r\n * @callback SignalerCallback\r\n * @param {Array<*>} args\r\n */\r\n\r\nclass Signaler {\r\n    constructor(){\r\n        /** @type {Array<SignalerCallback>} */\r\n        this.signals = {};\r\n        /** @type {Array<string>} */\r\n        this.dispatches = {};\r\n    }\r\n\r\n    /** @param {string} event @param {SignalerCallback} callback */\r\n    OnIncludingPrior(event, callback){\r\n        var args = this.dispatches[event];\r\n        if(args){\r\n            callback(...args);\r\n        }\r\n        else{\r\n            this.On(event, callback);\r\n        }\r\n    }\r\n\r\n    /** @param {string} event @param {SignalerCallback} callback */\r\n    On(event, callback){\r\n        if(this.signals[event] === undefined){\r\n            this.signals[event] = [];\r\n        }\r\n        this.signals[event].push(callback);\r\n    }\r\n\r\n    /** @param {string} event @param {SignalerCallback} callback */\r\n    Once(event, callback){\r\n        if(this.signals[event] === undefined){\r\n            this.signals[event] = [];\r\n        }\r\n        let eventCallbacks = this.signals[event];\r\n        let once;\r\n        once = function(...args){\r\n            eventCallbacks.splice(eventCallbacks.indexOf(once), 1);\r\n            callback(...args);\r\n        };\r\n        eventCallbacks.push(once);\r\n    }\r\n\r\n    /** @param {string} event @param {SignalerCallback} callback */\r\n    Off(event, callback){\r\n        var callbacks = this.signals[event];\r\n        if(callbacks){\r\n            var index = callbacks.indexOf(callback);\r\n            if(index != -1){\r\n                callbacks.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @param {string} event @param {Array<*>} [args] */\r\n    Dispatch(event, ...args){\r\n        this.dispatches[event] = args;\r\n        var callbacks = this.signals[event];\r\n        if(callbacks){\r\n            for(var i = 0, len = callbacks.length; i < len; i++){\r\n                callbacks[i](...args);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default Signaler;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/Signaler.js","import Utils from \"./Utils\";\r\n\r\nconst logType = {\r\n    trace: 0,\r\n    normal: 1,\r\n    warn: 2\r\n};\r\n\r\nconst logTypeLabel = {\r\n    0: 'Trace',\r\n    1: 'Log',\r\n    2: 'Warn'\r\n};\r\n\r\nconst defaultPrintFilter = {\r\n    0: true,\r\n    1: true,\r\n    2: true\r\n};\r\n\r\nvar programStartTime = Date.now();\r\nvar messages = [];\r\nvar warnOnce = {};\r\n\r\nclass Message {\r\n    constructor(type, ...args){\r\n        this.type = type;\r\n        this.timestamp = Date.now();\r\n        this.content = [];\r\n        args.forEach(arg => {\r\n            if(typeof arg === 'string'){\r\n                this.content.push(arg);\r\n            }\r\n            else{\r\n                try{\r\n                    var json = JSON.stringify(arg).substr(0, 2000);\r\n                    this.content.push(json);\r\n                }\r\n                catch(err){\r\n                    this.content.push('  parse error: ' + err);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    ToString(){\r\n        return ((this.timestamp - programStartTime) / 1000).toFixed(2) + ' ' + logTypeLabel[this.type];\r\n    }\r\n}\r\n\r\nclass Logger {\r\n\r\n    static set active(value){\r\n        this._active = value;\r\n    }\r\n\r\n    static set toConsole(value){\r\n        this._toConsole = value;\r\n    }\r\n\r\n    static set traceToConsole(value){\r\n        this._traceToConsole = value;\r\n    }\r\n\r\n    static AddLog(message){\r\n        messages.push(message);\r\n    }\r\n\r\n    static Trace(...args){\r\n        if(this._active){\r\n            var message = new Message(logType.trace, ...args);\r\n            this.AddLog(message);\r\n            if(this._toConsole || this._traceToConsole){\r\n                console.groupCollapsed(...args);\r\n                console.trace('stack');\r\n                console.groupEnd();\r\n            }\r\n        }\r\n    }\r\n\r\n    static Log(...args){\r\n        if(this._active){\r\n            var message = new Message(logType.normal, ...args);\r\n            this.AddLog(message);\r\n            if(this._toConsole){\r\n                console.log(...args);\r\n            }\r\n        }\r\n    }\r\n\r\n    static Warn(...args){\r\n        if(this._active){\r\n            var message = new Message(logType.warn, ...args);\r\n            this.AddLog(message);\r\n            if(this._toConsole) console.warn(...args);\r\n        }\r\n    }\r\n\r\n    static LogOnce(id, ...args){\r\n        if(this._active && !warnOnce[id]){\r\n            warnOnce[id] = true;\r\n            Logger.Log(...args);\r\n        }\r\n    }\r\n\r\n    static WarnOnce(id, ...args){\r\n        if(this._active && !warnOnce[id]){\r\n            warnOnce[id] = true;\r\n            Logger.Warn(...args);\r\n        }\r\n    }\r\n\r\n    static Print(filter){\r\n        Utils.AssignUndefined(filter, defaultPrintFilter);\r\n\r\n        var output = 'Log:\\n';\r\n        messages.forEach(message => {\r\n            if(filter[message.type]){\r\n                output += message.ToString() + '\\n';\r\n            }\r\n        });\r\n\r\n        return output;\r\n    }\r\n}\r\n\r\nLogger.active = true;\r\n\r\nexport default Logger;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/Logger.js","\r\n// dat.GUI console mirroring\r\n// Access with >> dat.list\r\n\r\nimport Utils from \"../Utils\";\r\n\r\nvar defaultGUIParams = {publish: true, key: ''};\r\n\r\nvar dat = {\r\n    guis: [],\r\n\r\n    controllers: {\r\n        Controller: function(target, key){\r\n\r\n            this.label = key;\r\n\r\n            var onChangeCallback;\r\n            this.onChange = function(callback){\r\n                onChangeCallback = callback;\r\n            };\r\n\r\n            let valueProp = {\r\n                get: function(){\r\n                    return target[key];\r\n                },\r\n                set: function(value){\r\n                    target[key] = value;\r\n                    if(onChangeCallback)\r\n                        onChangeCallback();\r\n                }\r\n            };\r\n            Object.defineProperty(this, 'value', valueProp);\r\n\r\n            Object.defineProperties(this, {\r\n                list: {\r\n                    get: (function(){\r\n                        let isFunction = typeof target[key] === 'function';\r\n                        if(isFunction){\r\n                            return function(){\r\n                                return {\r\n                                    get: function(){\r\n                                        target[key]();\r\n                                        return target[key];\r\n                                    }\r\n                                };\r\n                            };\r\n                        }\r\n                        else{\r\n                            return function(){\r\n                                return valueProp;\r\n                            };\r\n                        }\r\n                    })()\r\n                }\r\n            });\r\n\r\n            this.step = function(){return this;};\r\n            this.listen = function(){return this;};\r\n            this.updateDisplay = function(){return this;};\r\n        }\r\n    },\r\n\r\n    GUI: function(params){\r\n        this.i = 0;\r\n        this.data = {};\r\n        this.__controllers = [];\r\n        this.__folders = [];\r\n\r\n        params = Utils.AssignUndefined(params, defaultGUIParams);\r\n\r\n        this.label = params.label;\r\n\r\n        if(params.publish)\r\n            dat.guis.push(this);\r\n\r\n        this.add = function(target, key){\r\n            let controller = new dat.controllers.Controller(target, key);\r\n            this.__controllers.push(controller);\r\n            let isFunction = typeof target[key] === 'function';\r\n            this.data[(this.i++).toString() + ') ' + controller.label + (isFunction ? '()' : '')] = controller;\r\n            return controller;\r\n        };\r\n\r\n        this.addFolder = function(label){\r\n            let folder = new dat.GUI({publish: false, key: label});\r\n            this.__folders.push(folder);\r\n            this.data[(this.i++).toString() + ') >> ' + label] = folder;\r\n            return folder;\r\n        };\r\n\r\n        this.open = function(){return this;};\r\n\r\n        Object.defineProperties(this, {\r\n            domElement: {\r\n                get: function(){\r\n                    return document.createElement('div');\r\n                }\r\n            },\r\n            list: {\r\n                get: function(){\r\n                    let result = {};\r\n                    let keys = Object.keys(this.data);\r\n                    let data = this.data;\r\n                    for(var iKey = 0; iKey < keys.length; iKey++){\r\n                        let key = keys[iKey];\r\n                        let listProp = data[key].list;\r\n                        Object.defineProperty(result, key, listProp.get ? \r\n                            listProp :\r\n                            {\r\n                                get: function(){\r\n                                    return listProp;\r\n                                }\r\n                            }\r\n                        );\r\n                    }\r\n                    return result;\r\n                }\r\n            }\r\n        });\r\n\r\n        this.destroy = function(){\r\n            var index = dat.guis.indexOf(this);\r\n            if(index !== -1)\r\n                dat.guis.splice(index, 1);\r\n        };\r\n    }\r\n};\r\n\r\nObject.defineProperties(dat, {\r\n    list: {\r\n        get: function(){\r\n            let result = [];\r\n            for(var i = 0; i < this.guis.length; i++){\r\n                result[i] = this.guis[i].list;\r\n            }\r\n            return result;\r\n        }\r\n    }\r\n});\r\n\r\nexport default dat;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/config/datGUIConsole.js","import ColorTemplate from \"./ColorTemplate\";\r\nimport Signaler from \"../../utils/cik/Signaler\";\r\nimport Resources from \"../../Resources\";\r\n\r\nconst SolidMaterialType = THREE.MeshStandardMaterial;\r\nconst TransparentMaterialType = THREE.MeshStandardMaterial;\r\nconst InvisibleMaterialType = THREE.MeshBasicMaterial;\r\n\r\nconst defaultGeometry = new THREE.CubeGeometry(1, 1, 1);\r\nconst defaultMeshMaterial = new SolidMaterialType({color: 0xaaaaaa});\r\n\r\nconst objectLoader = new THREE.ObjectLoader();\r\nconst jsonLoader = new THREE.JSONLoader();\r\n\r\nconst castShadow = true;\r\nconst receiveShadow = true;\r\n\r\n/** @type {Map<string, ColorTemplate>} */\r\nvar colorTemplates = new Map();\r\n\r\nvar signaler = new Signaler();\r\nconst signals = {\r\n    resourcesSet: 'resourcesSet'\r\n};\r\n\r\nconst _resources = Symbol('resources');\r\n\r\nclass Asset {\r\n    constructor(){\r\n\r\n    }\r\n\r\n    /** @param {Resources} value */\r\n    static set resources(value){\r\n        Asset[_resources] = value;\r\n        signaler.Dispatch(signals.resourcesSet);\r\n    }\r\n\r\n    static get resources(){ return Asset[_resources]; }\r\n\r\n    /**\r\n     * @param {string} url \r\n     * @param {THREE.Material} material \r\n     * @param {string} mapName \r\n     * @returns {Promise<THREE.Texture>}\r\n     */\r\n    static SetTextureMap(url, material, mapName){\r\n        return new Promise( (resolve, reject) => {\r\n            signaler.OnIncludingPrior(signals.resourcesSet, () => {\r\n                let texture = material[mapName];\r\n                if(texture instanceof THREE.Texture || texture === null){\r\n                    material[mapName] = new THREE.TextureLoader().load(Asset.resources.texturesPath + url, resolve, undefined, reject);\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @param {Number} color hex\r\n     */\r\n    static CreateSolidMaterialMatte(color){\r\n        return new Asset.SolidMaterialType({color: color, roughness: 1, metalness: .2});\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {THREE.Geometry|THREE.BufferGeometry} geometry \r\n     * @param {THREE.Material} [material]\r\n     */\r\n    static CreateMesh(geometry, material){\r\n        geometry = geometry || defaultGeometry;\r\n        material = material || defaultMeshMaterial;\r\n\r\n        var mesh = new THREE.Mesh(geometry, material);\r\n        return mesh;\r\n    }\r\n\r\n    static RestoreMaterial(material, modified){\r\n        if(modified === undefined) return;\r\n\r\n        let keys = Object.keys(modified);\r\n        for(let i = 0; i < keys.length; i++){\r\n            let key = keys[i];\r\n            if(material[key] !== undefined){\r\n                if(material[key].setHex){\r\n                    /** @type {THREE.Color} */\r\n                    let color = material.color;\r\n                    color.setHex(modified[key]);\r\n                }\r\n                else{\r\n                    material[key] = modified[key];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    static SetMaterialFocus(material, value, modified){\r\n\r\n        /** @type {THREE.Color} */\r\n        let color = material.color;\r\n        if(color !== undefined){\r\n            if(modified) modified.color = color.getHex();\r\n\r\n            let reduce = (value - 1) / 4;\r\n            color.r = THREE.Math.clamp(color.r - reduce, 0, 1);\r\n            color.g = THREE.Math.clamp(color.g - reduce, 0, 1);\r\n            color.b = THREE.Math.clamp(color.b - reduce, 0, 1);\r\n        }\r\n\r\n        /** @type {Number} */\r\n        let opacity = material.opacity;\r\n        if(opacity !== undefined){\r\n            if(modified){\r\n                modified.opacity = opacity;\r\n                modified.transparent = material.transparent;\r\n            }\r\n\r\n            material.opacity = THREE.Math.clamp(material.opacity * value, 0, 1);;\r\n            material.transparent = material.opacity < 1;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @typedef GeometryJSONReturn\r\n     * @property {THREE.Geometry|THREE.BufferGeometry} geometry\r\n     * @property {Array<THREE.Material>} [materials]\r\n     * \r\n     * @param {Object} json - Representing Geometry or BufferGeometry json data\r\n     * @param {string} [texturePath] - optional texture url \r\n     * @returns {GeometryJSONReturn}\r\n     */\r\n    static FromGeometryJSON(json, texturePath){\r\n        return jsonLoader.parse(json, texturePath);\r\n    }\r\n\r\n    /**\r\n     * @param {Object} json \r\n     * @returns {THREE.Object3D}\r\n     */\r\n    static FromJSON(json){\r\n        return objectLoader.parse(json);\r\n    }\r\n\r\n    /** @param {THREE.Object3D} object */\r\n    static StandardSceneObject(object){\r\n        Asset.CastReceiveShadow(object);\r\n    }\r\n\r\n    /** @param {THREE.Object3D} object @param {Boolean} [value] */\r\n    static CastReceiveShadow(object, value){\r\n        object.traverse(function(child){\r\n            if(child instanceof THREE.Mesh){\r\n                child.castShadow = value === undefined ? castShadow : value;\r\n                child.receiveShadow = value === undefined ? receiveShadow : value;\r\n            }\r\n        });\r\n    }\r\n\r\n    /** @param {THREE.Object3D} object @param {Boolean} [value] */\r\n    static ReceiveShadow(object, value){\r\n        if(value === undefined) value = receiveShadow;\r\n        object.traverse(function(child){\r\n            if(child instanceof THREE.Mesh){\r\n                child.receiveShadow = value;\r\n            }\r\n        });\r\n    }\r\n\r\n    /** @param {THREE.Object3D} object @param {Boolean} [value] */\r\n    static CastShadow(object, value){\r\n        if(value === undefined) value = castShadow;\r\n        object.traverse(function(child){\r\n            if(child instanceof THREE.Mesh){\r\n                child.castShadow = value;\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @param {string} key \r\n     * @param {Array<string|THREE.Color>} colors \r\n     */\r\n    static CreateColorTemplate(key, ...colors){\r\n        var template = new ColorTemplate(...colors);\r\n        colorTemplates.set(key, template);\r\n    }\r\n\r\n    /**\r\n     * @param {string} key \r\n     */\r\n    static ColorTemplates(key){\r\n        return colorTemplates.get(key);\r\n    }\r\n\r\n}\r\n\r\nAsset.SolidMaterialType = SolidMaterialType;\r\nAsset.TransparentMaterialType = TransparentMaterialType;\r\nAsset.InvisibleMaterialType = InvisibleMaterialType;\r\n\r\nAsset.CreateColorTemplate('Containers', 0x020202, 0x7f7f7f, 0xffffff);\r\n\r\nexport default Asset;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/assets/Asset.js","import { StackingProperty, RotationConstraint, TranslationConstraint } from \"./PackingProperty\";\r\nimport Dimensions from \"./Dimensions\";\r\nimport TextField from \"../common/TextField\";\r\nimport CargoEntry from \"../common/CargoEntry\";\r\n\r\n/**\r\n * @typedef {Object} BoxEntryProperties\r\n * @property {StackingProperty} stacking\r\n * @property {RotationConstraint} rotation\r\n * @property {TranslationConstraint} translation\r\n */\r\n\r\nvar numEntries = 0;\r\nfunction getDefaultLabel(){\r\n    return 'Box ' + numEntries.toString();\r\n}\r\n\r\nconst epsilon = Math.pow(2, -52);\r\nconst numberType = 'number';\r\n\r\nclass BoxEntry extends CargoEntry {\r\n    constructor(){\r\n        numEntries++;\r\n\r\n        super();\r\n        this.type = 'BoxEntry';\r\n\r\n        this.dimensions = new Dimensions(0, 0, 0);\r\n\r\n        this.weight = 0;\r\n        this.quantity = 1;\r\n        \r\n        /**\r\n         * @type {BoxEntryProperties}\r\n         */\r\n        this.properties;\r\n\r\n        this.properties.stacking    = new StackingProperty();\r\n        this.properties.rotation    = new RotationConstraint();\r\n        this.properties.translation = new TranslationConstraint();\r\n        \r\n        this.descriptions.set('label', new TextField('label', getDefaultLabel()));\r\n    }\r\n\r\n    set weight(value){ super.weight = value; }\r\n    get weight(){\r\n        return super.weight;\r\n    }\r\n\r\n    /**\r\n     * @returns {string}\r\n     */\r\n    get label(){\r\n        var field = this.descriptions.get('label');\r\n        return field ? field.content : undefined;\r\n    }\r\n\r\n    set label(value){\r\n        var field = this.descriptions.get('label');\r\n        if(field)\r\n            field.content = value;\r\n        else\r\n            this.descriptions.set('label', new TextField('label', value));\r\n    }\r\n\r\n    Reset(){\r\n        this.weight = 0;\r\n        this.quantity = 1;\r\n\r\n        this.properties.stacking.Reset();\r\n        this.properties.rotation.Reset();\r\n        this.properties.translation.Reset();\r\n\r\n        var label = this.descriptions.get('label');\r\n        label.content = TextField.defaultContent;\r\n        this.descriptions.clear();\r\n        this.descriptions.set('label', label);\r\n    }\r\n\r\n    /**\r\n     * @param {BoxEntry} entry \r\n     */\r\n    Copy(entry){\r\n        this.dimensions.Copy(entry.dimensions);\r\n        this.weight = entry.weight;\r\n        this.quantity = entry.quantity;\r\n\r\n        this.properties.stacking.Copy(entry.properties.stacking);\r\n        this.properties.rotation.Copy(entry.properties.rotation);\r\n        this.properties.translation.Copy(entry.properties.translation);\r\n\r\n        for(var [key, field] of entry.descriptions){\r\n            let own = this.descriptions.get(key);\r\n            if(own)\r\n                own.Copy(field);\r\n            else\r\n                this.descriptions.set(key, field.Clone());\r\n        }\r\n    }\r\n\r\n    Clone(){\r\n        var entry = new BoxEntry();\r\n        \r\n        entry.dimensions = this.dimensions.Clone();\r\n\r\n        entry.weight = this.weight;\r\n        entry.quantity = this.quantity;\r\n\r\n        entry.properties.stacking      = this.properties.stacking.Clone();\r\n        entry.properties.rotation       = this.properties.rotation.Clone();\r\n        entry.properties.translation    = this.properties.translation.Clone();\r\n\r\n        for(var [key, field] of this.descriptions){\r\n            entry.descriptions.set(key, field.Clone());\r\n        }\r\n\r\n        return entry;\r\n    }\r\n\r\n    ToString(){\r\n        return '\\'' + this.descriptions.get('label').content + '\\': ' + this.dimensions.ToString();\r\n    }\r\n\r\n    /**\r\n     * @param {BoxEntry} entry \r\n     */\r\n    static Assert(entry){\r\n        return entry instanceof BoxEntry\r\n            && Dimensions.Assert(entry.dimensions)\r\n            && entry.properties\r\n            && entry.descriptions\r\n            && entry.weight !== undefined\r\n            && entry.quantity !== undefined\r\n                && typeof entry.weight === numberType\r\n                && typeof entry.quantity === numberType\r\n                && StackingProperty.Assert(entry.properties.stacking)\r\n                && RotationConstraint.Assert(entry.properties.rotation)\r\n                && TranslationConstraint.Assert(entry.properties.translation)\r\n        ;\r\n    }\r\n}\r\n\r\nBoxEntry.StackingProperty = StackingProperty;\r\nBoxEntry.RotationConstraint = RotationConstraint;\r\nBoxEntry.TranslationConstraint = TranslationConstraint;\r\n\r\nexport default BoxEntry;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/box/BoxEntry.js","import TextField from \"./TextField\";\r\nimport Logger from \"../../utils/cik/Logger\";\r\n\r\nconst _weight = Symbol('weight');\r\n\r\nclass CargoEntry {\r\n    constructor(){\r\n        this.type = 'CargoEntry';\r\n\r\n        this.quantity = 0;\r\n        this.properties = {};\r\n        this.uid = '';\r\n        this[_weight] = 0;\r\n\r\n        /**\r\n         * @type {Map<string, TextField>}\r\n         */\r\n        this.descriptions = new Map();\r\n    }\r\n\r\n    /** @returns {Number} */\r\n    get weight(){ return this[_weight]; }\r\n    set weight(value){ this[_weight] = value; }\r\n\r\n    /**\r\n     * @param {string} [uid] - You'll rarely need to provide this\r\n     */\r\n    SetUID(uid){\r\n        this.uid = uid || THREE.Math.generateUUID();\r\n        return this.uid;\r\n    }\r\n\r\n    /** @param {string} key @param {string} [value] ommit value param to get description content instead of setting it */\r\n    Description(key, value){\r\n        let d = this.descriptions.get(key);\r\n        if(d){\r\n            if(value === undefined) return d.content;\r\n\r\n            d.content = value;\r\n        }\r\n        else{\r\n            if(value === undefined) return false;\r\n\r\n            d = new TextField(key, value);\r\n            this.descriptions.set(key, d);\r\n        }\r\n    }\r\n\r\n    /** @param {string} key */\r\n    DeleteDescription(key){\r\n        if( this.descriptions.has(key) ) this.descriptions.delete(key);\r\n    }\r\n\r\n    Copy(entry){\r\n        Logger.Warn('CargoEntry.Copy is not implemented');\r\n    }\r\n\r\n    Clone(){\r\n        Logger.Warn('CargoEntry.Clone is not implemented');\r\n    }\r\n\r\n    ToString(){\r\n        \r\n    }\r\n}\r\n\r\nexport default CargoEntry;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/common/CargoEntry.js","\r\nconst typeofNumber = 'number';\r\n\r\nconst _maxHeight = Symbol('maxHeight');\r\nconst _validOrientations = Symbol('validOrientations');\r\n\r\nconst orientations = [ 'xyz', 'zyx', 'yxz', 'yzx', 'zxy', 'xzy' ];\r\nvar dimensions = [0, 0, 0];\r\n\r\nclass Item{\r\n    /**\r\n     * @param {string} id \r\n     * @param {Number} width \r\n     * @param {Number} height \r\n     * @param {Number} length \r\n     * @param {Number} weight \r\n     * @param {Number} quantity \r\n     * @param {Array<Number|string>} validOrientations\r\n     * @param {Number} stackingCapacity \r\n     * @param {Boolean} grounded \r\n     */\r\n    constructor(id, width, height, length, weight, quantity, validOrientations, stackingCapacity, grounded){\r\n        this.id = id;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.length = length;\r\n        this.weight = weight;\r\n        /** @type {Number} */\r\n        this.volume = width * height * length;\r\n        this.quantity = quantity;\r\n\r\n        this.validOrientations = validOrientations;\r\n\r\n        this.stackingCapacity = stackingCapacity;\r\n        this.grounded = grounded;\r\n    }\r\n\r\n    /** @returns {Array<Number>} */\r\n    get validOrientations(){ return this[_validOrientations]; }\r\n    set validOrientations(value){\r\n        if(!value) value = orientations;\r\n\r\n        let validOrientations = [];\r\n        for(let i = 0; i < value.length; i++){\r\n            let vo = value[i];\r\n            let orientation = (typeof vo === typeofNumber) ? vo : orientations.indexOf(vo.toLowerCase());\r\n            if(orientation !== -1) validOrientations.push(orientation);\r\n        }\r\n\r\n        if(validOrientations.length === 0) validOrientations[0] = 'xyz' || orientations[0];\r\n\r\n        this[_validOrientations] = validOrientations;\r\n        this[_maxHeight] = undefined;\r\n    }\r\n\r\n    get xyz(){ dimensions[0] = this.width; dimensions[1] = this.height; dimensions[2] = this.length; return dimensions; }\r\n    get zyx(){ dimensions[0] = this.length; dimensions[1] = this.height; dimensions[2] = this.width; return dimensions; }\r\n    get yxz(){ dimensions[0] = this.height; dimensions[1] = this.width; dimensions[2] = this.length; return dimensions; }\r\n    get yzx(){ dimensions[0] = this.height; dimensions[1] = this.length; dimensions[2] = this.width; return dimensions; }\r\n    get zxy(){ dimensions[0] = this.length; dimensions[1] = this.width; dimensions[2] = this.height; return dimensions; }\r\n    get xzy(){ dimensions[0] = this.width; dimensions[1] = this.length; dimensions[2] = this.height; return dimensions; }\r\n\r\n    /** @returns {Number} */\r\n    get maxHeight(){\r\n        if(this[_maxHeight] === undefined){\r\n            let maxHeight = 0;\r\n            for(let i = 0; i < this.validOrientations.length; i++){\r\n                let dimensions = this.GetOrientedDimensions(this.validOrientations[i]);\r\n                if(dimensions[1] > maxHeight) maxHeight = dimensions[1];\r\n            }\r\n            this[_maxHeight] = maxHeight;\r\n        }\r\n        \r\n        return this[_maxHeight];\r\n    }\r\n\r\n    /** @param {Number} orientation */\r\n    GetOrientedDimensions(orientation){\r\n        switch(orientation){\r\n            case 0: return this.xyz;\r\n            case 1: return this.zyx;\r\n            case 2: return this.yxz;\r\n            case 3: return this.yzx;\r\n            case 4: return this.zxy;\r\n            case 5: return this.xzy;\r\n        }\r\n    }\r\n\r\n    /** @param {Number} orientation */\r\n    static ResolveOrientation(orientation){\r\n        return orientations[orientation];\r\n    }\r\n\r\n    /** @param {Array<Item>} items */\r\n    static GetMinDimensions(items){\r\n        var minDimensions = [Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER];\r\n\r\n        for(let iItem = 0, numItems = items.length; iItem < numItems; iItem++){\r\n            let item = items[iItem];\r\n            var validOrientations = item.validOrientations;\r\n            for(let iOrient = 0; iOrient < validOrientations.length; iOrient++){\r\n                let orientation = validOrientations[iOrient];\r\n                let dimensions = item.GetOrientedDimensions(orientation);\r\n                if(dimensions[0] < minDimensions[0]) minDimensions[0] = dimensions[0];\r\n                if(dimensions[1] < minDimensions[1]) minDimensions[1] = dimensions[1];\r\n                if(dimensions[2] < minDimensions[2]) minDimensions[2] = dimensions[2];\r\n            }\r\n        }\r\n\r\n        return minDimensions;\r\n    }\r\n\r\n    /**\r\n     * @param {Item} a \r\n     * @param {Item} b \r\n     */\r\n    static VolumeSort(a, b){\r\n        if(a.volume < b.volume) return -1;\r\n        if(a.volume > b.volume) return 1;\r\n        return 0;\r\n    }\r\n\r\n    /**\r\n     * @param {Item} a \r\n     * @param {Item} b \r\n     */\r\n    static HeightSort(a, b){\r\n        if(a.maxHeight < b.maxHeight) return -1;\r\n        if(a.maxHeight > b.maxHeight) return 1;\r\n        if(a.volume < b.volume) return -1;\r\n        if(a.volume > b.volume) return 1;\r\n        return 0;\r\n    }\r\n}\r\n\r\nclass Container{\r\n    /**\r\n     * @param {string} id \r\n     * @param {Number} width \r\n     * @param {Number} height \r\n     * @param {Number} length \r\n     * @param {Number} weightCapacity \r\n     */\r\n    constructor(id, width, height, length, weightCapacity){\r\n        this.id = id;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.length = length;\r\n        this.weightCapacity = weightCapacity;\r\n    }\r\n}\r\n\r\nexport {\r\n    Item,\r\n    Container\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/Components.js","import Utils from \"../Utils\";\r\n\r\nconst serializeModes = {\r\n    none: 'none',\r\n    json: 'json'\r\n};\r\n\r\n/**\r\n * @typedef ConfigParams\r\n * @property {Boolean} debug\r\n * @property {Boolean} save\r\n * @property {serializeModes} serializeMode\r\n */\r\n\r\n\r\nclass Controller {\r\n    constructor(property, min, max, step, onChange){\r\n        this.property = property;\r\n        this.min = min;\r\n        this.max = max;\r\n        this.step = step;\r\n        this.onChange = onChange;\r\n    }\r\n\r\n    /**\r\n     * @returns {Array<Controller>}\r\n     */\r\n    static Multiple(properties, min, max, step, onChange){\r\n        var controllers = [];\r\n        properties.forEach(property => {\r\n            controllers.push(new Controller(property, min, max, step, onChange));\r\n        });\r\n        return controllers;\r\n    }\r\n}\r\n\r\nfunction createKeyInfo(obj, key){\r\n    var isFolderGrouped = key[0] == \"#\";\r\n    if(isFolderGrouped)\r\n        key = key.substr(1);\r\n    \r\n    var propertyPath = key;\r\n    \r\n    key = key.split('.');\r\n    var folder = isFolderGrouped ? key.slice(0, key.length - 1).join('.') : undefined;\r\n    while (key.length > 1) obj = obj[key.shift()];\r\n    return {\r\n        id: (folder ? folder + '.' : '') + key[0],\r\n        folder: folder,\r\n        owner: obj,\r\n        key: key[0],\r\n        propertyPath: propertyPath\r\n    };\r\n}\r\n\r\nfunction getKey(obj, key){\r\n    return key.split('.').reduce(function(a, b){\r\n        return a && a[b];\r\n    }, obj);\r\n}\r\n\r\nfunction setKey(obj, key, val){\r\n    key = key.split('.');\r\n    while (key.length > 1) obj = obj[key.shift()];\r\n    var endKey = key.shift();\r\n    if(obj[endKey].setHex){\r\n        obj[endKey].setHex(val);\r\n    }\r\n    else{\r\n        obj[endKey] = val;\r\n    }\r\n    return obj[endKey];\r\n}\r\n\r\nfunction download(data, filename, type) {\r\n    // https://stackoverflow.com/a/30832210/1712403\r\n    var file = new Blob([data], {type: (type || 'text/plain')});\r\n    if (window.navigator.msSaveOrOpenBlob) // IE10+\r\n        window.navigator.msSaveOrOpenBlob(file, filename);\r\n    else { // Others\r\n        var a = document.createElement(\"a\"),\r\n                url = URL.createObjectURL(file);\r\n        a.href = url;\r\n        a.download = filename;\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        setTimeout(function() {\r\n            document.body.removeChild(a);\r\n            window.URL.revokeObjectURL(url);  \r\n        }, 0); \r\n    }\r\n}\r\n\r\nconst defaultEditParams = {\r\n    save: true, debug: true\r\n};\r\n\r\n/** \r\n * @typedef GUI\r\n * @property {HTMLElement} domElement\r\n */\r\n\r\nclass Shortcut{\r\n    /**\r\n     * @param {string} label \r\n     */\r\n    constructor(label){\r\n        this.label = label;\r\n\r\n        ///** @type {Map<string, GUI>} */\r\n        //this.folders = new Map();\r\n\r\n        this.controller = {};\r\n    }\r\n\r\n    Add(label, target){\r\n        label = label.replace(new RegExp(' ', 'g'), '_');\r\n        this.controller[label] = target;\r\n        Config.shortcutsGUI.add(this.controller, label);\r\n        console.log('added ' + label + ' shortcut to ' + this.label);\r\n    }\r\n}\r\n\r\n/** @type {GUI} */\r\nvar shortcutsGUI;\r\n\r\n/** @type {Map<string, Shortcut>} */\r\nvar shortcuts = new Map();\r\n\r\n/** @type {Map<Object, Config>} */\r\nvar instances = new Map();\r\n\r\n\r\nclass Config {\r\n    constructor(target){\r\n        if(!Config.debug) \r\n            Config.debug = instances;\r\n        instances.set(target, this);\r\n\r\n        this.target = target;\r\n        this.keys = [];\r\n    }\r\n\r\n    Track(...args){\r\n        var keys = this.keys;\r\n        args.forEach(key => {\r\n            keys.push(key);\r\n        });\r\n    }\r\n\r\n    Snapshot(ignoreKeys){\r\n        var data = {};\r\n        var target = this.target;\r\n        this.keys.forEach(key => {\r\n            var isController = key instanceof Controller;\r\n            var keyInfo = createKeyInfo(target, isController ? key.property : key);\r\n            var keyValue = keyInfo.owner[keyInfo.key];\r\n            if(typeof keyValue !== 'function'){\r\n                data[keyInfo.id] = keyValue;\r\n            }\r\n            else if(ignoreKeys !== undefined){\r\n                var warn = true;\r\n                ignoreKeys.forEach(ignoredKey => {\r\n                    if(ignoredKey === keyInfo.id){\r\n                        warn = false;\r\n                    }\r\n                });\r\n                if(warn) console.log('Config.Snapshot warning: \"' + keyInfo.id + '\" changes will be lost');\r\n            }\r\n        });\r\n        return data;\r\n    }\r\n\r\n    Serialize(){\r\n        var data = {};\r\n        this.keys.forEach(key => {\r\n            let isController = key instanceof Controller;\r\n            let keyInfo = createKeyInfo(this.target, isController ? key.property : key);\r\n            let keyValue = keyInfo.owner[keyInfo.key];\r\n            if(typeof keyValue !== 'function'){\r\n                var saveValue = keyInfo.owner[keyInfo.key].isColor ? '0x' + Number.parseInt(keyValue.toJSON()).toString(16) : keyValue;\r\n                data[keyInfo.propertyPath] = saveValue;\r\n            }\r\n        });\r\n        return data;\r\n    }\r\n\r\n    Save(){\r\n        if(this.Update){\r\n            this.Update();\r\n            this.data = this.Snapshot();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {Function} guiChanged \r\n     * @param {string} label \r\n     * @param {string} gui - or a dat.GUI object\r\n     * @param {ConfigParams} params \r\n     */\r\n    Edit(guiChanged, label, gui, params){\r\n\r\n        params = Utils.AssignUndefined(params, defaultEditParams);\r\n\r\n        var controllers = [];\r\n        var target = this.target;\r\n        if(gui === undefined) {\r\n            \r\n            gui = new (window.dat || require(\"./datGUIConsole\").default).GUI({\r\n                autoPlace: true\r\n            });\r\n        }\r\n        else if(label){\r\n            gui = gui.addFolder(label);\r\n        }\r\n\r\n        if(this.editing === undefined){\r\n            this.editing = {};\r\n \r\n            this.Update = function(){\r\n                require(\"./datGUIExtensions\");\r\n                \r\n                gui.updateAll();\r\n                guiChanged();\r\n            };\r\n \r\n            gui.add(this, 'Update');\r\n        }\r\n\r\n        this.keys.forEach(key => {\r\n            var isController = key instanceof Controller;\r\n            var keyInfo = createKeyInfo(target, isController ? key.property : key);\r\n            if(this.editing[keyInfo.id] !== true){\r\n                var folder = gui;\r\n                if(keyInfo.folder){\r\n                    require(\"./datGUIExtensions\");\r\n\r\n                    if(gui.find)\r\n                        folder = gui.find(keyInfo.folder);\r\n                    else\r\n                        console.warn('gui extensions not found!');\r\n                        \r\n                    if(!folder)\r\n                        folder = gui.addFolder(keyInfo.folder);\r\n                }\r\n                var addFunction = keyInfo.owner[keyInfo.key].isColor ? folder.addColor : folder.add;\r\n                controllers.push(\r\n                    ( isController && key.min !== undefined ? \r\n                        addFunction.call(folder, \r\n                            keyInfo.owner, keyInfo.key, key.min, key.max, key.step\r\n                        ) :\r\n                        addFunction.call(folder, \r\n                            keyInfo.owner, keyInfo.key\r\n                        )\r\n                    ) .onChange(key.onChange === undefined ? guiChanged : \r\n                        (function(){\r\n                            key.onChange.call(keyInfo.owner);\r\n                            guiChanged();\r\n                        })\r\n                    )\r\n                );\r\n                this.editing[keyInfo.id] = true;\r\n            }\r\n        });\r\n\r\n        var scope = this;\r\n        var editor = {\r\n            Save: function(){\r\n                scope.Save();\r\n                var filename = label !== undefined ? (label + (label.indexOf('.json') === -1 ? '.json' : '')) : 'config.json';\r\n                download(scope.data, filename);\r\n            },\r\n\r\n            Debug: function(){\r\n                console.log(scope.target);\r\n            },\r\n\r\n            Serialize: function(){\r\n                if(scope.Update){\r\n                    scope.Update();\r\n                    var data = scope.Serialize();\r\n                    var json = JSON.stringify(data);\r\n                    console.log(data, json);\r\n                }\r\n            }\r\n        }\r\n        if(params.save){\r\n            if(this.defaultsFolder === undefined) this.defaultsFolder = gui.addFolder('...');\r\n            if(this.editing['editor.Save'] !== true){\r\n                this.defaultsFolder.add(editor, 'Save');\r\n                this.editing['editor.Save'] = true;\r\n            }\r\n        }\r\n        if(params.debug){\r\n            if(this.defaultsFolder === undefined) this.defaultsFolder = gui.addFolder('...');\r\n            if(this.editing['editor.Debug'] !== true){\r\n                this.defaultsFolder.add(editor, 'Debug');\r\n                this.editing['editor.Debug'] = true;\r\n            }\r\n        }\r\n\r\n        switch(params.serializeMode){\r\n            default: break;\r\n            case serializeModes.json:\r\n                if(this.defaultsFolder === undefined) this.defaultsFolder = gui.addFolder('...');\r\n                if(this.editing['editor.Serialize'] !== true){\r\n                    this.defaultsFolder.add(editor, 'Serialize');\r\n                    this.editing['editor.Serialize'] = true;\r\n                }\r\n                break;\r\n        }\r\n\r\n        this.gui = gui;\r\n    }\r\n\r\n    toJSON(){\r\n        if(this.data === undefined) console.warn(this.target, 'is being saved with undefined data.');\r\n        return this.data;\r\n    }\r\n\r\n    static get serializeModes(){\r\n        return serializeModes;\r\n    }\r\n\r\n    static get shortcuts(){\r\n        return shortcuts;\r\n    }\r\n\r\n    static get shortcutsGUI(){\r\n        if(shortcutsGUI === undefined) shortcutsGUI = new (window.dat || require(\"./datGUIConsole\").default).GUI({\r\n            autoPlace: false\r\n        });\r\n        return shortcutsGUI;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {string} property - #property marks a folder\r\n     * @param {Array<string>} subProperties \r\n     * @returns returns the subProperties full paths\r\n     */\r\n    static Unroll(property, ...subProperties){\r\n        var unrolled = [];\r\n        subProperties.forEach(subProperty => {\r\n            unrolled.push(property + '.' + subProperty);\r\n        });\r\n        return unrolled;\r\n    }\r\n\r\n    /**\r\n     * @param {*} target \r\n     * @param {*} data \r\n     */\r\n    static Load(target, data){\r\n        var keys = Object.keys(data);\r\n        keys.forEach(key => {\r\n            setKey(target, key, data[key]);\r\n        });\r\n\r\n        if(instances.has(target) && instances.get(target).Update)\r\n            instances.get(target).Update();\r\n    }\r\n\r\n    /**\r\n     * @param {string} category\r\n     * @param {string} label \r\n     * @param {Function} target \r\n     */\r\n    static MakeShortcut(category, label, target){\r\n        if(shortcuts.has(category) === false) shortcuts.set(category, new Shortcut(category));\r\n        var shortcut = shortcuts.get(category);\r\n        shortcut.Add(label, target);\r\n    }\r\n}\r\n\r\nConfig.Controller = Controller;\r\n\r\nexport default Config;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/config/Config.js","import ContainingVolume from \"./ContainingVolume\";\r\nimport Logger from \"../../utils/cik/Logger\";\r\n\r\nconst type = 'Container';\r\n\r\nvar combinedVolume = new ContainingVolume();\r\n\r\nclass Container {\r\n    constructor(){\r\n        /**\r\n         * Containing volumes array\r\n         * @type {Array<ContainingVolume>}\r\n         */\r\n        this.volumes = [];\r\n\r\n        Logger.WarnOnce('Container.constructor', 'label not implemented');\r\n    }\r\n\r\n    /** @param {ContainingVolume} volume */\r\n    Add(volume){\r\n        this.volumes.push(volume);\r\n    }\r\n\r\n    /**\r\n     * @param {string} [uid] - You'll rarely need to provide this\r\n     */\r\n    SetUID(uid){\r\n        this.uid = uid || THREE.Math.generateUUID();\r\n        return this.uid;\r\n    }\r\n\r\n    get combinedVolume(){\r\n        let minX = Number.MAX_SAFE_INTEGER,\r\n            minY = Number.MAX_SAFE_INTEGER,\r\n            minZ = Number.MAX_SAFE_INTEGER;\r\n\r\n        let maxX = Number.MIN_SAFE_INTEGER,\r\n            maxY = Number.MIN_SAFE_INTEGER,\r\n            maxZ = Number.MIN_SAFE_INTEGER;\r\n\r\n        let combinedWeightCapacity = 0;\r\n        \r\n        this.volumes.forEach(volume => {\r\n            let pos = volume.position;\r\n            let dim = volume.dimensions;\r\n            if(pos.x < minX) minX = pos.x;\r\n            if(pos.y < minY) minY = pos.y;\r\n            if(pos.z < minZ) minZ = pos.z;\r\n            if(pos.x + dim.width > maxX) maxX = pos.x + dim.width;\r\n            if(pos.y + dim.height > maxY) maxY = pos.y + dim.height;\r\n            if(pos.z + dim.length > maxZ) maxZ = pos.z + dim.length;\r\n\r\n            combinedWeightCapacity += volume.weightCapacity;\r\n        });\r\n\r\n        combinedVolume.container = this;\r\n        combinedVolume.dimensions.Set(maxX - minX, maxZ - minZ, maxY - minY);\r\n        combinedVolume.position.set((maxX + minX) / 2, (maxZ + minZ) / 2, (maxY + minY) / 2);\r\n        combinedVolume.weightCapacity = combinedWeightCapacity;\r\n        \r\n        return combinedVolume;\r\n    }\r\n\r\n    toJSON(){\r\n        return {\r\n            type: type,\r\n            volumes: this.volumes\r\n        };\r\n    }\r\n\r\n    ToString(){\r\n        var result = type + '[';\r\n        for(var i = 0, numVolumes = this.volumes.length; i < numVolumes; i++){\r\n            result += this.volumes[i].ToString() + (i < numVolumes - 1 ? ', ' : ']');\r\n        }\r\n        return result;\r\n    }\r\n\r\n    static FromJSON(data){\r\n        if(data.type !== type) throw('Data supplied is not: ' + type);\r\n\r\n        var container = new Container();\r\n        for(var i = 0, numVolumes = data.volumes.length; i < numVolumes; i++){\r\n            var containingVolume = ContainingVolume.FromJSON(data.volumes[i]);\r\n            containingVolume.container = container;\r\n            container.Add(containingVolume);\r\n        }\r\n\r\n        return container;\r\n    }\r\n\r\n    get volume(){\r\n        var index = this.volumes.length - 1;\r\n        return this.volumes[index];\r\n    }\r\n}\r\n\r\nexport default Container;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/container/Container.js","import { rectanglesFromPoints, linesIntersect, rectangleContainsPoint, reduceRectangles } from \"./Math2D\";\r\n\r\n/** @typedef Rectangle @property {Vec2} p1 @property {Vec2} p2 @property {Vec2} p3 @property {Vec2} p4 \r\n * @property {Number} weight @property {Number} weightCapacity @property {Number} stackingCapacity \r\n */\r\n\r\n/**\r\n * @param {Rectangle | Array<Rectangle>} rect \r\n * @param {Number} weight \r\n * @param {Number} weightCapacity \r\n * @param {Number} stackingCapacity \r\n */\r\nfunction setRectangleWeights(rect, weight, weightCapacity, stackingCapacity){\r\n    if(rect instanceof Array){\r\n        for(let i = 0; i < rect.length; i++){\r\n            rect[i].weight = weight;\r\n            rect[i].weightCapacity = weightCapacity;\r\n            rect[i].stackingCapacity = stackingCapacity;\r\n        }\r\n    }\r\n    else{\r\n        rect.weight = weight;\r\n        rect.weightCapacity = weightCapacity;\r\n        rect.stackingCapacity = stackingCapacity;\r\n    }\r\n}\r\n\r\nconst smallValue = .000001;\r\nconst smallValueSqrt = .001;\r\nconst maxWeightValue = Number.MAX_SAFE_INTEGER;\r\n\r\nclass Region{\r\n    /**\r\n     * @param {Number} x * @param {Number} y * @param {Number} z * @param {Number} width * @param {Number} height * @param {Number} length * @param {Number} preferredX \r\n     */\r\n    constructor(x, y, z, width, height, length, preferredX){\r\n        this.Set(x, y, z, width, height, length, preferredX);\r\n        this.SetWeights(0, maxWeightValue, maxWeightValue);\r\n    }\r\n\r\n    /**\r\n     * @param {Number} x * @param {Number} y * @param {Number} z * @param {Number} width * @param {Number} height * @param {Number} length * @param {Number} preferredX \r\n     */\r\n    Set(x, y, z, width, height, length, preferredX){\r\n        this.x = x; this.y = y; this.z = z;\r\n        this.width = width; this.height = height; this.length = length;\r\n        this.preferredX = preferredX;\r\n        return this;\r\n    }\r\n    \r\n    /**\r\n     * @param {Number} weight \r\n     * @param {Number} weightCapacity \r\n     * @param {Number} stackingCapacity \r\n     */\r\n    SetWeights(weight, weightCapacity, stackingCapacity){\r\n        this.weight = weight;\r\n        this.weightCapacity = weightCapacity;\r\n        this.stackingCapacity = stackingCapacity;\r\n    }\r\n\r\n    /** @param {Region} region */\r\n    Copy(region){\r\n        this.Set(region.x, region.y, region.z, region.width, region.height, region.length, region.preferredX);\r\n        this.SetWeights(this.weight, this.weightCapacity, this.stackingCapacity);\r\n        return this;\r\n    }\r\n\r\n    get volume(){\r\n        return this.width * this.height * this.length;\r\n    }\r\n\r\n    /**\r\n     * @param {Number} offset offsets the region by this before calculating corners \r\n     * @returns {Array<Number>} 8 corners, length = 24 + center point [24, 25, 26]\r\n     */\r\n    GetCorners(offset){\r\n        var x = this.x - offset, y = this.y - offset, z = this.z - offset, w = this.width + offset * 2, h = this.height + offset * 2, l = this.length + offset * 2;\r\n\r\n        tempCorners[0] = x;       tempCorners[1] = y;       tempCorners[2] = z;         // 0:\r\n        tempCorners[3] = x + w;   tempCorners[4] = y;       tempCorners[5] = z;         // 0:w\r\n        tempCorners[6] = x;       tempCorners[7] = y + h;   tempCorners[8] = z;         // 0:h\r\n        tempCorners[9] = x + w;   tempCorners[10] = y + h;  tempCorners[11] = z;        // 0:wh\r\n\r\n        tempCorners[12] = x;      tempCorners[13] = y;      tempCorners[14] = z + l;    // 1:\r\n        tempCorners[15] = x + w;  tempCorners[16] = y;      tempCorners[17] = z + l;    // 1:w\r\n        tempCorners[18] = x;      tempCorners[19] = y + h;  tempCorners[20] = z + l;    // 1:h\r\n        tempCorners[21] = x + w;  tempCorners[22] = y + h;  tempCorners[23] = z + l;    // 1:wh\r\n\r\n        tempCorners[24] = x + w/2;tempCorners[25] = y + h/2;tempCorners[26] = z + l/2;  // center\r\n\r\n        return tempCorners;\r\n    }\r\n\r\n    /**\r\n     * @param {Array} result\r\n     * @returns {Array<Number>} 4 corners, length = 12\r\n     */\r\n    GetFloorPoints(result){\r\n        if(result === undefined) result = tempPoints;\r\n        var x = this.x, y = this.y, z = this.z, w = this.width, l = this.length;\r\n\r\n        result[0] = x;         result[1] = y;     result[2] = z;\r\n        result[3] = x + w;     result[4] = y;     result[5] = z;\r\n        result[6] = x + w;     result[7] = y;     result[8] = z + l;\r\n        result[9] = x;         result[10] = y;    result[11] = z + l;\r\n\r\n        return result;\r\n    }\r\n\r\n    /**\r\n     * @param {Number} offset offsets the region by this before checking * @param {Number} px * @param {Number} py * @param {Number} pz \r\n     */\r\n    ContainsPoint(offset, px, py, pz){\r\n        var x = this.x - offset, y = this.y - offset, z = this.z - offset, w = this.width + offset * 2, h = this.height + offset * 2, l = this.length + offset * 2;\r\n        return px > x && px < x + w\r\n            && py > y && py < y + h\r\n            && pz > z && pz < z + l;\r\n    }\r\n\r\n    /** @param {Number} offset offsets the region by this before checking * @param {Region} subRegion */\r\n    ContainsRegion(offset, subRegion){\r\n        var x = this.x - offset, y = this.y - offset, z = this.z - offset, w = this.width + offset * 2, h = this.height + offset * 2, l = this.length + offset * 2;\r\n        var rx = subRegion.x, ry = subRegion.y, rz = subRegion.z, rw = subRegion.width, rh = subRegion.height, rl = subRegion.length;\r\n        return rx > x && rx + rw < x + w\r\n            && ry > y && ry + rh < y + h\r\n            && rz > z && rz + rl < z + l;\r\n    }\r\n\r\n    /** @param {Number} offset offsets the region by this before checking * @param {Region} other */\r\n    Intersects(offset, other){\r\n        var x = this.x - offset, y = this.y - offset, z = this.z - offset, w = this.width + offset * 2, h = this.height + offset * 2, l = this.length + offset * 2;\r\n    \r\n        return x <= other.x + other.width && x + w >= other.x\r\n                && y <= other.y + other.height && y + h >= other.y \r\n                && z <= other.z + other.length && z + l >= other.z;\r\n    }\r\n\r\n    /** @param {Number} offset offsets the region by this before checking * @param {Number} width * @param {Number} height * @param {Number} length\r\n     * @param {Number} weight @param {Boolean} grounded\r\n     * @param {Region} [result]\r\n     */\r\n    FitTest(offset, width, height, length, weight, grounded, result){\r\n        if(!result) result = tempRegion;\r\n\r\n        if(grounded && this.y > smallValue) return false;\r\n\r\n        // Check that all dimensions fit\r\n        let fit = width < this.width + offset * 2 && height < this.height + offset * 2 && length < this.length + offset * 2;\r\n        if(fit){\r\n\r\n            let weightFit = weight <= this.weightCapacity;\r\n            if(weightFit){\r\n\r\n                // Calculate x based on preferred side\r\n                let x = this.preferredX !== 0 ? this.x + this.width - width : this.x;\r\n                result.Set(x, this.y, this.z, width, height, length, this.preferredX);\r\n                result.SetWeights(weight, 0, maxWeightValue);\r\n                return result;\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /** @param {Region} region * @param {Number} minRegionAxis */\r\n    Subtract(region, minRegionAxis){\r\n        /** @type {Array<Region>} */\r\n        var newRegions;\r\n        \r\n        // Calculate a new east region\r\n        let axis = region.x + region.width;\r\n        let size = this.x + this.width - axis;\r\n        if(size > minRegionAxis){\r\n            let east = new Region(axis, this.y, this.z, size, this.height, this.length, 0);\r\n            east.SetWeights(0, this.weightCapacity, this.stackingCapacity);\r\n            if(newRegions === undefined) newRegions = [];\r\n            newRegions.push(east);\r\n        }\r\n\r\n        // Calculate a new west region\r\n        axis = this.x;\r\n        size = region.x - axis;\r\n        if(size > minRegionAxis){\r\n            let west = new Region(axis, this.y, this.z, size, this.height, this.length, 1);\r\n            west.SetWeights(0, this.weightCapacity, this.stackingCapacity);\r\n            if(newRegions === undefined) newRegions = [];\r\n            newRegions.push(west);\r\n        }\r\n\r\n        // Calculate a new over/up region\r\n        axis = region.y + region.height;\r\n        size = this.y + this.height - axis;\r\n        if(size > minRegionAxis){\r\n            let over = new Region(region.x, axis, region.z, region.width, size, region.length, 0); // todo: add overhang var? // togglePreferredX based on pre-packed weight distribution?\r\n            over.SetWeights(0, region.stackingCapacity, region.stackingCapacity);\r\n            if(newRegions === undefined) newRegions = [];\r\n            newRegions.push(over);\r\n        }\r\n\r\n        // Calculate a new south region\r\n        axis = this.z;\r\n        size = region.z - axis;\r\n        if(false && size > minRegionAxis){\r\n            let south = new Region(this.x, this.y, axis, this.width, this.height, size, 0); // todo togglePreferredX based on pre-packed weight distribution?\r\n            south.SetWeights(0, this.weightCapacity, this.stackingCapacity);\r\n            if(newRegions === undefined) newRegions = [];\r\n            newRegions.push(south);\r\n        }\r\n\r\n        // Set this as new north/front region\r\n        axis = region.z + region.length;\r\n        size = this.z + this.length - axis;\r\n        this.z = axis;\r\n        this.length = size;\r\n        this.SetWeights(0, this.weightCapacity, this.stackingCapacity);\r\n\r\n        return newRegions;\r\n    }\r\n\r\n    /** @param {Region} other */\r\n    ConnectFloorRects(other){\r\n        var ptsA = this.GetFloorPoints(tempPoints),\r\n            ptsB = other.GetFloorPoints(tempPoints2);\r\n\r\n        var adjacent = 0;\r\n        var intersections = [];\r\n        for(let iA = 0; iA < 12; iA += 3){\r\n            let nextA = iA + 3 === 12 ? 0 : iA + 3;\r\n            let ax = ptsA[iA], az = ptsA[iA + 2], nax = ptsA[nextA], naz = ptsA[nextA + 2];\r\n\r\n            for(let iB = 0; iB < 12; iB += 3){\r\n                let nextB = iB + 3 === 12 ? 0 : iB + 3;\r\n                let bx = ptsB[iB], bz = ptsB[iB + 2], nbx = ptsB[nextB], nbz = ptsB[nextB + 2];\r\n\r\n                if(\r\n                    rectangleContainsPoint(smallValue, ptsA[0], ptsA[2], ptsA[6] - ptsA[0], ptsA[8] - ptsA[2], bx, bz)\r\n                    || rectangleContainsPoint(smallValue, ptsB[0], ptsB[2], ptsB[6] - ptsB[0], ptsB[8] - ptsB[2], ax, az)\r\n                ){\r\n                    adjacent++;\r\n                }\r\n\r\n                let intersection = linesIntersect(ax, az, nax, naz, bx, bz, nbx, nbz);\r\n                if(intersection &&\r\n                    (\r\n                        rectangleContainsPoint(smallValue, ptsA[0], ptsA[2], ptsA[6] - ptsA[0], ptsA[8] - ptsA[2], intersection.x, intersection.y)\r\n                        || rectangleContainsPoint(smallValue, ptsB[0], ptsB[2], ptsB[6] - ptsB[0], ptsB[8] - ptsB[2], intersection.x, intersection.y)\r\n                    )\r\n                ){\r\n                    intersections.push(intersection);\r\n                }\r\n            }\r\n        }\r\n\r\n        if(adjacent > 1){\r\n            for(let i = 0; i < 12; i += 3) intersections.push({x: ptsA[i], y: ptsA[i + 2]}, {x: ptsB[i], y: ptsB[i + 2]});\r\n        }\r\n        else{\r\n            intersections.length = 0;\r\n        }\r\n\r\n        var rectangles = rectanglesFromPoints(intersections);\r\n\r\n        let rectA = { p1: {x: ptsA[0], y: ptsA[2]}, p2: {x: ptsA[3], y: ptsA[5]}, p3: {x: ptsA[6], y: ptsA[8]}, p4: {x: ptsA[9], y: ptsA[11]} };\r\n        let rectB = { p1: {x: ptsB[0], y: ptsB[2]}, p2: {x: ptsB[3], y: ptsB[5]}, p3: {x: ptsB[6], y: ptsB[8]}, p4: {x: ptsB[9], y: ptsB[11]} };\r\n        rectangles.push(rectA, rectB);\r\n\r\n        reduceRectangles(rectangles);\r\n\r\n        setRectangleWeights(rectangles, this.weight + other.weight, this.weightCapacity + other.weightCapacity, this.stackingCapacity + other.stackingCapacity);\r\n        \r\n        return rectangles;\r\n    }\r\n\r\n    ToString(){\r\n        return format('R(p:[@, @, @], d:[@, @, @], w:@, wCap:@, sCap:@)', {nf: function(n){\r\n                return numberFormat(n, 2);\r\n            }},\r\n            this.x, this.y, this.z,\r\n            this.width, this.height, this.length,\r\n            this.weight, this.weightCapacity, this.stackingCapacity\r\n        );\r\n    }\r\n    \r\n    /**\r\n     * Deepest to front, smallest to largest\r\n     * @param {Region} a * @param {Region} b \r\n     */\r\n    static SortDeepestSmallest(a, b){\r\n        if(a.z < b.z) return -1;\r\n        if(a.z > b.z)return 1;\r\n        if(a.volume < b.volume) return -1;\r\n        if(a.volume > b.volume) return 1;\r\n        return 0;\r\n    }\r\n}\r\n\r\nvar tempRegion = new Region();\r\nvar tempCorners = [0];\r\nvar tempPoints = [0];\r\nvar tempPoints2 = [0];\r\n\r\nexport default Region;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/Region.js","\r\n/** SignalerCallback \r\n * @callback SignalerCallback\r\n * @param {Array<*>} args\r\n */\r\n\r\nconst _signals = Symbol('signals');\r\nconst _dispatches = Symbol('dispatches');\r\n\r\nclass LightDispatcher {\r\n    constructor(){\r\n        this[_signals] = {};\r\n        this[_dispatches] = {};\r\n    }\r\n\r\n    /** @param {string} event @param {SignalerCallback} callback */\r\n    On(event, callback){\r\n        if(this[_signals][event] === undefined){\r\n            this[_signals][event] = [];\r\n        }\r\n        this[_signals][event].push(callback);\r\n    }\r\n\r\n    /** @param {string} event @param {SignalerCallback} callback */\r\n    Off(event, callback){\r\n        var callbacks = this[_signals][event];\r\n        if(callbacks){\r\n            var index = callbacks.indexOf(callback);\r\n            if(index != -1){\r\n                callbacks.splice(index, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @param {string} event @param {Array<*>} [args] */\r\n    Dispatch(event, ...args){\r\n        this[_dispatches][event] = args;\r\n        var callbacks = this[_signals][event];\r\n        if(callbacks){\r\n            for(var i = 0, len = callbacks.length; i < len; i++){\r\n                callbacks[i](...args);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nexport default LightDispatcher;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/LightDispatcher.js","\r\nimport SceneSetup from './view/SceneSetup';\r\nimport Packer, { PackerParams } from './packer/Packer';\r\nimport View from './view/View';\r\nimport CargoInput from './components/CargoInput';\r\nimport PackingSpaceInput from './components/PackingSpaceInput';\r\nimport UX from './UX';\r\nimport Logger from './utils/cik/Logger';\r\nimport Signaler from './utils/cik/Signaler';\r\nimport PackerInterface, { SolverParams } from './components/PackerInterface';\r\nimport BoxEntry from './components/box/BoxEntry';\r\nimport Container from './packer/container/Container';\r\nimport Resources from './Resources';\r\nimport Asset from './components/assets/Asset';\r\nimport DomUI from './view/dom/DomUI';\r\n\r\nconst signals = {\r\n    start: 'start'\r\n};\r\n\r\n/**\r\n * @typedef AppParams\r\n * @property {UX} ux\r\n * @property {CargoInput} cargoInput\r\n * @property {PackingSpaceInput} packingSpaceInput\r\n * @property {PackerInterface} packerInterface\r\n * @property {Resources} resources\r\n */\r\n\r\nclass App extends Signaler{\r\n\r\n    /**\r\n     * \r\n     * @param {HTMLDivElement} containerDiv\r\n     * @param {AppParams} params\r\n     */\r\n    constructor(containerDiv, params) {\r\n\r\n        super();\r\n\r\n        let scope = this;\r\n\r\n        this.ux = params.ux;\r\n        this.cargoInput = params.cargoInput;\r\n        this.packingSpaceInput = params.packingSpaceInput;\r\n        this.packerInterface = params.packerInterface;\r\n        this.resources = params.resources;\r\n        Asset.resources = this.resources;\r\n\r\n        /** @type {PackerParams} */\r\n        let packerParams = {ux: this.ux};\r\n        this.packer = new Packer(packerParams);\r\n        this.packer.extendedParams = this.packerInterface.params;\r\n        \r\n        this.cargoInput.On(CargoInput.signals.insert, \r\n            /** @param {BoxEntry} boxEntry */\r\n            function(boxEntry){\r\n                scope.packer.cargoList.Add(boxEntry);\r\n            });\r\n\r\n        this.cargoInput.On(CargoInput.signals.modify, \r\n            /** @param {BoxEntry} boxEntry */\r\n            function(boxEntry){\r\n                scope.packer.cargoList.Modify(boxEntry);\r\n                scope.SolveAgain();\r\n            });\r\n\r\n        this.cargoInput.On(CargoInput.signals.remove, \r\n            /** @param {BoxEntry} boxEntry */\r\n            function(boxEntry){\r\n                scope.packer.cargoList.Remove(boxEntry.uid);\r\n                scope.SolveAgain();\r\n            });\r\n        \r\n        this.packingSpaceInput.On(PackingSpaceInput.signals.containerLoaded, \r\n            /** @param {Container} container */\r\n            function(container){\r\n                scope.packer.packingSpace.AddContainer(container);\r\n            });\r\n\r\n        this.packerInterface.On(PackerInterface.signals.solveRequest, \r\n            /** @param {SolverParams} solverParams */\r\n            function(solverParams){\r\n                scope.Solve(solverParams);\r\n            });\r\n\r\n        this.domUI = new DomUI(containerDiv, this.ux);\r\n        this.sceneSetup = new SceneSetup(this.domUI.domElement ? this.domUI.domElement : containerDiv, this.ux);\r\n        this.sceneSetup.Init().then(this.Start.bind(this));\r\n    }\r\n\r\n\r\n    Start(){\r\n        let scope = this;\r\n        let packerInterface = this.packerInterface;\r\n\r\n        /** @type {import('./view/View').ViewParams} */\r\n        let viewParams = { ux: this.ux };\r\n        this.view = new View(this.packer, this.sceneSetup, this.domUI, viewParams);\r\n        this.sceneSetup.Start();\r\n\r\n        this.ux._Bind(this);\r\n        this.cargoInput._Bind(this);\r\n        this.packingSpaceInput._Bind(this);\r\n\r\n        let resetColor = function(){};\r\n        this.cargoInput.On(CargoInput.signals.show, \r\n            /** @param {BoxEntry} boxEntry */\r\n            function(boxEntry){\r\n                let existingEntry = scope.cargoInput.GetEntry(boxEntry.uid);\r\n                if(existingEntry){\r\n                    resetColor();\r\n                    let previewColorBackup = boxEntry.Description('color');\r\n                    resetColor = function(){ boxEntry.Description('color', previewColorBackup); }\r\n                    boxEntry.Description('color', existingEntry.Description('color'));\r\n                }\r\n                scope.view.sceneSetup.hud.Preview(boxEntry);\r\n            });\r\n\r\n        function hideEntryPreview(){\r\n            resetColor();\r\n            scope.view.sceneSetup.hud.Preview(false);\r\n        }\r\n        this.cargoInput.On(CargoInput.signals.hide, hideEntryPreview);\r\n        this.cargoInput.On(CargoInput.signals.insert, hideEntryPreview);\r\n        this.cargoInput.On(CargoInput.signals.modify, hideEntryPreview);\r\n        this.cargoInput.On(CargoInput.signals.remove, hideEntryPreview);\r\n\r\n        /** @param {Packer.PackingResult} packingResult */\r\n        function onPackUpdate(packingResult){\r\n            packerInterface._Notify(PackerInterface.signals.solved, packingResult);\r\n        }\r\n        this.packer.On(Packer.signals.packUpdate, onPackUpdate);\r\n\r\n        /** @param {*} error */\r\n        function onPackFailed(error){\r\n            packerInterface._Notify(PackerInterface.signals.failed, error);\r\n        }\r\n        this.packer.On(Packer.signals.packFailed, onPackFailed);\r\n\r\n        this.Dispatch(signals.start);\r\n    }\r\n\r\n    SolveAgain(){\r\n        if(this.ux.params.autoUpdatePack && this.packer.solveAgain) this.Solve();\r\n    }\r\n\r\n    /** @param {SolverParams} [solverParams] */\r\n    Solve(solverParams){\r\n        this.view.ClearPackingResults();\r\n        this.packer.Solve(solverParams);\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n  \r\n}\r\n\r\nexport default App;\r\n  \n\n\n// WEBPACK FOOTER //\n// ./src/api/App.js","import CargoList from \"./CargoList\";\r\nimport PackingSpace from \"./PackingSpace\";\r\nimport BoxEntry from \"../components/box/BoxEntry\";\r\nimport Utils from \"../utils/cik/Utils\";\r\nimport Signaler from \"../utils/cik/Signaler\";\r\nimport Logger from \"../utils/cik/Logger\";\r\nimport ContainingVolume from \"./container/ContainingVolume\";\r\n\r\n/**\r\n * @typedef {Object} PackerParams\r\n * @property {import('../UX').default} ux\r\n * @property {Number} defaultStackingFactor\r\n */\r\n\r\n/** @typedef {import('../packer/cub/CUB').CUBParams} CUBParams */\r\n\r\n/** @typedef SolverParams\r\n * @property {CUBParams} algorithmParams\r\n * @property {string} algorithm default = 'cub'\r\n */\r\n\r\nclass PackedCargo {\r\n    /**\r\n     * @param {BoxEntry} entry \r\n     * @param {ContainingVolume} containingVolume \r\n     * @param {THREE.Vector3} position \r\n     * @param {Number} orientation \r\n     */\r\n    constructor(entry, containingVolume, position, orientation){\r\n        this.entry = entry;\r\n        this.containingVolume = containingVolume;\r\n        this.position = position;\r\n        this.orientation = orientation;\r\n    }\r\n}\r\n\r\nclass UnpackedCargo {\r\n    /**\r\n     * @param {BoxEntry} entry \r\n     * @param {Number} unpackedQuantity\r\n     */\r\n    constructor(entry, unpackedQuantity){\r\n        this.entry = entry;\r\n        this.unpackedQuantity = unpackedQuantity;\r\n    }\r\n}\r\n\r\nclass PackingResult{\r\n    /** @param {Number} numTotalItem @param {Number} runtime */\r\n    constructor(numTotalItems, runtime){\r\n        /** @type {Array<PackedCargo>} */\r\n        this.packed = [];\r\n\r\n        /** @type {Array<UnpackedCargo>} */\r\n        this.unpacked = [];\r\n\r\n        this.numTotalItems = numTotalItems || 0;\r\n\r\n        this.runtime = runtime || -1;\r\n    }\r\n}\r\n\r\n/** @type {PackerParams} */\r\nconst defaultParams = {};\r\nconst signals = {\r\n    packUpdate: 'packUpdate',\r\n    packFailed: 'packFailed'\r\n};\r\n\r\nconst _solverParams = Symbol('solverParams');\r\n\r\nconst epsilon = Math.pow(2, -52);\r\n\r\nclass Packer extends Signaler {\r\n    /** @param {PackerParams} params */\r\n    constructor(params){\r\n        super();\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        this.packingSpace = new PackingSpace();\r\n        this.cargoList = new CargoList();\r\n\r\n        this.solverExecutionsCount = 0;\r\n    }\r\n\r\n    /** @param {PackerParams} extendedParams */\r\n    set extendedParams(extendedParams){\r\n        this.params = Utils.AssignUndefined(this.params, extendedParams);\r\n    }\r\n\r\n    /** @param {SolverParams} params */\r\n    Solve(params){\r\n        params = params || this[_solverParams];\r\n        this[_solverParams] = params;\r\n\r\n        this.solverExecutionsCount++;\r\n\r\n        let algorithm = params.algorithm;\r\n        let algorithmParams = params.algorithmParams;\r\n        if(algorithm === 'cub')\r\n            this.SolveCUB(algorithmParams);\r\n    }\r\n\r\n    /** @param {import('../packer/cub/CUB').CUBParams} params */\r\n    async SolveCUB(params){\r\n\r\n        if(this.packingSpace.ready === false){\r\n            this.Dispatch(signals.packFailed, 'Packing space not ready');\r\n            return;\r\n        }\r\n\r\n        if(this.cargoList.ready === false){\r\n            this.Dispatch(signals.packFailed, 'Cargo list not ready');\r\n            return;\r\n        }\r\n\r\n        const Container = require('./cub/Components').Container;\r\n        const Item = require('./cub/Components').Item;\r\n\r\n        var containingVolume = this.packingSpace.current.volume;\r\n        var d = containingVolume.dimensions;\r\n        var container = new Container(containingVolume.uid, d.width, d.height, d.length, containingVolume.weightCapacity);\r\n\r\n        var numTotalItems = 0;\r\n\r\n         /** @type {Array<Item>} */\r\n         var items = [];\r\n         var entries = {};\r\n         for(let group of this.cargoList.groups.values()){\r\n            /** @type {BoxEntry} */\r\n            let entry = group.entry;\r\n            entries[entry.uid] = entry;\r\n            d = entry.dimensions;\r\n            let validOrientations = entry.properties.rotation.enabled ? entry.properties.rotation.allowedOrientations : undefined;\r\n            let stackingCapacity = entry.properties.stacking.enabled ? entry.properties.stacking.capacity : (entry.weight > epsilon ? entry.weight * this.params.defaultStackingFactor : Number.MAX_SAFE_INTEGER - 10);\r\n            let grounded = entry.properties.translation.enabled ? entry.properties.translation.grounded : false;\r\n            let item = new Item(entry.uid, d.width, d.height, d.length, entry.weight, entry.quantity, validOrientations, stackingCapacity, grounded);\r\n            items.push(item);\r\n            numTotalItems += entry.quantity;\r\n        }\r\n\r\n        const CUB = require('./cub/CUB');\r\n        var startTime = performance.now();\r\n        var result = await CUB.pack(container, items, params);\r\n        var cubRuntime = performance.now() - startTime;\r\n\r\n        var cubRuntime2Dec = Math.round(cubRuntime / 1000 * 100) / 100;\r\n        var packingResult = new PackingResult(numTotalItems, cubRuntime2Dec);\r\n        result.packedItems.forEach(packedItem => {\r\n            let entry = entries[packedItem.ref.id];\r\n            let position = new THREE.Vector3(\r\n                packedItem.x + packedItem.packedWidth / 2,\r\n                packedItem.y + packedItem.packedHeight / 2,\r\n                packedItem.z + packedItem.packedLength / 2\r\n            );\r\n            let orientation = Item.ResolveOrientation(packedItem.orientation);\r\n            let packedCargo = new PackedCargo(entry, containingVolume, position, orientation);\r\n            packingResult.packed.push(packedCargo);\r\n        });\r\n\r\n        result.unpackedItems.forEach(unpackedItem => {\r\n            let entry = entries[unpackedItem.id];\r\n            let unpackedQuantity = unpackedItem.quantity;\r\n            let unpackedCargo = new UnpackedCargo(entry, unpackedQuantity);\r\n            packingResult.unpacked.push(unpackedCargo);\r\n        });\r\n\r\n        this.Dispatch(signals.packUpdate, packingResult);\r\n    }\r\n\r\n    get solveAgain(){\r\n        return this.solverExecutionsCount > 0;\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n\r\n}\r\n\r\nPacker.PackingResult = PackingResult;\r\nPacker.PackedCargo = PackedCargo;\r\nPacker.UnpackedCargo = UnpackedCargo;\r\n\r\nexport default Packer;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/Packer.js","import Volume from \"./Volume\";\r\nimport Container from \"./Container\";\r\n\r\nconst _weightCapacity = Symbol('weightCapacity');\r\nconst type = 'ContainingVolume';\r\n\r\nclass ContainingVolume extends Volume {\r\n    /** @param {Container} container */\r\n    constructor(container){\r\n        super();\r\n        \r\n        this.container = container;\r\n        this.weightCapacity = 0;\r\n\r\n        this.SetUID();\r\n    }\r\n\r\n    set weightCapacity(value){ this[_weightCapacity] = value; }\r\n    get weightCapacity(){ return this[_weightCapacity]; }\r\n\r\n    /**\r\n     * @param {string} [uid] - You'll rarely need to provide this\r\n     */\r\n    SetUID(uid){\r\n        this.uid = uid || THREE.Math.generateUUID();\r\n        return this.uid;\r\n    }\r\n\r\n    toJSON(){\r\n        var json = super.toJSON();\r\n        json.type = type;\r\n        json.weightCapacity = this.weightCapacity;\r\n        return json;\r\n    }\r\n\r\n    ToString(){\r\n        return super.ToString();\r\n    }\r\n\r\n    static FromJSON(data){\r\n        if(data.type !== type) console.warn('Data supplied is not: ' + type);\r\n\r\n        var containingVolume = new ContainingVolume();\r\n        containingVolume.weightCapacity = data.weightCapacity;\r\n        Volume.FromJSON(data, containingVolume);\r\n\r\n        return containingVolume;\r\n    }\r\n}\r\n\r\nexport default ContainingVolume;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/container/ContainingVolume.js","import { Item, Container } from \"./Components\";\r\nimport Region from \"./Region\";\r\n\r\nconst smallValue = .000001;\r\n\r\nclass PackedItem{\r\n\r\n    /**\r\n     * @param {Item} ref \r\n     * @param {Number} x\r\n     * @param {Number} y\r\n     * @param {Number} z\r\n     * @param {Number} packedWidth\r\n     * @param {Number} packedHeight\r\n     * @param {Number} packedLength\r\n     * @param {Number} orientation \r\n     */\r\n    constructor(ref, x, y, z, packedWidth, packedHeight, packedLength, orientation){\r\n        this.ref = ref;\r\n        this.x = x; this.y = y; this.z = z;\r\n        this.packedWidth = packedWidth; this.packedHeight = packedHeight; this.packedLength = packedLength;\r\n        this.orientation = orientation;\r\n    }\r\n\r\n    /** @param {PackedItem} a * @param {PackedItem} b */\r\n    static DepthSort(a, b){\r\n        let az = a.z + a.packedLength,\r\n            bz = b.z + b.packedLength;\r\n        if(az + smallValue < bz) return -1;\r\n        if(az > bz + smallValue) return 1;\r\n        if(a.y < b.y) return -1;\r\n        if(a.y > b.y) return 1;\r\n        if(a.ref.volume > b.ref.volume + smallValue) return -1;\r\n        if(a.ref.volume + smallValue < b.ref.volume) return 1;\r\n        return 0;\r\n    }\r\n\r\n    /** @param {PackedItem} a * @param {PackedItem} b */\r\n    static Sort(a, b){\r\n        if(a.z + smallValue < b.z){\r\n            if(a.z + a.packedLength > b.z && a.y > b.y) return 1;\r\n            return -1;\r\n        }\r\n        if(b.z + smallValue < a.z){\r\n            if(b.z + b.packedLength > a.z && b.y > a.y) return 1;\r\n            return 1;\r\n        }\r\n        if(a.y < b.y) return -1;\r\n        if(a.y > b.y) return 1;\r\n        if(a.ref.volume > b.ref.volume + smallValue) return -1;\r\n        if(a.ref.volume + smallValue < b.ref.volume) return 1;\r\n        return 0;\r\n    }\r\n}\r\n\r\nclass PackedContainer{\r\n    /**\r\n     * @param {Container} container \r\n     */\r\n    constructor(container){\r\n        this.container = container;\r\n        \r\n        /** @type {Array<PackedItem>} */\r\n        this.packedItems = [];\r\n        /** @type {Array<Item>} */\r\n        this.unpackedItems = [];\r\n\r\n        this.cumulatedWeight = 0;\r\n    }\r\n\r\n    /** @param {PackedItem} item */\r\n    Pack(item){\r\n        this.cumulatedWeight += item.ref.weight;\r\n        this.packedItems.push(item);\r\n    }\r\n\r\n    /** @param {Item} item */\r\n    Unpack(item){\r\n        this.unpackedItems.push(item);\r\n    }\r\n\r\n    /** @param {Number} weight */\r\n    WeightPass(weight){\r\n        return this.cumulatedWeight + weight <= this.container.weightCapacity;\r\n    }\r\n\r\n    /** @param {Region} placement */\r\n    FitPass(placement){\r\n        let numPackedItems = this.packedItems.length;\r\n\r\n        // Make sure that the new 'packed item to be' does not collide with a previous one\r\n        for(let iPacked = 0; iPacked < numPackedItems; iPacked++){\r\n            let packedItem = this.packedItems[iPacked];\r\n            // Creates temporary region for following calculations\r\n            let packedRegion = tempRegion2.Set(packedItem.x, packedItem.y, packedItem.z, packedItem.packedWidth, packedItem.packedHeight, packedItem.packedLength, 0);\r\n            packedRegion.SetWeights(packedItem.ref.weight, 0, packedItem.ref.stackingCapacity);\r\n            \r\n            let intersects = packedRegion.Intersects(-smallValue, placement);\r\n            if(intersects){\r\n                return false;\r\n            }\r\n        }\r\n\r\n        return true;\r\n    }\r\n}\r\n\r\nexport {\r\n    PackedItem,\r\n    PackedContainer\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/PackedComponents.js","\r\nimport Input from '../utils/cik/input/Input';\r\nimport Quality from '../utils/cik/Quality';\r\nimport Controller from '../scene/Controller';\r\nimport Renderer from '../scene/Renderer';\r\nimport Camera from '../scene/Camera';\r\nimport HUDView from './HUDView';\r\nimport UX from '../UX';\r\nimport Utils from '../utils/cik/Utils';\r\nimport Signaler from '../utils/cik/Signaler';\r\n\r\nconst signals = {\r\n    init: 'init',\r\n    started: 'started',\r\n    paused: 'paused',\r\n    stopped: 'stopped'\r\n};\r\n\r\nclass SceneSetup extends Signaler {\r\n    /**\r\n     * \r\n     * @param {HTMLDivElement} containerDiv \r\n     * @param {UX} ux \r\n     */\r\n    constructor(containerDiv, ux){\r\n        super();\r\n        \r\n        this.domElement = containerDiv;\r\n        this.ux = ux;\r\n    }\r\n\r\n    Init(){\r\n        \r\n        var quality = new Quality().Common(2);\r\n\r\n        var units = this.ux.params.units;\r\n        var controllerParams = {};\r\n        this.sceneController = new Controller(controllerParams);\r\n\r\n        /** @type {import('../scene/Renderer').RendererParams} */\r\n        var rendererParams = {clearColor: this.ux.params.backgroundColor};\r\n        Object.assign(rendererParams, quality);\r\n        this.sceneRenderer = new Renderer(rendererParams);\r\n        this.sceneRenderer.renderer.toneMappingExposure = 1.6;\r\n        this.domElement.appendChild(this.sceneRenderer.renderer.domElement);\r\n\r\n        /** @type {import('./Camera').CameraParams} */\r\n        var cameraParams = {fov: this.ux.params.fov, aspect: 1, near: 1 * units, far: 5000 * units};\r\n        this.cameraController = new Camera(cameraParams);\r\n        this.cameraController.OrbitControls(this.sceneRenderer.renderer.domElement);\r\n\r\n        this.input = new Input(this.domElement);\r\n        this.input.camera = this.cameraController.camera;\r\n\r\n        var sceneRendererRef = this.sceneRenderer;\r\n        var appCameraRef = this.cameraController.camera;\r\n        this.input.onResize.push(function(screen){\r\n            sceneRendererRef.ReconfigureViewport(screen, appCameraRef);\r\n        });\r\n\r\n        // hud\r\n        if(this.ux.params.hud){\r\n            /** @type {import('../view/HUDView').HUDViewParams} */\r\n            var hudParams = {ux: this.ux, sceneSetup: this, container: this.sceneRenderer.renderer.domElement};\r\n            /** @type {import('./Camera').CameraParams} */\r\n            var hudCameraParams = Utils.AssignUndefined({fov: 15}, cameraParams);\r\n            this.hud = new HUDView(hudParams, hudCameraParams);\r\n            var hudCameraRef = this.hud.cameraController.camera;\r\n            this.input.onResize.push(function(screen){\r\n                sceneRendererRef.AdjustCamera(screen, hudCameraRef);\r\n            });\r\n\r\n            this.sceneRenderer.renderer.autoClear = false;\r\n        }\r\n        // /hud\r\n\r\n        // Comeplete setup\r\n        var setupParams = {\r\n            gridHelper: false,\r\n        }\r\n\r\n        // Initial camera move\r\n\t\tthis.cameraController.position.x = 100 * units;\r\n\t\tthis.cameraController.position.y = 100 * units;\r\n        this.cameraController.position.z = 100 * units;\r\n        this.cameraController.SetTarget(new THREE.Vector3());\r\n\r\n        // Env\r\n        if(setupParams.gridHelper){\r\n            var gridHelper = new THREE.GridHelper(200 * units, 20);\r\n            this.sceneController.AddDefault(gridHelper);\r\n        }\r\n\r\n        if(this.ux.params.configure){\r\n            this.Configure();\r\n        }\r\n\r\n        var scope = this;\r\n        return new Promise((resolve, reject) => {\r\n            scope.Dispatch(signals.init);\r\n            resolve();\r\n        });\r\n    }\r\n\r\n    Start(){\r\n        if(this.Update === undefined){\r\n            let scope = this;\r\n            let sceneRenderer = this.sceneRenderer;\r\n            let scene1 = this.sceneController.scene,\r\n                camera1 = this.cameraController.camera;\r\n                \r\n            if(this.ux.params.hud){\r\n                let hud = this.hud;\r\n                let scene2 = hud.scene,\r\n                    camera2 = hud.cameraController.camera;\r\n            \r\n                this.Update = function(timestamp){\r\n                    scope.animationFrameID = requestAnimationFrame(scope.Update);\r\n\r\n                    scope.input.Update();\r\n                    scope.cameraController.Update();\r\n                    hud.Update(timestamp);\r\n\r\n                    sceneRenderer.renderer.clear();\r\n                    sceneRenderer.Render(scene1, camera1);\r\n                    sceneRenderer.renderer.clearDepth();\r\n                    sceneRenderer.Render(scene2, camera2);\r\n                };\r\n            }\r\n            else{\r\n                this.Update = function(timestamp){\r\n                    scope.animationFrameID = requestAnimationFrame(scope.Update);\r\n\r\n                    scope.input.Update();\r\n                    scope.cameraController.Update();\r\n\r\n                    sceneRenderer.Render(scene1, camera1);\r\n                };\r\n            }\r\n        }\r\n\r\n        this.Update();\r\n        this.input.screenNeedsUpdate = true;\r\n        this.input.cameraNeedsUpdate = true;\r\n\r\n        this.Dispatch(signals.started);\r\n    }\r\n\r\n    Pause(){\r\n        if(this.animationFrameID){\r\n            cancelAnimationFrame(this.animationFrameID);\r\n        }\r\n\r\n        this.Dispatch(signals.paused);\r\n    }\r\n\r\n    Stop(){\r\n        if(this.animationFrameID){\r\n            cancelAnimationFrame(this.animationFrameID);\r\n        }\r\n        this.input.Dispose();\r\n        this.sceneRenderer.Dispose();\r\n\r\n        this.Dispatch(signals.stopped);\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n\r\n    DefaultLights(controller, configure, helpers){\r\n\r\n        var units = this.ux.params.units;\r\n\r\n        var ambientLight = new THREE.AmbientLight( 0x404040 );\r\n\r\n        var directionalLight = new THREE.DirectionalLight(0xfeeedd);\r\n        directionalLight.position.set(300 * units, 300 * units, 125 * units);\r\n        \r\n        controller.ambientContainer.add(ambientLight);\r\n        controller.ambientContainer.add(directionalLight);\r\n\r\n        var directionalLightComplem = new THREE.DirectionalLight(0xfeeedd);\r\n        directionalLightComplem.position.set(-200 * units, 175 * units, 125 * units);\r\n        \r\n        controller.ambientContainer.add(directionalLightComplem);\r\n\r\n        if(this.ux.params.configure && configure){\r\n            let Smart = require('../utils/cik/config/Smart').default;\r\n            let Config = require('../utils/cik/config/Config').default;\r\n            let Control3D = require('../utils/cik/config/Control3D').default;\r\n\r\n            let dl = directionalLight;\r\n            let smart = new Smart(dl, 'Directional light');\r\n            smart.MakeShortcut('Configure');\r\n            \r\n            let lightController = ['color', 'intensity', 'castShadow'];\r\n            let shadowControllers = ['shadow.bias', 'shadow.radius', 'shadow.mapSize.x', 'shadow.mapSize.y'];\r\n            //let sc = dl.shadow.camera as THREE.OrthographicCamera;\r\n            let shadowCameraControllers = Config.Unroll('#shadow.camera', 'left', 'top', 'right', 'bottom', 'near', 'far');\r\n\r\n            let dlHelper, dlCameraHelper;\r\n            if(helpers){\r\n                dlHelper = new THREE.DirectionalLightHelper(dl, 5);\r\n                this.sceneController.AddDefault(dlHelper);\r\n                dlCameraHelper = new THREE.CameraHelper(dl.shadow.camera);\r\n                this.sceneController.AddDefault(dlCameraHelper);\r\n            }\r\n\r\n            let sceneRenderer = this.sceneRenderer;\r\n            global.sceneRenderer = sceneRenderer;\r\n            let mapSize = dl.shadow.mapSize.clone();\r\n            function onGUIChanged(){\r\n                dl.shadow.camera.updateProjectionMatrix();\r\n                sceneRenderer.UpdateShadowMaps();\r\n                if(dl.shadow.map){\r\n                    if(dl.shadow.mapSize.manhattanDistanceTo(mapSize) > 0.0001){\r\n                        mapSize.copy(dl.shadow.mapSize);\r\n                        dl.shadow.map.dispose();\r\n                        dl.shadow.map = null;\r\n                    }\r\n                }\r\n\r\n                if(helpers){\r\n                    dlHelper.update();\r\n                    dlCameraHelper.update();\r\n                }\r\n            }\r\n\r\n            smart.Config('Directional light + shadow', dl, onGUIChanged, Smart.serializeModes.json,\r\n                ...lightController,\r\n                ...shadowControllers,\r\n                ...shadowCameraControllers\r\n            );\r\n        }\r\n\r\n        return [ambientLight, directionalLight, directionalLightComplem];\r\n    }\r\n\r\n    Configure(){\r\n\r\n        var Smart = require('../utils/cik/config/Smart').default;\r\n        var Config = require('../utils/cik/config/Config').default;\r\n        var Control3D = require('../utils/cik/config/Control3D').default;\r\n\r\n        var scope = this;\r\n\r\n        var appControl3D = Control3D.Configure('app', this.cameraController.camera, this.sceneRenderer.renderer.domElement);\r\n        this.sceneController.AddDefault(appControl3D.control);\r\n\r\n        if(this.ux.params.hud){\r\n            var hudControl3D = Control3D.Configure('hud', this.hud.cameraController.camera, this.sceneRenderer.renderer.domElement);\r\n            this.hud.AddDefault(hudControl3D.control);\r\n\r\n            var hud = this.hud;\r\n            function onGUIChanged(){\r\n                console.log('Camera changed');\r\n            }\r\n\r\n            var toggle = false;\r\n            var control = {\r\n                toggleOrbitOwner: function(){\r\n                    if(toggle){\r\n                        if(!hud.cameraController.orbitControls){\r\n                            hud.cameraController.OrbitControls(scope.sceneRenderer.renderer.domElement);\r\n                        }\r\n                        scope.cameraController.Hold();\r\n                        hud.cameraController.Release();\r\n                    }\r\n                    else{\r\n                        scope.cameraController.Release();\r\n                        hud.cameraController.Hold();\r\n                    }\r\n                    toggle = !toggle;\r\n                },\r\n                hudCam: hud.cameraController,\r\n                print: function(){\r\n                    smart.config.Update();\r\n                    console.group('hudCam properties');\r\n                    console.log('position', Utils.VecToString(hud.cameraController.position, 1));\r\n                    console.log('rotation', Utils.VecToString(hud.cameraController.rotation, 3));\r\n                    console.groupEnd();\r\n                }\r\n            };\r\n\r\n            control.toggleOrbitOwner();\r\n            \r\n            var smart = new Smart(this, 'HUDView');\r\n            smart.MakeShortcut('Configure');\r\n            var rotationProperties = Config.Unroll('#hudCam.rotation', 'x', 'y', 'z');\r\n            var rotationControllers = Config.Controller.Multiple(rotationProperties, 0, 2 * Math.PI, 2 * Math.PI / 360);\r\n            smart.Config(null, control, onGUIChanged, Smart.serializeModes.none,\r\n                'toggleOrbitOwner',\r\n                'print',\r\n                'hudCam.camera.fov', \r\n                ...Config.Unroll('#hudCam.position', 'x', 'y', 'z'), \r\n                ...rotationControllers\r\n            );\r\n\r\n            console.log('HUDView config', smart.config.gui.list || smart);\r\n        }\r\n    }\r\n}\r\n\r\nexport default SceneSetup;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/SceneSetup.js","import Tween from \"../utils/cik/Tween\";\r\nimport Signaler from \"../utils/cik/Signaler\";\r\n\r\nrequire('../../min-dependencies/lib/three/controls/OrbitControls');\r\n\r\nconst epsilon = Math.pow(2, -52);\r\n\r\n/**\r\n * @typedef {Object} CameraParams\r\n * @property {Number} fov\r\n * @property {Number} aspect\r\n * @property {Number} near\r\n * @property {Number} far\r\n */\r\n\r\n/** @typedef FrameCoords @property {THREE.Vector3} position @property {THREE.Vector3} center */\r\n\r\n/** @type {FrameCoords} */\r\nvar tempCoords = {};\r\n/** @type {FrameCoords} */\r\nvar ownCoords = {position: new THREE.Vector3(), center: new THREE.Vector3()};\r\n\r\nvar tempVec3 = new THREE.Vector3(),\r\n    tempVec3_b = new THREE.Vector3();\r\n\r\nconst signals = {\r\n    change: 'change',\r\n    userChange: 'userChange'\r\n};\r\n\r\nclass Camera extends Signaler {\r\n    /**\r\n     * @param {CameraParams} params \r\n     */\r\n    constructor(params){\r\n        super();\r\n\r\n        this.params = params;\r\n\r\n        this.camera = new THREE.PerspectiveCamera(this.params.fov, this.params.aspect, this.params.near, this.params.far);\r\n        this.camera.name = 'UserCamera';\r\n\r\n        this.changed = false;\r\n\r\n        this.dollyAnimation = {\r\n            enabled: false,\r\n            position: Tween.Combo.RequestN(Tween.functions.ease.easeInOutQuad, .5, 0, 0, 0, 0, 0, 0),\r\n            lookAt: Tween.Combo.RequestN(Tween.functions.ease.easeInOutQuad, .5, 0, 0, 0, 0, 0, 0)\r\n        };\r\n\r\n        let scope = this;\r\n        function onDollyAnimationComplete(){\r\n            scope.dollyAnimation.enabled = false;\r\n        }\r\n        this.dollyAnimation.position.onComplete = onDollyAnimationComplete;\r\n        this.dollyAnimation.lookAt.onComplete = onDollyAnimationComplete;\r\n\r\n        this.dollyAnimation.position.Hook(this.position, 'x', 'y', 'z');\r\n\r\n        this.fovAnimation = {\r\n            enabled: false,\r\n            fov: new Tween(Tween.functions.ease.easeInOutQuad, 0, 0, 0)\r\n        };\r\n\r\n        function onFOVAnimationComplete(){\r\n            scope.fovAnimation.enabled = false;\r\n        }\r\n        this.fovAnimation.fov.onComplete = onFOVAnimationComplete;\r\n        this.fovAnimation.fov.Hook(this.camera, 'fov');\r\n    }\r\n\r\n    get position(){ return this.camera.position; }\r\n    set position(value){ this.camera.position.copy(value); this.changed = true; }\r\n    get rotation(){ return this.camera.rotation; }\r\n    set rotation(value){ this.camera.rotation.copy(value); this.changed = true; }\r\n\r\n    FirstPersonControls(container, params){\r\n        if(this.fpsControls === undefined && container !== undefined){\r\n            this.fpsControls = new App.Navigation.FirstPerson(this.camera, container);\r\n\r\n            this.fpsControls.Hold = function(){\r\n                this.enabled = false;\r\n            };\r\n            this.fpsControls.Release = function(){\r\n                this.enabled = true;\r\n            };\r\n        }\r\n        \r\n        if(this.fpsControls !== undefined){\r\n            if(params !== undefined){\r\n                this.fpsControls.speed.set(params.speedX, params.speedY);\r\n                this.fpsControls.damping = params.damping;\r\n                this.fpsControls.momentum = params.momentum;\r\n                this.fpsControls.limitPhi = params.limitPhi;\r\n                this.fpsControls.moveSpeed = params.moveSpeed;\r\n                this.fpsControls.keyControls = true;\r\n            }\r\n\r\n            this.controls = this.fpsControls;\r\n        }\r\n    }\r\n\r\n    OrbitControls(container, params){\r\n        if(this.orbitControls === undefined && container !== undefined){\r\n\r\n            var lookTarget = new THREE.Vector3();\r\n            this.camera.getWorldDirection(lookTarget);\r\n            lookTarget.multiplyScalar(200).add(this.camera.position);\r\n\r\n            /** @type {THREE.EventDispatcher} */\r\n            this.orbitControls = new THREE.OrbitControls(this.camera, container);\r\n            this.orbitControls.target.copy(lookTarget);\r\n\r\n            this.dollyAnimation.lookAt.Hook(this.orbitControls.target, 'x', 'y', 'z');\r\n\r\n            let scope = this;\r\n            this.orbitControls.addEventListener('change', function(e){\r\n                scope.changed = true;\r\n            });\r\n            this.orbitControls.addEventListener('start', function(e){\r\n                scope.Dispatch(signals.userChange);\r\n            });\r\n            \r\n            this.orbitControls.Update = function(){\r\n                if(this.enabled){\r\n                    if(this.object.position.distanceTo(this.target) < 50){\r\n                        var v = new THREE.Vector3().subVectors(this.target, this.object.position).multiplyScalar(.5);\r\n                        this.target.add(v);\r\n                    }\r\n                    this.update();\r\n                }\r\n            };\r\n            this.orbitControls.Hold = function(){\r\n                this.saveState();\r\n                this.enabled = false;\r\n            };\r\n            this.orbitControls.Release = function(){\r\n                this.reset();\r\n                this.enabled = true;\r\n            };\r\n        }\r\n\r\n        \r\n        params = params || {\r\n            maxDistance: 9000.0 * /*units*/1,\r\n            maxPolarAngle: Math.PI * 0.895\r\n        }\r\n        if(params !== undefined){\r\n            this.orbitControls.maxDistance = params.maxDistance;\r\n            this.orbitControls.maxPolarAngle = params.maxPolarAngle;\r\n            this.orbitControls.autoRotate = false;\r\n        }\r\n\r\n        this.controls = this.orbitControls;\r\n    }\r\n\r\n    ToggleControls(){\r\n        this.Hold();\r\n\r\n        if(this.controls === this.orbitControls){\r\n            if(this.fpsControls){\r\n                this.fpsControls.LerpRotation(this.camera, 1);\r\n                this.FirstPersonControls();\r\n            }\r\n        }\r\n        else{\r\n            if(this.orbitControls){\r\n                this.OrbitControls();\r\n\r\n                // target\r\n                var maxDistance = 100;\r\n\r\n                var point = new THREE.Vector3(0, 0, -1);\r\n                var quat = new THREE.Quaternion();\r\n                point.applyQuaternion(this.camera.getWorldQuaternion(quat)).normalize().multiplyScalar(maxDistance * .5).add(this.camera.position);\r\n\r\n                this.SetTarget(point);\r\n            }\r\n        }\r\n\r\n        this.Release();\r\n    }\r\n\r\n    /** @param {THREE.Vector3} position */\r\n    SetTarget(position){\r\n        if(this.controls instanceof THREE.OrbitControls){\r\n            this.controls.target.copy(position);\r\n            this.changed = true;\r\n        }\r\n        else {\r\n            console.warn('SetTarget not implemented for control type:', this.controls);\r\n        }\r\n    }\r\n\r\n    /** @returns {THREE.Vector3} */\r\n    GetTarget(){\r\n        if(this.controls instanceof THREE.OrbitControls){\r\n            return this.controls.target;\r\n        }\r\n        else {\r\n            console.warn('GetTarget not implemented for control type:', this.controls);\r\n        }\r\n    }\r\n\r\n    Update(){\r\n        if(this.dollyAnimation.enabled){\r\n            this.dollyAnimation.position.Update();\r\n            this.dollyAnimation.lookAt.Update();\r\n            this.changed = true;\r\n        }\r\n\r\n        if(this.fovAnimation.enabled){\r\n            this.fovAnimation.fov.Update();\r\n            this.camera.updateProjectionMatrix();\r\n            this.changed = true;\r\n        }\r\n\r\n        if(this.controls !== undefined){\r\n            this.controls.Update();\r\n        }\r\n    }\r\n\r\n    Hold(){\r\n        if(this.enabled && this.controls !== undefined && this.controls.Hold){\r\n            this.controls.Hold();\r\n        }\r\n    }\r\n\r\n    Release(){\r\n        if(!this.enabled && this.controls !== undefined && this.controls.Release){\r\n            this.controls.Release();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {THREE.Box3} box3 \r\n     * @param {Number} [distanceMultiplier]\r\n     * @param {THREE.Vector3} [orientation]\r\n     * @param {Number} [fov] fov in degrees\r\n     * @returns {FrameCoords}\r\n     */\r\n    CalcFrameCoords(box3, distanceMultiplier, orientation, fov){\r\n       if(distanceMultiplier === undefined) distanceMultiplier = .75;\r\n\r\n       fov = (fov || this.camera.fov) * (Math.PI / 180);\r\n\r\n       let extent = tempVec3;\r\n       box3.getSize(extent);\r\n       let frameSize = Math.max(extent.x, extent.y, extent.z, 1);\r\n       let distance = Math.abs(frameSize / Math.sin(fov / 2)) * distanceMultiplier;\r\n       \r\n       let center = tempVec3_b;\r\n       box3.getCenter(center);\r\n       \r\n       let position = tempVec3;\r\n       orientation = orientation ? orientation : position.subVectors(this.camera.position, center); \r\n       position.copy(orientation).normalize().multiplyScalar(distance).add(center);\r\n       position.y = Math.abs(position.y);\r\n\r\n       tempCoords.position = position;\r\n       tempCoords.center = center;\r\n       return tempCoords;\r\n    }\r\n\r\n    /**\r\n     * @param {THREE.Box3} box3 \r\n     * @param {Number} [distanceMultiplier]\r\n     */\r\n    Frame(box3, distanceMultiplier){\r\n        let coords = this.CalcFrameCoords(box3, distanceMultiplier);\r\n\r\n        this.camera.position.copy(coords.position);\r\n        this.SetTarget(coords.center);\r\n    }\r\n\r\n    /**\r\n     * @param {Number} duration\r\n     * @param {THREE.Box3} box3 \r\n     * @param {Number} [distanceMultiplier]\r\n     */\r\n    TransitionToFrame(duration, box3, distanceMultiplier){\r\n        let endCoords = this.CalcFrameCoords(box3, distanceMultiplier);\r\n        this.TransitionFromToCoords(duration, undefined, endCoords);\r\n    }\r\n\r\n    /**\r\n     * @param {Number} duration\r\n     * @param {FrameCoords} startCoords \r\n     * @param {FrameCoords} endCoords \r\n     */\r\n    TransitionFromToCoords(duration, startCoords, endCoords){\r\n\r\n        if(!startCoords){\r\n            startCoords = ownCoords;\r\n            startCoords.position.copy(this.position);\r\n            startCoords.center.copy(this.orbitControls.target);\r\n        }\r\n\r\n        this.dollyAnimation.position.SetDurations(duration, duration, duration);\r\n        this.dollyAnimation.lookAt.SetDurations(duration, duration, duration);\r\n\r\n        let p = startCoords.position;\r\n        this.dollyAnimation.position.SetStartValues(p.x, p.y, p.z);\r\n        let tp = endCoords.position;\r\n        this.dollyAnimation.position.SetDeltas(tp.x - p.x, tp.y - p.y, tp.z - p.z);\r\n\r\n        p = startCoords.center;\r\n        this.dollyAnimation.lookAt.SetStartValues(p.x, p.y, p.z);\r\n        tp = endCoords.center;\r\n        this.dollyAnimation.lookAt.SetDeltas(tp.x - p.x, tp.y - p.y, tp.z - p.z);\r\n\r\n        this.dollyAnimation.position.Restart();\r\n        this.dollyAnimation.lookAt.Restart();\r\n        this.dollyAnimation.enabled = true;\r\n    }\r\n\r\n    /** @param {Number} duration @param {Number} fov */\r\n    TransitionToFOV(duration, fov){\r\n        let deltaFOV = fov - this.camera.fov;\r\n        if(Math.abs(deltaFOV) < epsilon) return;\r\n\r\n        this.fovAnimation.fov.duration = duration;\r\n        this.fovAnimation.fov.startValue = this.camera.fov;\r\n        this.fovAnimation.fov.delta = deltaFOV;\r\n        this.fovAnimation.fov.Restart();\r\n        this.fovAnimation.enabled = true;\r\n    }\r\n\r\n    /**\r\n     * @returns {Boolean}\r\n     */\r\n    get enabled(){\r\n        return this.controls && this.controls.enabled;\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nexport default Camera;\n\n\n// WEBPACK FOOTER //\n// ./src/api/scene/Camera.js","import Pool from \"./Pool\";\r\n\r\n/** \r\n * Tween update function\r\n * @param {Number} time \r\n * @param {Number} startValue \r\n * @param {Number} delta \r\n * @param {Number} duration\r\n * @returns {Number} value\r\n */\r\nfunction TweenCallback(time, startValue, delta, duration){}\r\n\r\n/**\r\n * On completed callback\r\n * @param {Tween} target\r\n */\r\nfunction TweenCompletedCallback(target){}\r\n\r\nvar clock = new THREE.Clock();\r\n\r\nfunction poolNewFN(){\r\n    return new Tween();\r\n}\r\n/** @param {Tween} tween */\r\nfunction poolResetFN(tween){\r\n    return tween;\r\n}\r\nvar pool = new Pool(poolNewFN, poolResetFN);\r\n\r\nconst functions = {\r\n    /** @type {TweenCallback} */\r\n    linear: function(t, b, c, d){\r\n        return b + c * (t / d);\r\n    },\r\n\r\n    ease: {\r\n        /** @type {TweenCallback} */\r\n        easeOutElastic: function(t, b, c, d) {\r\n            var ts=(t/=d)*t;\r\n            var tc=ts*t;\r\n            return b+c*(33*tc*ts + -106*ts*ts + 126*tc + -67*ts + 15*t);\r\n        },\r\n\r\n        /** @type {TweenCallback} */\r\n        easeOutQuad: function (t, b, c, d) {\r\n            return -c *(t/=d)*(t-2) + b;\r\n        },\r\n\r\n        /** @type {TweenCallback} */\r\n        easeOutCubic: function (t, b, c, d) {\r\n            return c*((t=t/d-1)*t*t + 1) + b;\r\n        },\r\n\r\n        easeInOutQuad: function (t, b, c, d) {\r\n            if ((t/=d/2) < 1) return c/2*t*t + b;\r\n            return -c/2 * ((--t)*(t-2) - 1) + b;\r\n        }\r\n    },\r\n\r\n    special: {\r\n        /** @type {TweenCallback} */\r\n        pingPong: function (t, b, c, d) {\r\n            return Math.sin(t / d * Math.PI) * c + b;\r\n        }\r\n    }\r\n};\r\n\r\n/**\r\n * On completed callback\r\n * @param {TweenCombo} target\r\n */\r\nfunction TweenComboCompletedCallback(target){}\r\n\r\nclass TweenCombo{\r\n    /**\r\n     * \r\n     * @param {Array<Tween>} tweens \r\n     */\r\n    constructor(...tweens){\r\n        this.tweens = tweens;\r\n\r\n        /** @type {TweenComboCompletedCallback} */\r\n        this.onComplete;\r\n        this.completed = false;\r\n    }\r\n\r\n    /** @param {Array<Number>} args */\r\n    SetDurations(...args){ for(var i = 0; i < this.tweens.length; i++) this.tweens[i].duration = args[i]; }\r\n\r\n    /** @param {Array<Number>} args */\r\n    SetDeltas(...args){ for(var i = 0; i < this.tweens.length; i++) this.tweens[i].delta = args[i]; }\r\n\r\n    /** @param {Array<Number>} args */\r\n    SetStartValues(...args){ for(var i = 0; i < this.tweens.length; i++) this.tweens[i].startValue = args[i]; }\r\n\r\n    /**\r\n     * @param {Object} object \r\n     * @param {Array<string>} properties \r\n     */\r\n    Hook(object, ...properties){\r\n        for(var i = 0; i < this.tweens.length; i++){\r\n            this.tweens[i].Hook(object, properties[i]);\r\n        };\r\n    }\r\n\r\n    Unhook(){\r\n        this.tweens.forEach(tween => tween.Unhook());\r\n    }\r\n\r\n    /** Restarts time */\r\n    Restart(){\r\n        this.tweens.forEach(tween => tween.Restart());\r\n    }\r\n\r\n    /**\r\n     * Update tween\r\n     * @param {Number} [t] [0, duration]\r\n     */\r\n    Update(t){\r\n        var completed = true;\r\n        this.tweens.forEach(tween => {\r\n            if(tween.completed === false)\r\n                tween.Update(t);\r\n\r\n            completed = completed && tween.completed;\r\n        });\r\n\r\n        this.completed = completed;\r\n        if(this.completed && this.onComplete)\r\n            this.onComplete(this);\r\n    }\r\n\r\n    /**\r\n     * Returns tweens to pool\r\n     */\r\n    Return(){\r\n        this.tweens.forEach(tween => {\r\n            pool.Return(tween);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @param {TweenCallback} callback \r\n     * @param {Number} startValue0\r\n     * @param {Number} startValue1\r\n     * @param {Number} startValue2\r\n     * @param {Number} delta0\r\n     * @param {Number} delta1\r\n     * @param {Number} delta2\r\n     * @param {Number} duration\r\n     */\r\n    static Request3(callback, duration, startValue0, delta0, startValue1, delta1, startValue2, delta2){\r\n        var tween0 = pool.Request();\r\n        tween0.Reset(callback, startValue0, delta0, duration);\r\n\r\n        var tween1 = pool.Request();\r\n        tween1.Reset(callback, startValue1, delta1, duration);\r\n\r\n        var tween2 = pool.Request();\r\n        tween2.Reset(callback, startValue2, delta2, duration);\r\n\r\n        var combo = new TweenCombo(tween0, tween1, tween2);\r\n        return combo;\r\n    }\r\n\r\n    /**\r\n     * @param {TweenCallback} callback \r\n     * @param {Number} duration \r\n     * @param {Array<Number>} args startValueN, deltaN\r\n     */\r\n    static RequestN(callback, duration, ...args){\r\n\r\n        let tweens = [];\r\n        for(let i = 0; i < args.length; i += 2){\r\n            let tween = pool.Request();\r\n            tween.Reset(callback, args[i], args[i + 1], duration);\r\n            tweens.push(tween);\r\n        }\r\n\r\n        let combo = new TweenCombo(...tweens);\r\n        return combo;\r\n    }\r\n}\r\n\r\nclass Tween{\r\n    /**\r\n     * @param {TweenCallback} callback \r\n     * @param {Number} [startValue] \r\n     * @param {Number} delta \r\n     * @param {Number} duration \r\n     */\r\n    constructor(callback, startValue, delta, duration){\r\n        this.Reset(callback, startValue, delta, duration);\r\n        \r\n        /** @type {TweenCompletedCallback} */\r\n        this.onComplete;\r\n    }\r\n\r\n    /**\r\n     * @param {TweenCallback} callback \r\n     * @param {Number} [startValue]\r\n     * @param {Number} delta \r\n     * @param {Number} duration \r\n     */\r\n    Reset(callback, startValue, delta, duration){\r\n        this.callback = callback;\r\n        this.startValue = startValue;\r\n        this.delta = delta;\r\n        this.duration = duration;\r\n\r\n        if(this.startValue === undefined && this.object && this.property){\r\n            this.startValue = this.object[this.property];\r\n        }\r\n\r\n        this.Restart();\r\n    }\r\n\r\n    /** Restarts time */\r\n    Restart(){\r\n        this.completed = false;\r\n        this.startTime = clock.getElapsedTime();\r\n    }\r\n\r\n    /**\r\n     * @param {Object} object \r\n     * @param {string} property \r\n     */\r\n    Hook(object, property){\r\n        this.object = object;\r\n        this.property = property;\r\n\r\n        if(this.startValue === undefined){\r\n            this.startValue = this.object[this.property];\r\n        }\r\n    }\r\n\r\n    Unhook(){\r\n        this.object = this.property = undefined;\r\n    }\r\n\r\n    /**\r\n     * Update tween\r\n     * @param {Number} [t] [0, duration]\r\n     */\r\n    Update(t){\r\n        if(t === undefined) t = clock.getElapsedTime() - this.startTime;\r\n\r\n        if(t >= this.duration){\r\n            this.completed = true;\r\n            let endValue = this.startValue + this.delta;\r\n        \r\n            if(this.object)\r\n                this.object[this.property] = endValue;\r\n            \r\n            if(this.onComplete)\r\n                this.onComplete(this);\r\n            \r\n            return endValue;\r\n        }\r\n\r\n        var x = this.callback(t, this.startValue, this.delta, this.duration);\r\n        if(this.object)\r\n            this.object[this.property] = x;\r\n        \r\n        return x;\r\n    }\r\n\r\n    Return(){\r\n        pool.Return(this);\r\n    }\r\n\r\n    /**\r\n     * @param {TweenCallback} callback \r\n     * @param {Number} [startValue]\r\n     * @param {Number} delta \r\n     * @param {Number} duration \r\n     */\r\n    static Request(callback, startValue, delta, duration){\r\n        var tween = pool.Request();\r\n        tween.Reset(callback, startValue, delta, duration);\r\n\r\n        return tween;\r\n    }\r\n\r\n    static get functions(){\r\n        return functions;\r\n    }\r\n}\r\n\r\nTween.Combo = TweenCombo;\r\n\r\nexport default Tween;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/Tween.js","\r\nconst _new = Symbol('new'),\r\n    _reset = Symbol('reset');\r\n\r\n/**\r\n * @template {T}\r\n */\r\nclass Pool{\r\n    /**\r\n     * @param {function(...args)=>T} fnNew \r\n     * @param {function(T, ...args)=>T} [fnReset]\r\n     */\r\n    constructor(fnNew, fnReset){\r\n        this.objects = [];\r\n\r\n        this[_new] = fnNew;\r\n        this[_reset] = fnReset;\r\n    }\r\n\r\n    /** Get a clean object (fnNew & fnReset) from the pool\r\n     * @returns {T}\r\n     */\r\n    Request(...args){\r\n        var object;\r\n\r\n        if(this.objects.length === 0){\r\n            object = this[_new](...args);\r\n        }\r\n        else{\r\n            object = this.objects[this.objects.length - 1];\r\n            --this.objects.length;\r\n        }\r\n\r\n        return this[_reset](object, ...args);\r\n    }\r\n\r\n    /** Make object available again\r\n     * @param {T} object \r\n     */\r\n    Return(object){\r\n        this.objects[this.objects.length] = object;\r\n    }\r\n}\r\n\r\nexport default Pool;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/Pool.js","import CargoView from \"./CargoView\";\r\nimport Utils from \"../utils/cik/Utils\";\r\nimport BoxEntry from \"../components/box/BoxEntry\";\r\nimport Asset from \"../components/assets/Asset\";\r\n\r\nconst unitCubeGeometry = new THREE.BoxBufferGeometry(1, 1, 1, 1, 1, 1);\r\nconst materialTemplate = new Asset.SolidMaterialType({roughness: 1, metalness: 0, flatShading: true});\r\n\r\nconst brightnessRange = [.45, .55];\r\nvar hueBase = Math.random();\r\nfunction nextColor(){\r\n    let color = new THREE.Color();\r\n    color.setHSL(hueBase, 1, brightnessRange[0] + Math.random() * (brightnessRange[1] - brightnessRange[0]));\r\n    hueBase = Utils.GoldenSeries(hueBase);\r\n    return color;\r\n}\r\n\r\nconst _materialSettings = Symbol('matSet');\r\nconst _color = Symbol('color');\r\n\r\nconst typeofNumber = 'number',\r\n    typeofString = 'string';\r\n\r\nclass CargoBoxView extends CargoView {\r\n    /**\r\n     * \r\n     * @param {BoxEntry} boxEntry \r\n     */\r\n    constructor(boxEntry){\r\n        super(boxEntry);\r\n\r\n        var material = materialTemplate.clone();\r\n\r\n        let colorHex = boxEntry.Description('color');\r\n        this[_color] = colorHex ? new THREE.Color(colorHex) : nextColor();\r\n        boxEntry.Description('color', this.color.getHex());\r\n\r\n        material.color = this.color;\r\n        this.mesh = new THREE.Mesh(unitCubeGeometry, material);\r\n        this.mesh.scale.copy(boxEntry.dimensions.vec3);\r\n\r\n        this.view.add(this.mesh);\r\n    }\r\n\r\n    /** @returns {BoxEntry} */\r\n    get entry(){ return super.entry; }\r\n    set entry(value){\r\n        super.entry = value;\r\n        var s = value.dimensions.vec3;\r\n        this.SetScale(s.x, s.y, s.z);\r\n\r\n        let colorHex = value.Description('color');\r\n        if(colorHex) this.color = colorHex;\r\n    }\r\n\r\n    /** @param {Number} value */\r\n    set focus(value){\r\n        super.focus = value;\r\n\r\n        if(this[_materialSettings]) Asset.RestoreMaterial(this.mesh.material, this[_materialSettings]);\r\n\r\n        if(Math.abs(1 - value) > .0001){\r\n            if(this[_materialSettings] === undefined){\r\n                this.mesh.material = this.mesh.material.clone();\r\n                this[_materialSettings] = {};\r\n                Asset.SetMaterialFocus(this.mesh.material, value, this[_materialSettings]);\r\n            }\r\n            else{\r\n                Asset.SetMaterialFocus(this.mesh.material, value);\r\n            }\r\n        }\r\n    }\r\n\r\n    get focus(){ return super.focus; }\r\n\r\n    /** @returns {THREE.Color} */\r\n    get color(){ return this[_color]; }\r\n\r\n    /** @param {Number} value hex */\r\n    set color(value){\r\n        /** @type {THREE.Color} */\r\n        let c = this[_color];\r\n        if(typeof value === typeofNumber) c.setHex(value);\r\n        else if(typeof value === typeofString) c.setHex(Number.parseInt(value));\r\n        else c.copy(value);\r\n        if(this[_materialSettings]) this[_materialSettings].color = c.getHex();\r\n        else this.mesh.material.color = c;\r\n        this.focus = super.focus;\r\n    }\r\n\r\n    /**\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {Number} z \r\n     */\r\n    SetScale(x, y, z){\r\n        this.mesh.scale.set(x, y, z);\r\n\r\n        if(this.labelView) this.labelView.view.position.z = params.width / 2 + this.entry.dimensions.length / 2;\r\n    }\r\n\r\n    ReflectEntry(){\r\n        this.entry = this.entry;\r\n    }\r\n\r\n    /** \r\n     * @param {string} value \r\n     * @param {import('./CargoView').CargoViewLabelParams} params */\r\n    SetLabel(value, params){\r\n        super.SetLabel(value, params);\r\n\r\n        this.labelView.view.scale.y = params.height;\r\n        this.labelView.view.scale.x = params.width;\r\n        this.labelView.view.position.z = params.width / 2 + this.entry.dimensions.length / 2;\r\n        this.labelView.view.position.y = .001;\r\n    }\r\n\r\n    /**\r\n     * @param {Number} x in radians\r\n     * @param {Number} y in radians\r\n     * @param {Number} z in radians\r\n     */\r\n    SetRotationAngles(x, y, z){\r\n        this.mesh.rotation.set(x, y, z);\r\n    }\r\n\r\n    static GetNextColor(){\r\n        return nextColor();\r\n    }\r\n}\r\n\r\nexport default CargoBoxView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/CargoBoxView.js","import CargoEntry from \"../components/common/CargoEntry\";\r\nimport Asset from \"../components/assets/Asset\";\r\nimport TextLabelView from \"./components/TextLabelView\";\r\n\r\n/**\r\n * @typedef CargoViewLabelParams\r\n * @property {Number} width\r\n * @property {Number} height\r\n */\r\n\r\nconst dummyGeometry = new THREE.SphereBufferGeometry(1, 4, 4);\r\nconst dummyMaterial = new Asset.TransparentMaterialType({color: 0xff0000, transparent: true, opacity: .5});\r\n\r\nconst _entry = Symbol('entry');\r\nconst _focus = Symbol('focus');\r\n\r\nclass CargoView {\r\n    /**\r\n     * @param {CargoEntry} entry \r\n     */\r\n    constructor(entry){\r\n\r\n        this[_entry] = entry;\r\n\r\n        /** @type {THREE.Mesh} */\r\n        this.mesh;\r\n\r\n        this.view = new THREE.Object3D();\r\n\r\n        this[_focus] = 1;\r\n    }\r\n\r\n    /** @returns {CargoEntry} */\r\n    get entry(){ return this[_entry]; }\r\n    set entry(value){\r\n        this[_entry] = value;\r\n    }\r\n\r\n    get position(){\r\n        return this.view.position;\r\n    }\r\n\r\n    set position(value){\r\n        this.view.position.copy(value);\r\n    }\r\n\r\n    /** @param {Number} value */\r\n    set focus(value){\r\n        this[_focus] = value;\r\n    }\r\n\r\n    get focus(){ return this[_focus]; }\r\n\r\n    ReflectEntry(){\r\n        \r\n    }\r\n\r\n    /** @param {string} value @param {CargoViewLabelParams} params */\r\n    SetLabel(value, params){\r\n        const height = 64;\r\n        let width = Math.floor( params.width / params.height * height );\r\n        if(this.labelView === undefined){\r\n            /** @type {import('./TextLabelView').TLVParams} */\r\n            let tlvParams = { font: '32px sans serif', backColor: 'rgb(0, 0, 0)', fontColor: 'rgb(255, 255, 255)', \r\n                textAlign: 'right', sidePadding: 16, width: width, height: height\r\n            };\r\n            let ratioToX = 64\r\n\r\n            this.labelView = new TextLabelView(tlvParams);\r\n            this.labelView.view.rotateY( 90 * Math.PI / 180 );\r\n            this.labelView.view.rotateX( -90 * Math.PI / 180 );\r\n            this.view.add(this.labelView.view);\r\n        }\r\n\r\n        this.labelView.UpdateText(value);\r\n    }\r\n\r\n    /**\r\n     * @param {CargoEntry} entry \r\n     */\r\n    static Dummy(entry){\r\n        var cargoView = new CargoView(entry);\r\n        cargoView.view = new THREE.Mesh(dummyGeometry, dummyMaterial);\r\n        return cargoView;\r\n    }\r\n\r\n}\r\n\r\nexport default CargoView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/CargoView.js","import Utils from \"./utils/cik/Utils\";\r\nimport Visualization from \"./components/Visualization\";\r\nimport User from \"./components/User\";\r\nimport App from \"./App\";\r\nimport Constants from \"./Constants\";\r\n\r\n/**\r\n * @typedef UXParams\r\n * @property {Boolean} hud default = true, create hud (hud currently disabled in api)\r\n * @property {Boolean} configure default = false, execute helpers that allow configuration\r\n * @property {Number} units default = 1, conversion to unit employed, default=1 for inches, for meters: units=0.0254\r\n * @property {Boolean} autoUpdatePack default = true, will auto-update the packing if entries are modified or deleted\r\n * @property {Number} backgroundColor default = 0xfefefe\r\n * @property {Constants.scaleRefFigure} scaleRefFigure default = man, human figure to show as scale reference\r\n * @property {Number} fov camera perspective fov\r\n */\r\nconst defaultParams = {\r\n    hud: true,\r\n    configure: false,\r\n    units: 1,\r\n    autoUpdatePack: true,\r\n    backgroundColor: 0xfefefe,\r\n    scaleRefFigure: Constants.scaleRefFigure.man,\r\n    fov: 15\r\n};\r\n\r\nclass UX{\r\n    /**\r\n     * \r\n     * @param {UXParams} params \r\n     */\r\n    constructor(params){\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n    }\r\n\r\n    /** @ignore ignore */\r\n    _Bind(value){\r\n        /** @type {App} */\r\n        let app = value;\r\n    \r\n        /** Interface with visual elements */\r\n\t\tthis.visualization = new Visualization(app);\r\n\r\n\t\t/** Interface with user input/output */\r\n        this.user = new User(app);\r\n    }\r\n\r\n}\r\n\r\nUX.User = User;\r\nUX.Visualization = Visualization;\r\n\r\nexport default UX;\n\n\n// WEBPACK FOOTER //\n// ./src/api/UX.js","import Logger from \"../utils/cik/Logger\";\r\nimport CargoBoxView from \"./CargoBoxView\";\r\nimport CargoView from \"./CargoView\";\r\nimport Signaler from \"../utils/cik/Signaler\";\r\nimport CargoGroup from \"../packer/CargoGroup\";\r\nimport Utils from \"../utils/cik/Utils\";\r\nimport CargoEntry from \"../components/common/CargoEntry\";\r\nimport FloatingShelf from \"./components/FloatingShelf\";\r\nimport Asset from \"../components/assets/Asset\";\r\nimport BoxEntry from \"../components/box/BoxEntry\";\r\nimport TextLabelView from \"./components/TextLabelView\";\r\nimport RaycastGroup, { RaycastCallback } from \"../utils/cik/input/RaycastGroup\";\r\nimport Outline from \"./components/Outline\";\r\nimport Tween from \"../utils/cik/Tween\";\r\n\r\n/**\r\n * @typedef {Object} CargoListViewParams\r\n * @property {import('../UX').default} ux\r\n * @property {Number} outlineOffset\r\n */\r\n\r\n/**\r\n * @typedef SortResult\r\n * @property {Number} min\r\n * @property {Number} max\r\n * @property {Number} cargoes\r\n */\r\n\r\nconst typeofString = 'string';\r\nconst epsilon = Math.pow(2, -52);\r\n\r\nconst _selectedEntryUID = Symbol('seUID');\r\n\r\n/** @type {Map<CargoView, TextLabelView>} */\r\nvar labels = new Map();\r\n\r\nvar tempBox = new THREE.Box3();\r\nvar tempVec = new THREE.Vector3();\r\n\r\nconst signals = {\r\n    sort: 'sort',\r\n    select: 'select',\r\n    deselect: 'deselect',\r\n    interact: 'interact'\r\n};\r\n\r\n/** @type {CargoListViewParams} */\r\nconst defaultParams = {\r\n    outlineOffset: 4\r\n};\r\n\r\nclass CargoListView extends Signaler {\r\n    /**\r\n     * @param {CargoListViewParams} params \r\n     */\r\n    constructor(params){\r\n        super();\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        this.view = new THREE.Object3D();\r\n        this.templatesView = new THREE.Object3D();\r\n        this.view.add(this.templatesView);\r\n\r\n        /** @type {Map<CargoGroup, CargoView>} */\r\n        this.cargoTemplateViews = new Map();\r\n\r\n        let units = this.params.ux.params.units;\r\n\r\n        // Shelf\r\n        /** @type {import('./components/FloatingShelf').FloatingShelfParams} */\r\n        let fsParams = {padding: new THREE.Vector3(10 * units, (this.params.outlineOffset + 1) * units, 10 * units), colorHex: Asset.ColorTemplates('Containers').Apply(0x000000)};\r\n        this.floatingShelf = new FloatingShelf(this.templatesView, fsParams);\r\n        this.view.add(this.floatingShelf.view);\r\n\r\n        // Interaction\r\n        this.raycastGroupItems = [];\r\n        this.raycastGroup = new RaycastGroup(this.raycastGroupItems, this.OnInteract.bind(this), \r\n            /** @param {CargoView} item */\r\n            function(item){\r\n                return item.view;\r\n            },\r\n            false,\r\n            true);\r\n\r\n        this.outline = new Outline({color: 0xffffff, opacity: 1, offsetFactor: this.params.outlineOffset * units});\r\n        this.view.add(this.outline.view);\r\n\r\n        // Transition\r\n        this.slidingAnimation = {\r\n            enabled: false,\r\n            position: Tween.Combo.RequestN(Tween.functions.ease.easeOutCubic, .5, 0, 0),\r\n            originalPosition: new THREE.Vector3(0, 0, 0)\r\n        };\r\n\r\n        let scope = this;\r\n        function onAnimationComplete(){\r\n            scope.slidingAnimation.enabled = false;\r\n        }\r\n        this.slidingAnimation.position.onComplete = onAnimationComplete;\r\n\r\n        this.slidingAnimation.position.Hook(this.view.position, 'y');\r\n    }\r\n\r\n    /**\r\n     * @param {CargoGroup} group \r\n     */\r\n    Add(group){\r\n        let units = this.params.ux.params.units;\r\n\r\n        let templateCargoView;\r\n        switch(group.entry.type){\r\n            case 'BoxEntry': {\r\n                templateCargoView = new CargoBoxView(group.entry);\r\n\r\n                let ticketParams = { width: 50 * units, height: 20 * units };\r\n\r\n                const height = 96;\r\n                let width = Math.floor( ticketParams.width / ticketParams.height * height );\r\n                /** @type {import('./TextLabelView').TLVParams} */\r\n                let tlvParams = { font: '64px sans-serif', backColor: 'rgb(0, 0, 0)', fontColor: 'rgb(255, 255, 255)', \r\n                    textAlign: 'left', sidePadding: 30, width: width, height: height\r\n                };\r\n\r\n                let labelView = new TextLabelView(tlvParams);\r\n                labelView.view.rotateY( 90 * Math.PI / 180 );\r\n                labelView.view.rotateX( -90 * Math.PI / 180 );\r\n                labelView.view.scale.y = ticketParams.height;\r\n                labelView.view.scale.x = ticketParams.width;\r\n                /** @type {BoxEntry} */\r\n                let boxEntry = group.entry;\r\n                labelView.view.position.z = ticketParams.width / 2;\r\n                this.view.add(labelView.view);\r\n\r\n                labelView.UpdateText(boxEntry.quantity);\r\n\r\n                labels.set(templateCargoView, labelView);\r\n                \r\n                break;\r\n            }\r\n\r\n            default :\r\n                templateCargoView = CargoView.Dummy(group.entry);\r\n                Logger.Warn('group.entry.type not supported by viewer,', group);\r\n                break;\r\n        }\r\n\r\n        this.cargoTemplateViews.set(group, templateCargoView);\r\n        this.templatesView.add(templateCargoView.view);\r\n\r\n        this.raycastGroupItems.push(templateCargoView);\r\n        this.raycastGroup.UpdateItems(this.raycastGroupItems);\r\n\r\n        this.Sort();\r\n        this.floatingShelf.Update();\r\n    }\r\n\r\n    /**\r\n     * @param {CargoGroup} group \r\n     */\r\n    UpdateGroup(group){\r\n        let templateCargoView = this.cargoTemplateViews.get(group);\r\n        templateCargoView.ReflectEntry();\r\n\r\n        this.Sort();\r\n        this.floatingShelf.Update();\r\n\r\n        if(this[_selectedEntryUID] === group.entry.uid) this.SetOutline(templateCargoView);\r\n    }\r\n\r\n    /**\r\n     * @param {CargoGroup} group \r\n     */\r\n    Remove(group){\r\n        var templateCargoView = this.cargoTemplateViews.get(group);\r\n        if(templateCargoView){\r\n\r\n            let raycastGroupIndex = this.raycastGroupItems.indexOf(templateCargoView);\r\n            if(raycastGroupIndex !== -1) this.raycastGroupItems.splice(raycastGroupIndex, 1);\r\n            this.raycastGroup.UpdateItems(this.raycastGroupItems);\r\n\r\n            this.cargoTemplateViews.delete(group);\r\n            this.templatesView.remove(templateCargoView.view);\r\n\r\n            if(this[_selectedEntryUID] === group.entry.uid) this.outline.box = false;\r\n\r\n            this.Sort();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * RaycastCallback\r\n     * @param {CargoView} cargoView\r\n     * @param {THREE.Intersection} intersection\r\n     */\r\n    OnInteract(cargoView, intersection){\r\n        this.Dispatch(signals.interact, cargoView.entry);\r\n    }\r\n\r\n    /** @param {CargoView} cargoView */\r\n    Select(entryUID){\r\n\r\n        this[_selectedEntryUID] = entryUID;\r\n\r\n        if(!entryUID){\r\n            this.outline.box = false;\r\n            this.Dispatch(signals.deselect);\r\n        }\r\n        else{\r\n            let cargoView = this.GetTemplate(entryUID);\r\n            this.SetOutline(cargoView);\r\n            this.Dispatch(signals.select, cargoView.entry);\r\n        }\r\n    }\r\n\r\n    /** @param {CargoView} target */\r\n    SetOutline(target){\r\n        this.outline.box = target instanceof CargoBoxView ? target.mesh : target.view;\r\n    }\r\n\r\n    SlideUp(targetY, duration){\r\n        let deltaY = targetY - this.view.position.y;\r\n        if(Math.abs(deltaY) < epsilon) return;\r\n\r\n        this.slidingAnimation.position.SetDurations(duration);\r\n        this.slidingAnimation.position.SetStartValues(this.view.position.y);\r\n        this.slidingAnimation.position.SetDeltas(deltaY);\r\n        this.slidingAnimation.position.Restart();\r\n        this.slidingAnimation.enabled = true;\r\n    }\r\n\r\n    SlideDown(duration){\r\n        let deltaY = this.slidingAnimation.originalPosition.y - this.view.position.y;\r\n        if(Math.abs(deltaY) < epsilon) return;\r\n\r\n        this.slidingAnimation.position.SetDurations(duration);\r\n        this.slidingAnimation.position.SetStartValues(this.view.position.y);\r\n        this.slidingAnimation.position.SetDeltas(deltaY);\r\n        this.slidingAnimation.position.Restart();\r\n        this.slidingAnimation.enabled = true;\r\n    }\r\n\r\n    Update(){\r\n        if(this.slidingAnimation.enabled){\r\n            this.slidingAnimation.position.Update();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {CargoGroup|CargoEntry|string|Number} id \r\n     */\r\n    GetTemplate(id){\r\n        var group;\r\n        if(id instanceof CargoGroup){\r\n            group = id;\r\n        }\r\n        else if(id instanceof CargoEntry){\r\n            for(var cargoGroup of this.cargoTemplateViews.keys()){\r\n                if(cargoGroup.entry === id) group = cargoGroup;\r\n            }\r\n        }\r\n        else{\r\n            for(var cargoGroup of this.cargoTemplateViews.keys()){\r\n                if(cargoGroup.entry.uid === id) group = cargoGroup;\r\n            }\r\n        }\r\n\r\n        return this.cargoTemplateViews.get(group);\r\n    }\r\n\r\n    /**\r\n     * @param {CargoView} cargoView \r\n     * @param {string} value \r\n     * @param {string} textColor css\r\n     */\r\n    UpdateLabel(cargoView, value, textColor){\r\n        let textLabelView = labels.get(cargoView);\r\n        if(textLabelView){\r\n            if(textColor) textLabelView.params.fontColor = textColor;\r\n            textLabelView.UpdateText(value);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {Map<CargoGroup, CargoView>} cargoViews \r\n     * @returns {Number}\r\n     */\r\n    Sort(){\r\n\r\n        this.SortMapBySize();\r\n\r\n        var units = this.params.ux.params.units;\r\n\r\n        this.view.updateMatrixWorld(true);\r\n        const worldToLocal = new THREE.Matrix4().getInverse(this.templatesView.matrixWorld);\r\n        const padding = 5 * units,\r\n            start = 0;\r\n\r\n        var i = 0,\r\n            offset = 0;\r\n            \r\n        /**\r\n         * @type {SortResult}\r\n         */\r\n        var result = {min: start, max: start, cargoes: 0};\r\n        \r\n        var list = this.cargoTemplateViews.values(),\r\n            cargoView;\r\n        while( ( cargoView = list.next() ).done === false ){\r\n\r\n            cargoView.value.position.set(start, 0, 0);\r\n\r\n            tempBox.setFromObject(cargoView.value.view);\r\n            tempBox.applyMatrix4(worldToLocal);\r\n\r\n            tempBox.getSize(tempVec);\r\n            var halfSize = tempVec.x / 2;\r\n            if(i > 0)\r\n                offset += halfSize;\r\n\r\n            cargoView.value.position.set(start + offset, tempVec.y / 2 + padding, -tempVec.z / 2);\r\n\r\n            let labelView = labels.get(cargoView.value);\r\n            labelView.view.position.x = cargoView.value.position.x;\r\n            labelView.view.position.y = padding + 1 * units;\r\n\r\n            offset += halfSize + padding;\r\n\r\n            i++;\r\n        }\r\n\r\n        result.min = start;\r\n        result.max = offset;\r\n        result.cargoes = i;\r\n        this.Dispatch(signals.sort, result);\r\n    }\r\n\r\n    SortMapBySize(){\r\n        /**\r\n         * \r\n         * @param {[CargoGroup, CargoListView]} a \r\n         * @param {[CargoGroup, CargoListView]} b \r\n         */\r\n        function sort(a, b){\r\n            return -a[0].entry.dimensions.Compare(b[0].entry.dimensions);\r\n        }\r\n\r\n        var list = [...this.cargoTemplateViews.entries()];\r\n        list.sort(sort);\r\n        this.cargoTemplateViews = new Map(list);\r\n        return;\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nexport default CargoListView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/CargoListView.js","import { styles, Element, Draggable } from \"./UIUtils\";\r\nimport Config from \"./Config\";\r\n//import dat from \"./datGUIConsole\";\r\n\r\nconst serializeModes = Config.serializeModes;\r\n\r\nvar current = undefined,\r\n    onFocus = [],\r\n    onFocusLost = [];\r\n\r\nclass Smart {\r\n    /**\r\n     * @param {*} target \r\n     * @param {string} label \r\n     */\r\n    constructor(target, label){\r\n        this.target = target;\r\n        this.label = label;\r\n\r\n        var scope = this;\r\n        \r\n        this.gui = new (window.dat || require(\"./datGUIConsole\").default).GUI({autoPlace: false});\r\n        this.draggable = new Draggable(this.label, 250);\r\n        this.draggable.Add(this.gui.domElement);\r\n        this.draggable.closeBtn.onclick = function(){\r\n            scope.Hide();\r\n        };\r\n\r\n        var ui = Element.Add(this.draggable);\r\n        this.draggable.Hide();\r\n\r\n        this.onFocus = [];\r\n        this.onFocusLost = [];\r\n    }\r\n\r\n    Delete(){\r\n        this.Hide();\r\n        this.draggable.Delete();\r\n        this.gui.destroy();\r\n        this.onFocus.length = this.onFocusLost.length = 0;\r\n    }\r\n\r\n    UpdateGUI(){\r\n        Smart.UpdateGUI(this.gui);\r\n    }\r\n\r\n    Hide(){\r\n        this.visible = false;\r\n        this.draggable.Hide();\r\n        Smart.SetCurrent(undefined);\r\n    }\r\n\r\n    Show(){\r\n        if(current !== undefined){\r\n            if(current === this) return;\r\n\r\n            var oldPos = current.draggable.GetPosition();\r\n            this.draggable.SetPosition(oldPos.x, oldPos.y);\r\n\r\n            current.Hide();\r\n        }\r\n        this.visible = true;\r\n        this.draggable.Show();\r\n        Element.AddStyle(this.draggable.domElement, styles.UIWiggleAnim);\r\n        Smart.SetCurrent(this);\r\n\r\n        this.UpdateGUI();\r\n    }\r\n    \r\n    /**\r\n     * \r\n     * @param {string} folderName \r\n     * @param {*} target \r\n     * @param {Function} guiChanged \r\n     * @param {serializeModes} serializeMode\r\n     * @param {Array<string|Config.Controller>} args \r\n     */\r\n    Config(folderName, target, guiChanged, serializeMode, ...args){\r\n        this.config = new Config(target);\r\n        this.config.Track(...args);\r\n        this.config.Edit(guiChanged, folderName, this.gui, {serializeMode: serializeMode, save: false});\r\n        return this.config.gui;\r\n    }\r\n\r\n    /**\r\n     * @param {string} category \r\n     */\r\n    MakeShortcut(category){\r\n        Smart.MakeShortcut(category, this);\r\n    }\r\n\r\n    static get serializeModes(){\r\n        return serializeModes;\r\n    }\r\n\r\n    /**\r\n     * @param {string} category \r\n     * @param {Smart} target \r\n     */\r\n    static MakeShortcut(category, target){\r\n        Config.MakeShortcut(category, target.label, function(){\r\n            if(target.visible){\r\n                target.Hide();\r\n            }\r\n            else{\r\n                target.Show();\r\n            }\r\n        });\r\n    }\r\n\r\n    static SetCurrent(current){\r\n        var iFocus;\r\n        if(current !== undefined){\r\n            for(iFocus = 0; iFocus < onFocusLost.length; iFocus++){\r\n                onFocusLost[iFocus](current);\r\n            }\r\n            for(iFocus = 0; iFocus < current.onFocusLost.length; iFocus++){\r\n                current.onFocusLost[iFocus]();\r\n            }\r\n        }\r\n\r\n        current = current;\r\n\r\n        if(current !== undefined){\r\n            for(iFocus = 0; iFocus < onFocus.length; iFocus++){\r\n                onFocus[iFocus](current);\r\n            }\r\n            for(iFocus = 0; iFocus < current.onFocus.length; iFocus++){\r\n                current.onFocus[iFocus]();\r\n            }\r\n        }\r\n    }\r\n\r\n    static UpdateGUI(gui){\r\n        for (var i in gui.__controllers) {\r\n            gui.__controllers[i].updateDisplay();\r\n        }\r\n\r\n        var folders = Object.values(gui.__folders);\r\n        for(i = 0; i < folders.length; i++){\r\n            this.UpdateGUI(folders[i]);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Smart;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/config/Smart.js","\r\nrequire('../../../../min-dependencies/lib/three/controls/TransformControls');\r\n\r\nconst spaces = {\r\n    world: 'world',\r\n    local: 'local'\r\n};\r\n\r\nconst modes = {\r\n    translate: 'translate',\r\n    rotate: 'rotate',\r\n    scale: 'scale'\r\n};\r\n\r\n/**\r\n * @type {Object<Control3D>}\r\n */\r\nvar defaultControls = {};\r\n\r\nclass Control3D {\r\n\r\n    /**\r\n     * @param {THREE.Camera} camera \r\n     * @param {HTMLElement} domElement \r\n     */\r\n    constructor(camera, domElement){\r\n        this.camera = camera;\r\n        this.control = new THREE.TransformControls(this.camera, domElement);\r\n        this.control.addEventListener('change', this.Update.bind(this));\r\n\r\n        this.control.traverse(function(child){\r\n            child.renderOrder = 2;\r\n        });\r\n\r\n        this.visible = false;\r\n    }\r\n\r\n    get visible(){\r\n        return this.control.visible;\r\n    }\r\n\r\n    set visible(value){\r\n        this.control.visible = value;\r\n        if(value === false){\r\n            this.Detach();\r\n        }\r\n    }\r\n\r\n    Attach(target){\r\n        this.control.attach(target);\r\n    }\r\n\r\n    Detach(){\r\n        this.control.detach();\r\n    }\r\n\r\n    Toggle(target){\r\n        if(this.control.object){\r\n            this.control.detach();\r\n        }\r\n        else{\r\n            this.control.attach(target);\r\n        }\r\n    }\r\n\r\n    Update(){\r\n        this.control.update();\r\n    }\r\n\r\n    get space(){\r\n        return this.control.space;\r\n    }\r\n\r\n    set space(value){\r\n        this.control.space = value;\r\n    }\r\n\r\n    // translate || rotate || scale\r\n    set mode(value){\r\n        this.control.setMode(value);\r\n    }\r\n\r\n    static get spaces(){\r\n        return spaces;\r\n    }\r\n\r\n    static get modes(){\r\n        return modes;\r\n    }\r\n\r\n    /**\r\n     * @param {string} id \r\n     * @param {THREE.Camera} camera \r\n     * @param {HTMLElement} domElement \r\n     * @returns {Control3D}\r\n     */\r\n    static Configure(id, camera, domElement){\r\n        var control = new Control3D(camera, domElement);\r\n        defaultControls[id] = control;\r\n        return control;\r\n    }\r\n\r\n    /**\r\n     * @returns {Control3D}\r\n     */\r\n    static Request(id){\r\n        return defaultControls[id];\r\n    }\r\n}\r\n\r\nexport default Control3D;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/config/Control3D.js","import Region from \"./Region\";\r\nimport { reduceRectangles } from \"./Math2D\";\r\n\r\nimport { debugging, debugClear, debugLog, debugRegion, sleep, format } from './CUBDebug';\r\n\r\n/** RegionFindCallback\r\n * @callback RegionFindCallback\r\n * @param {Region} region\r\n * @returns {Object | Boolean}\r\n */\r\n\r\n/** @typedef Vec2 @property {Number} x @property {Number} y */\r\n\r\n/** @typedef Rectangle @property {Vec2} p1 @property {Vec2} p2 @property {Vec2} p3 @property {Vec2} p4 \r\n * @property {Number} weight @property {Number} weightCapacity @property {Number} stackingCapacity \r\n */\r\n\r\nconst smallValue = .000001;\r\nconst minRegionAxis = smallValue;\r\n\r\nclass RegionsTree{\r\n    /** @param {Region} root */\r\n    constructor(root){\r\n        this.regions = [root];\r\n    }\r\n\r\n    /** @param {Number} index */\r\n    Get(index){\r\n        return this.regions[index];\r\n    }\r\n\r\n    /** @param {RegionFindCallback} callback @param {*} thisArg */\r\n    Find(callback, thisArg){\r\n        let numRegions = this.regions.length;\r\n\r\n        for(let iRegion = 0; iRegion < numRegions; iRegion++){\r\n            let region = this.regions[iRegion];\r\n            let search = callback.call(thisArg, region);\r\n            if(search) return search;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /** @param {Region} region * @param {Region} fit * @returns {Boolean} false if region has been deleted */\r\n    Occupy(region, fit){\r\n\r\n        // Subtracts fit from region and calculates new bounding regions\r\n        var newRegions = region.Subtract(fit, minRegionAxis);\r\n\r\n        // Add new bounding regions if any\r\n        if(newRegions) this.regions.push(...newRegions);\r\n\r\n        // Check that region is still valid, otherwise remove it\r\n        if(region.length < minRegionAxis){\r\n            let regionIndex = this.regions.indexOf(region);\r\n            this.regions.splice(regionIndex, 1);\r\n            return false;\r\n        }\r\n\r\n        var debugUIDs = [];\r\n        if(!newRegions) newRegions = [];\r\n        newRegions.push(region);\r\n        //console.group('Occupy');\r\n        newRegions.forEach(region => {\r\n            //console.log(region.ToString());\r\n            debugUIDs.push(debugRegion(region, 0xffff0000, true, -1, true));\r\n        });\r\n        //console.groupEnd();\r\n\r\n        debugClear(debugUIDs);\r\n\r\n        return true;\r\n    }\r\n\r\n    /** @param {Number} width */\r\n    ProcessRegionsPreferredX(width){\r\n        let regions = this.regions,\r\n            numRegions = regions.length;\r\n        //let width = this.container.width;\r\n\r\n        for(let iRegion = 0; iRegion < numRegions; iRegion++){\r\n            let region = regions[iRegion];\r\n\r\n            if(Math.abs(region.x) < smallValue) region.preferredX = 0;\r\n            else if(Math.abs(region.x + region.width - width) < smallValue) region.preferredX = 1;\r\n        }\r\n    }\r\n\r\n    /** @param {Number} width @param {Number} height */\r\n    ProcessRegionsMergeExpand(width, height){\r\n        let regions = this.regions,\r\n            numRegions = regions.length;\r\n\r\n        let toInt = 1 / smallValue;\r\n        function coordID(value){\r\n            return Math.floor(value * toInt);\r\n        }\r\n\r\n        /** @typedef Level @property {Number} y @property {Array<Rectangle>} rectangles */\r\n        /** @type {Array<Level>} */\r\n        let levels = {};\r\n\r\n        let neighbours = [], rectangles = [];\r\n        for(let iRegion = 0; iRegion < numRegions; iRegion++){\r\n            let regionA = regions[iRegion];\r\n\r\n            if(regionA.weightCapacity > smallValue){\r\n                neighbours.length = 0;\r\n                neighbours.push(iRegion);\r\n                \r\n                for(let jRegion = iRegion + 1; jRegion < numRegions; jRegion++){\r\n                    let regionB = regions[jRegion];\r\n\r\n                    if(regionB.weightCapacity > smallValue && Math.abs(regionA.y - regionB.y) < smallValue){\r\n                        let intersects = regionA.Intersects(smallValue, regionB);\r\n                        if(intersects){\r\n                            neighbours.push(jRegion);\r\n                        }\r\n                    }\r\n                }\r\n\r\n                let numNeighbours = neighbours.length;\r\n                if(numNeighbours > 1){\r\n                    rectangles.length = 0;\r\n\r\n                    for(let iNeighbour = 0; iNeighbour < numNeighbours; iNeighbour++){\r\n                        let neighbourA = regions[neighbours[iNeighbour]];\r\n\r\n                        for(let jNeighbour = iNeighbour + 1; jNeighbour < numNeighbours; jNeighbour++){\r\n                            let neighbourB = regions[neighbours[jNeighbour]];\r\n\r\n                            let connectedNeighbours = neighbourA.ConnectFloorRects(neighbourB);\r\n                            rectangles.push(...connectedNeighbours);\r\n                        }\r\n                    }\r\n\r\n                    if(rectangles.length > 0){\r\n                        let yCat = coordID(regionA.y);\r\n                        if(levels[yCat] === undefined) levels[yCat] = {y: regionA.y, rectangles: []};\r\n                        levels[yCat].rectangles.push(...rectangles);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        var levelsYCats = Object.keys(levels);\r\n        for(let iYCat = 0, numYCats = levelsYCats.length; iYCat < numYCats; iYCat++){\r\n            /** @type {Level} */\r\n            let level = levels[levelsYCats[iYCat]];\r\n            let rectangles = level.rectangles;\r\n            let regionY = level.y;\r\n            let regionHeight = height - regionY;\r\n            \r\n            reduceRectangles(rectangles);\r\n            for(let iRect = 0, numRects = rectangles.length; iRect < numRects; iRect++){\r\n                let rect = rectangles[iRect];\r\n                let rx = rect.p1.x, ry = rect.p1.y;\r\n                let rw = rect.p3.x - rx, rh = rect.p3.y - ry;\r\n\r\n                // Calculate preferred packing side based on center point relative to container\r\n                let preferredX = (rx.x + rw / 2) < (width / 2) ? 0 : 1;\r\n                let newRegion = new Region(rx, regionY, ry, rw, regionHeight, rh, 0);\r\n                newRegion.SetWeights(rect.weight, rect.weightCapacity, rect.stackingCapacity);\r\n                this.regions.push(newRegion);\r\n            }\r\n        }\r\n    }\r\n\r\n    ProcessRegionsForZeroRegions(){\r\n        let regions = this.regions;\r\n        for(let iRegion = 0; iRegion < regions.length; iRegion++){\r\n            let region = regions[iRegion];\r\n            if(region.width < minRegionAxis || region.height < minRegionAxis || region.length < minRegionAxis){\r\n                regions.splice(iRegion, 1);\r\n                iRegion--;\r\n            }\r\n        }\r\n    }\r\n\r\n    ProcessRegionsEnclosed(){\r\n        var regions = this.regions;\r\n\r\n        for(let iRegion = 0; iRegion < regions.length; iRegion++){\r\n            let regionA = regions[iRegion];\r\n            let volumeA = regionA.volume;\r\n\r\n            for(let jRegion = iRegion + 1; jRegion < regions.length; jRegion++){\r\n                let regionB = regions[jRegion];\r\n                let volumeB = regionB.volume;\r\n\r\n                if(volumeA < volumeB){\r\n                    // If a A is completely contained within B, remove the A\r\n                    if(regionB.ContainsRegion(smallValue, regionA)){\r\n                        regions.splice(iRegion, 1);\r\n                        iRegion--;\r\n                        break;\r\n                    }\r\n                }\r\n                else{\r\n                    // If a B is completely contained within A, remove the B\r\n                    if(regionA.ContainsRegion(smallValue, regionB)){\r\n                        regions.splice(jRegion, 1);\r\n                        jRegion--;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @param {Function} sortFunction */\r\n    Sort(sortFunction){\r\n        this.regions.sort(sortFunction);\r\n    }\r\n}\r\n\r\nexport default RegionsTree;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/RegionsTree.js","import Utils from \"../../utils/cik/Utils\";\r\nimport { Item, Container } from \"./Components\";\r\nimport Region from \"./Region\";\r\nimport { PackedItem, PackedContainer } from \"./PackedComponents\";\r\n\r\n\r\nclass HeuristicResult{\r\n    /** @param {Region} containingRegion @param {Region} packedRegion @param {Number} orientation */\r\n    constructor(containingRegion, packedRegion, orientation){\r\n        this.containingRegion = containingRegion;\r\n        this.packedRegion = packedRegion;\r\n        this.orientation = orientation;\r\n    }\r\n\r\n    /** @param {HeuristicResult} value */\r\n    Copy(value){\r\n        this.containingRegion = value.containingRegion;\r\n        this.packedRegion = value.packedRegion;\r\n        this.orientation = value.orientation;\r\n    }\r\n}\r\n\r\n/** @typedef {import('./CUB').PackingAssistantParams HeuristicParams} */\r\n\r\nconst _workingSet = Symbol('workingSet');\r\n\r\nclass Heuristic{\r\n    /** @param {HeuristicParams} params */\r\n    constructor(params){\r\n        this.params = params;\r\n    }\r\n\r\n    Init(){}\r\n\r\n    set workingSet(value){\r\n        this[_workingSet] = value;\r\n        this.Init();\r\n    }\r\n\r\n    get workingSet(){\r\n        return this[_workingSet];\r\n    }\r\n\r\n    /** @param {Item} item @returns {HeuristicResult} */\r\n    Fit(item){}\r\n}\r\n\r\nHeuristic.Result = HeuristicResult;\r\n\r\nexport default Heuristic;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/Heuristic.js","\r\nconst type = 'Dimensions';\r\nconst _vec3 = Symbol('vec3');\r\n\r\nconst epsilon = Math.pow(2, -52);\r\nconst numberType = 'number';\r\n\r\nclass Dimensions {\r\n    /**\r\n     * @param {Number} width \r\n     * @param {Number} length \r\n     * @param {Number} height \r\n     */\r\n    constructor(width, length, height){\r\n        if(width === undefined) width = 0;\r\n        if(length === undefined) length = 0;\r\n        if(height === undefined) height = 0;\r\n        \r\n        this.Set(width, length, height);\r\n        this[_vec3] = new THREE.Vector3();\r\n    }\r\n\r\n    /**\r\n     * @param {Number} width \r\n     * @param {Number} length \r\n     * @param {Number} height \r\n     */\r\n    Set(width, length, height){\r\n        /** @type {Number} */\r\n        this.width = width;\r\n        /** @type {Number} */\r\n        this.length = length;\r\n        /** @type {Number} */\r\n        this.height = height;\r\n    }\r\n\r\n    /**\r\n     * Returns a THREE.Vector3 representation of the dimensions\r\n     * Beware of ordering: x=width, y=height and z=length\r\n     * @returns {THREE.Vector3}\r\n     */\r\n    get vec3(){\r\n        return this[_vec3].set(this.width, this.height, this.length);\r\n    }\r\n\r\n    get volume(){\r\n        return this.width * this.height * this.length;\r\n    }\r\n\r\n    Abs(){\r\n        if(this.width < 0) this.width = -this.width;\r\n        if(this.length < 0) this.length = -this.length;\r\n        if(this.height < 0) this.height = -this.height;\r\n        return this;\r\n    }\r\n\r\n    Compare(dimensions){\r\n        var d = this.volume - dimensions.volume;\r\n        if(d < -epsilon) return -1;\r\n        if(d > epsilon) return 1;\r\n        return 0;\r\n    }\r\n\r\n    Copy(dimensions){\r\n        this.Set(dimensions.width, dimensions.length, dimensions.height);\r\n    }\r\n\r\n    Clone(){\r\n        var dimensions = new Dimensions(this.width, this.length, this.height);\r\n        return dimensions;\r\n    }\r\n\r\n    ToString(){\r\n        return this.width.toFixed(2) + 'x' + this.length.toFixed(2) + 'x' + this.height.toFixed(2);\r\n    }\r\n\r\n    toJSON(){\r\n        return {\r\n            type: type,\r\n            width: this.width,\r\n            length: this.length,\r\n            height: this.height\r\n        };\r\n    }\r\n\r\n    static IsVolume(dimensions){\r\n        return Dimensions.Assert(dimensions) \r\n            && dimensions.width > epsilon\r\n            && dimensions.length > epsilon\r\n            && dimensions.height > epsilon\r\n        ;\r\n    }\r\n\r\n    static FromJSON(data){\r\n        if(data.type !== type) console.warn('Data supplied is not: ' + type);\r\n\r\n        var dimensions = new Dimensions(data.width, data.length, data.height);\r\n        return dimensions;\r\n    }\r\n\r\n    static Assert(dimensions){\r\n        return dimensions instanceof Dimensions\r\n            && typeof dimensions.width === numberType\r\n            && typeof dimensions.length === numberType\r\n            && typeof dimensions.height === numberType\r\n        ;\r\n    }\r\n}\r\n\r\nexport default Dimensions;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/box/Dimensions.js","\r\nclass Resources{\r\n    constructor(){\r\n        this.texturesPath = '';\r\n    }\r\n}\r\n\r\nexport default Resources;\n\n\n// WEBPACK FOOTER //\n// ./src/api/Resources.js","import CargoEntry from \"../components/common/CargoEntry\";\r\nimport Cargo from \"./Cargo\";\r\n\r\n\r\nclass CargoGroup {\r\n    /**\r\n     * \r\n     * @param {CargoEntry} entry\r\n     */\r\n    constructor(entry){\r\n        this.entry = entry;\r\n\r\n        /** @type {Array<Cargo>} */\r\n        this.cargoes = [];\r\n\r\n        this.template = new Cargo(this);\r\n        this.quantity = this.entry.quantity;\r\n    }\r\n\r\n    get quantity(){\r\n        return this.cargoes.length;\r\n    }\r\n\r\n    set quantity(value){\r\n        var currentQuantity = this.cargoes.length;\r\n        if(value < currentQuantity){\r\n            this.cargoes.length = value;\r\n            this.entry.quantity = value;\r\n        }\r\n        else if(value > currentQuantity){\r\n            for(var i = currentQuantity; i < value; i++){\r\n                this.cargoes[i] = this.template.Clone();\r\n            }\r\n        }\r\n    }\r\n\r\n    ToString(){\r\n        var output = 'CargoGroup(' + this.quantity + ' x ' + this.entry.ToString() + ')';\r\n\r\n        return output;\r\n    }\r\n\r\n}\r\n\r\nexport default CargoGroup;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/CargoGroup.js","\r\nfunction stopPropagation(e){\r\n    e.stopPropagation();\r\n}\r\n\r\nvar stylesheet;\r\n\r\n/** @param {string|Array<string>} css */\r\nfunction createCSS(css){\r\n    if(stylesheet === undefined){\r\n        stylesheet = document.createElement('style');\r\n        stylesheet.type = 'text/css';\r\n        document.getElementsByTagName('head')[0].appendChild(stylesheet);\r\n    }\r\n    if(css instanceof Array)\r\n        css = css.join('\\n');\r\n    \r\n    if(css.length > 1) stylesheet.innerHTML += css + '\\n';\r\n}\r\n\r\ncreateCSS([\r\n    '@keyframes wiggle {',\r\n    '    20% { transform: rotate(5deg); }',\r\n    '    50% { transform: rotate(0deg); }',\r\n    '    75% { transform: rotate(-5deg); }',\r\n    '   100% { transform: rotate(0deg); }',\r\n    '}'\r\n]);\r\n\r\nconst styles = {\r\n    UIFitContent: 'display: inline-block; padding-bottom: 1em;',\r\n    UIHideMenu: 'display: none !important;',\r\n\r\n    UIDraggable: 'position: absolute; -webkit-user-select: none; -moz-user-select: none; -o-user-select: none; \\\r\n                -ms-user-select: none; -khtml-user-select: none; user-select: none; z-index: 1; padding: 4px;',\r\n    UIDHeader: 'color: #ffffff; display: inline-block; word-wrap: break-word; font-family: Monospace; font-size: 1.2em; height: 100%; width: 100%;',\r\n    UIDCloseButton: 'background-color: rgb(19, 19, 19); border: none; color: white; padding: 8px 2px; text-align: center; \\\r\n                text-decoration: none; margin-left: -38px; margin-right: 10px; font-family: Monospace; font-size: small; cursor: pointer;',\r\n    UIWiggleAnim: 'display: inline-block; animation: wiggle .15s;'\r\n    \r\n}\r\n\r\nclass Element {\r\n\r\n    /**\r\n     * @property {HTMLElement} domElement\r\n     */\r\n\r\n    constructor(){\r\n        /**\r\n         * @type {HTMLElement}\r\n         */\r\n        this._domElement;\r\n    }\r\n\r\n    set domElement(value){\r\n        if(this._domElement){\r\n            this._domElement.removeEventListener('mousedown', stopPropagation);\r\n            this._domElement.removeEventListener('mouseup', stopPropagation);\r\n        }\r\n\r\n        this._domElement = value;\r\n\r\n        this._domElement.addEventListener('mousedown', stopPropagation);\r\n        this._domElement.addEventListener('mouseup', stopPropagation);\r\n    }\r\n\r\n    get domElement(){\r\n        return this._domElement;\r\n    }\r\n\r\n    EnableChildInput(){\r\n        if(this._domElement){\r\n            this._domElement.removeEventListener('mousedown', stopPropagation);\r\n            this._domElement.removeEventListener('mouseup', stopPropagation);\r\n        }\r\n    }\r\n\r\n    Hide(){\r\n        Element.AddStyle(this.domElement, styles.UIHideMenu);\r\n    }\r\n    \r\n    Show(){\r\n        Element.RemoveStyle(this.domElement, styles.UIHideMenu);\r\n    }\r\n\r\n    Remove(){\r\n        if(this._domElement){\r\n            this._domElement.removeEventListener('mousedown', stopPropagation);\r\n            this._domElement.removeEventListener('mouseup', stopPropagation);\r\n\r\n            this._domElement.remove();\r\n            delete this._domElement;\r\n        }\r\n    }\r\n\r\n    get opacity(){\r\n        return parseFloat(this.domElement.style.opacity);\r\n    }\r\n\r\n    set opacity(value){\r\n        this.domElement.style.opacity = value;\r\n    }\r\n\r\n    static _Span(text, attributes){\r\n        return {\r\n            type: 'span',\r\n            label: text, \r\n            attributes: attributes\r\n        };\r\n    }\r\n\r\n    static Span(text, attributes){\r\n        var _span = this._Span(text, attributes);\r\n        return crel(_span.type, _span.attributes, _span.label);\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {HTMLElement} element \r\n     * @param {string} style \r\n     */\r\n    static AddStyle(element, style){\r\n        let eStyle = element.style.cssText;\r\n        let index = eStyle.indexOf(style);\r\n        if(index === -1){\r\n            element.style.cssText += style;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {HTMLElement} element \r\n     * @param {string} style \r\n     */\r\n    static RemoveStyle(element, style){\r\n        element.style.cssText = element.style.cssText.replace(style, '');\r\n    }\r\n\r\n    static get CreateCSS(){\r\n        return createCSS;\r\n    }\r\n\r\n    static Add(element){\r\n        document.body.appendChild(element.domElement);\r\n    }\r\n}\r\n\r\nconst widths = {\r\n    small: 162,\r\n    medium: 242,\r\n    large: 362\r\n};\r\n\r\nclass Draggable extends Element {\r\n    constructor(title, width){\r\n\r\n        super();\r\n\r\n        var dom;\r\n\r\n        var move = function(xpos, ypos){\r\n            dom.style.left = xpos + 'px';\r\n            dom.style.top = ypos + 'px';\r\n        };\r\n\r\n        var diffX = 0,\r\n            diffY = 0;\r\n        var eWi = 0,\r\n            eHe = 0,\r\n            cWi = 0,\r\n            cHe = 0;\r\n\r\n        var onMouseMove = function(evt){\r\n            evt = evt || window.event;\r\n            var posX = evt.clientX,\r\n                posY = evt.clientY,\r\n                aX = posX - diffX,\r\n                aY = posY - diffY;\r\n                if (aX < 0) aX = 0;\r\n                if (aY < 0) aY = 0;\r\n                if (aX + eWi > cWi) aX = cWi - eWi;\r\n                if (aY + eHe > cHe) aY = cHe -eHe;\r\n            move(aX, aY);\r\n        };\r\n        \r\n        var startMoving = function(evt){\r\n            var p = dom.parentNode;\r\n            var container = (p !== undefined && p !== null) ? p : window;\r\n            container = document.body;\r\n            evt = evt || window.event;\r\n            var posX = evt.clientX,\r\n                posY = evt.clientY,\r\n            divTop = dom.style.top,\r\n            divLeft = dom.style.left;\r\n\r\n            eWi = parseInt(dom.style.width);\r\n            eHe = parseInt(dom.style.height);\r\n            cWi = parseInt(container.style.width);\r\n            cHe = parseInt(container.style.height);\r\n\r\n            container.style.cursor='move';\r\n            divTop = divTop.replace('px','');\r\n            divLeft = divLeft.replace('px','');\r\n            diffX = posX - divLeft;\r\n            diffY = posY - divTop;\r\n            document.addEventListener('mousemove', onMouseMove);\r\n        };\r\n        \r\n        var stopMoving = function(){\r\n            var p = dom.parentNode;\r\n            var container = (p !== undefined && p !== null) ? p : window;\r\n            container = document.body;\r\n            container.style.cursor = 'default';\r\n            document.removeEventListener('mousemove', onMouseMove);\r\n        };\r\n\r\n        if(width === undefined) width = widths.medium;\r\n        var left = 60 + Math.floor(Math.random() * 160),\r\n            top = 60 + Math.floor(Math.random() * 60);\r\n        var domStyle = 'left:' + left + 'px; top:' + top + 'px; width:' + width + 'px; background-color: rgba(0, 0, 0, .8);' + styles.UIFitContent + styles.UIDraggable;\r\n        dom = crel('div', {style: domStyle});\r\n        var head = crel('div', {style: 'display: flex;'});\r\n        dom.appendChild(head);\r\n        var header = crel('div', {onmousedown: startMoving, onmouseup: stopMoving, style: styles.UIDHeader}, title);\r\n        \r\n        var scope = this;\r\n        var close = function(){\r\n            scope.Close();\r\n        };\r\n        var closeBtn = crel('button', {onclick: close, style: styles.UIDCloseButton}, 'Close');\r\n        head.appendChild(closeBtn);\r\n        head.appendChild(header);\r\n\r\n        dom.closeBtn = closeBtn;\r\n\r\n        this.domElement = dom;\r\n        this.EnableChildInput();\r\n        this.closeBtn = closeBtn;\r\n    }\r\n\r\n    Close(){\r\n        this.domElement.remove();\r\n    }\r\n\r\n    Add(elt){\r\n        this.domElement.appendChild(elt);\r\n    }\r\n\r\n    GetPosition(){\r\n        var style = window.getComputedStyle(this.domElement),\r\n            left = parseFloat(style.left),\r\n            top = parseFloat(style.top);\r\n        \r\n        return {x: left, y: top};\r\n    }\r\n\r\n    SetPosition(x, y){\r\n        this.domElement.style.left = x + 'px';\r\n        this.domElement.style.top = y + 'px';\r\n    }\r\n\r\n    static get widths(){\r\n        return widths;\r\n    }\r\n}\r\n\r\nexport {\r\n    styles,\r\n    Element,\r\n    Draggable\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/config/UIUtils.js","import Signaler from \"../utils/cik/Signaler\";\r\nimport CargoEntry from \"../components/common/CargoEntry\";\r\nimport CargoGroup from \"./CargoGroup\";\r\nimport BoxEntry from \"../components/box/BoxEntry\";\r\n\r\nconst stringType = 'string';\r\n\r\nconst signals = {\r\n    groupAdded: 'groupAdded',\r\n    groupRemoved: 'groupRemoved',\r\n    groupModified: 'groupModified'\r\n};\r\n\r\nclass CargoList extends Signaler{\r\n    constructor(){\r\n        super();\r\n\r\n        /** @type {Map<string, CargoGroup>} */\r\n        this.groups = new Map();\r\n    }\r\n\r\n    /** Adds a new CargoGroup\r\n     * @param {CargoEntry} entry \r\n     */\r\n    Add(entry){\r\n        var group = new CargoGroup(entry);\r\n\r\n        this.groups.set(entry.uid, group);\r\n        this.Dispatch(signals.groupAdded, group);\r\n    }\r\n\r\n    /** Adds a new CargoGroup\r\n     * @param {CargoEntry} entry \r\n     */\r\n    Modify(entry){\r\n        var group = this.groups.get(entry.uid);\r\n        this.Dispatch(signals.groupModified, group);\r\n    }\r\n\r\n    /** Removes the CargoGroup using its uid\r\n     * @param {string} uid \r\n     */\r\n    Remove(uid){\r\n        var group = this.groups.get(uid);\r\n        if(group){\r\n            this.groups.delete(uid);\r\n            this.Dispatch(signals.groupRemoved, group);\r\n        }\r\n    }\r\n\r\n    /** @param {string} entryUID @returns {BoxEntry} the entry if it exists */\r\n    GetEntry(entryUID){\r\n        if(this.groups.has(entryUID)) return this.groups.get(entryUID).entry;\r\n    }\r\n\r\n    get ready(){\r\n        return this.groups.size > 0;\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nexport default CargoList;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/CargoList.js","import Container from \"./container/Container\";\r\nimport Signaler from \"../utils/cik/Signaler\";\r\n\r\nconst signals = {\r\n    containerAdded: 'containerAdded'\r\n};\r\n\r\nconst _currentIndex = Symbol('currentIndex');\r\n\r\nclass PackingSpace extends Signaler {\r\n    constructor(){\r\n        super();\r\n        \r\n        this[_currentIndex] = -1;\r\n\r\n        /**\r\n         * @type {Container}\r\n         */\r\n        this.containers = [];\r\n    }\r\n\r\n    /** @param {Container} container */\r\n    AddContainer(container){\r\n        this.containers.push(container);\r\n        this[_currentIndex]++;\r\n\r\n        this.Dispatch(signals.containerAdded, container);\r\n    }\r\n\r\n    /** @returns {Container} */\r\n    get current(){\r\n        var currentIndex = this[_currentIndex];\r\n        if(currentIndex !== -1){\r\n            return this.containers[currentIndex];\r\n        }\r\n    }\r\n\r\n    get ready(){\r\n        return this[_currentIndex] !== -1;\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nexport default PackingSpace;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/PackingSpace.js","var g;\r\n\r\n// This works in non-strict mode\r\ng = (function() {\r\n\treturn this;\r\n})();\r\n\r\ntry {\r\n\t// This works if eval is allowed (see CSP)\r\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\r\n} catch(e) {\r\n\t// This works if the window reference is available\r\n\tif(typeof window === \"object\")\r\n\t\tg = window;\r\n}\r\n\r\n// g can still be undefined, but nothing to do about it...\r\n// We return undefined, instead of nothing here, so it's\r\n// easier to handle this case. if(!global) { ...}\r\n\r\nmodule.exports = g;\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/global.js\n// module id = 34\n// module chunks = 0","/*\r\nconst _callback = Symbol('callback');\r\n/** @returns {function} /\r\nget callback(){ return this[_callback]; }\r\nset callback(value){\r\n    this[_callback] = value;\r\n}\r\n*/\r\n\r\nclass UpdateComponent{\r\n    /**\r\n     * \r\n     * @param {Boolean} active \r\n     * @param {Number} interval \r\n     * @param {function(Number)} callback\r\n     */\r\n    constructor(active, interval, callback){\r\n        this.active = active === undefined ? false : active;\r\n        this.interval = interval === undefined ? 1 / 30 : interval;\r\n        this.callback = callback;\r\n        this.lastUpdateTime = 0;\r\n    }\r\n\r\n    /**\r\n     * @param {Number} now \r\n     */\r\n    Update(now){\r\n        this.lastUpdateTime = now;\r\n        this.callback(now);\r\n    }\r\n}\r\n\r\nexport default UpdateComponent;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/input/UpdateComponent.js","\r\n/**\r\n * RaycastCallback\r\n * \r\n * @callback RaycastCallback\r\n * @param {Object} obj\r\n * @param {THREE.Intersection} intersection\r\n */\r\n\r\n /**\r\n  * Mapping function\r\n  * \r\n  * @callback RaycastMapping\r\n  * @param {Object} obj\r\n  */\r\n\r\nclass RaycastGroup {\r\n\r\n    /**\r\n     * \r\n     * @param {Array<THREE.Object3D>} items \r\n     * @param {RaycastCallback} callback \r\n     * @param {RaycastMapping} collectionQuery \r\n     * @param {Boolean} updateProperty \r\n     * @param {Boolean} recursive \r\n     */\r\n    constructor (items, callback, collectionQuery, updateProperty, recursive){\r\n        /**\r\n         * @type {Boolean}\r\n         */\r\n        this.enabled = true;\r\n\r\n        this.items = items;\r\n        this.callback = callback;\r\n        this.updateProperty = updateProperty !== undefined ? updateProperty : false;\r\n        this.recursive = recursive !== undefined ? recursive : false;\r\n\r\n        if(collectionQuery === undefined){\r\n            this.raycastItems = this.items;\r\n        }\r\n        else{\r\n            this.raycastItems = [];\r\n            this.collectionQuery = collectionQuery;\r\n            this.GetRaycastItems(this.collectionQuery);\r\n        }\r\n    }\r\n\r\n    GetRaycastItems(collectionQuery){\r\n        for(var iItem = 0; iItem < this.items.length; iItem++){\r\n            var rItem = collectionQuery(this.items[iItem]);\r\n            if(rItem !== undefined){\r\n                this.raycastItems.push(rItem);\r\n            }\r\n            else{\r\n                this.items.splice(iItem, 1);\r\n                Cik.Log('raycastItem is undefined, entry removed from .items array');\r\n            }\r\n        }\r\n    }\r\n\r\n    UpdateItems(items, collectionQuery){\r\n        this.items = items;\r\n        if(collectionQuery === undefined) collectionQuery = this.collectionQuery;\r\n\r\n        if(collectionQuery === undefined){\r\n            this.raycastItems = this.items;\r\n        }\r\n        else{\r\n            this.raycastItems.length = 0;\r\n            this.collectionQuery = collectionQuery;\r\n            this.GetRaycastItems(this.collectionQuery);\r\n        }\r\n    }\r\n\r\n    UpdateRaycastItems(){\r\n        this.raycastItems.length = 0;\r\n        for(var i = 0; i < this.items.length; i++){\r\n            let raycastItem = this.collectionQuery(this.items[i]);\r\n            if(raycastItem) this.raycastItems.push(raycastItem);\r\n        }\r\n    }\r\n\r\n    Raycast(raycaster){\r\n        if(this.enabled === false) return;\r\n\r\n        \r\n        if(this.updateProperty){\r\n            this.UpdateRaycastItems();\r\n        }\r\n        \r\n        var raycastItems = this.raycastItems;\r\n        \r\n        // if ( object.visible === false || object.parent === null) return; in THREE.Raycaster.intersectObject()\r\n        var intersects = raycaster.intersectObjects(raycastItems, this.recursive);\r\n        if (intersects.length > 0) {\r\n            if(this.collectionQuery){\r\n                var raycastItemIndex = this.BubbleUpForIndex(intersects[0].object, raycastItems);\r\n                if(raycastItemIndex !== -1) this.callback(this.items[raycastItemIndex], intersects[0]);\r\n            }\r\n            else{\r\n                this.callback(intersects[0].object, intersects[0]);\r\n            }\r\n        }\r\n    }\r\n\r\n    BubbleUpForIndex(child, collection){\r\n        var nestLimit = 100;\r\n        var numCollection = collection.length;\r\n        while(child !== null && nestLimit-- > 0){\r\n            for(var i = 0; i < numCollection; i++) if(collection[i] === child) return i;\r\n            child = child.parent;\r\n        }\r\n        return -1;\r\n    }\r\n}\r\n\r\nexport default RaycastGroup;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/input/RaycastGroup.js","\r\nclass Controller {\r\n    constructor(params){\r\n\r\n        this.params = params;\r\n\r\n        // Containers\r\n        this.itemsContainer = new THREE.Object3D();\r\n        this.itemsContainer.name = \"itemsContainer\";\r\n        this.miscContainer = new THREE.Object3D();\r\n        this.miscContainer.name = \"miscContainer\";\r\n        this.ambientContainer = new THREE.Object3D();\r\n        this.ambientContainer.name = \"ambientContainer\";\r\n        this.defaults = new THREE.Object3D();\r\n        this.defaults.name = \"defaults\";\r\n\r\n        // Scene\r\n        this.scene = new THREE.Scene();\r\n\r\n        // Setup rest\r\n        this.scene.add(this.itemsContainer);\r\n        this.scene.add(this.miscContainer);\r\n        this.scene.add(this.ambientContainer);\r\n        this.scene.add(this.defaults);\r\n    }\r\n\r\n    Add(object, container){\r\n        if(container === undefined) container = this.miscContainer;\r\n        container.add(object);\r\n    }\r\n\r\n    AddDefault(object){\r\n        this.defaults.add(object);\r\n    }\r\n\r\n    Remove(object){\r\n        if(typeof object === 'string'){\r\n            var objName = object;\r\n            object = this.itemsContainer.getObjectByName(objName);\r\n            if(object === undefined) object = this.miscContainer.getObjectByName(objName);\r\n            if(object === undefined) return;\r\n        }\r\n        this.itemsContainer.remove(object);\r\n        this.miscContainer.remove(object);\r\n    }\r\n}\r\n\r\nexport default Controller;\n\n\n// WEBPACK FOOTER //\n// ./src/api/scene/Controller.js","import CargoEntry from '../components/common/CargoEntry';\r\nimport BoxEntry from '../components/box/BoxEntry';\r\nimport CargoBoxView from './CargoBoxView';\r\nimport CargoView from './CargoView';\r\nimport Utils from '../utils/cik/Utils';\r\nimport { Transition, Slide } from '../utils/cik/transitions/Transition';\r\nimport Asset from '../components/assets/Asset';\r\n\r\nconst epsilon = Math.pow(2, -52);\r\n\r\nvar tempBox3 = new THREE.Box3();\r\nvar tempVec3 = new THREE.Vector3();\r\n\r\n\r\n/**\r\n * @typedef {Object} EntryInputViewParams\r\n * @property {import('../UX').default} ux\r\n * @property {SceneSetup} sceneSetup\r\n * @property {scaleFigure} scaleFigure\r\n */\r\n\r\nconst _scaleFigure = Symbol('scaleFigure');\r\nconst scaleFigure = {\r\n    man: 'man',\r\n    woman: 'woman',\r\n    none: 'none'\r\n};\r\n\r\n/** @type {EntryInputViewParams} */\r\nconst defaultParams = {\r\n    scaleFigure: scaleFigure.man\r\n};\r\n\r\nclass EntryInputView{\r\n    /** @param {EntryInputViewParams} params */\r\n    constructor(params){\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n        const scope = this;\r\n\r\n        this.view = new THREE.Object3D();\r\n        this.preview = new THREE.Object3D();\r\n        this.view.add(this.preview);\r\n\r\n        /** @type {Map<string, CargoView>} */\r\n        this.previewTypes = new Map();\r\n\r\n        let units = this.params.ux.params.units;\r\n        this.offsetX = 0;\r\n\r\n        // scale ref\r\n        const height = 71 * units;\r\n\r\n        let material = new THREE.MeshBasicMaterial({color: 0x000000, transparent : true, side: THREE.DoubleSide});\r\n        Asset.SetTextureMap('scaleref-alphaMap.jpg', material, 'alphaMap').then( (alphaMap) => {\r\n            alphaMap.repeat.setX(.5);\r\n        });\r\n\r\n        let refMesh = new THREE.Mesh(\r\n            new THREE.PlaneGeometry(height / 2, height, 1, 1),\r\n            material\r\n        );\r\n\r\n        this.offsetX = 60 * units;\r\n        refMesh.position.x = this.offsetX;\r\n\r\n        this.view.add(refMesh);\r\n        this.refMesh = refMesh;\r\n        this.scaleFigure = this.params.scaleFigure;\r\n\r\n        tempBox3.setFromObject(this.refMesh);\r\n        tempBox3.getSize(tempVec3);\r\n        this.offsetX -= tempVec3.x / 2;\r\n\r\n        let bkgMesh = new THREE.Mesh(\r\n            new THREE.PlaneGeometry(height * 6, height * 1.8, 1, 1),\r\n            new THREE.MeshBasicMaterial({color: 0xffffff, depthWrite: false, depthFunc: THREE.NeverDepth, side: THREE.DoubleSide})\r\n        );\r\n\r\n        bkgMesh.position.z = -2 * units;\r\n\r\n        this.view.add(bkgMesh);\r\n\r\n        this.rotate = false;\r\n\r\n        this.transition = new Transition(this.view, this.view, .25);\r\n        this.slideIn = new Slide('x', 1.2, 0);\r\n        this.slideIn.Init(this.transition);\r\n        this.slideOut = new Slide('x', 0, 1.2);\r\n        this.slideOut.Init(this.transition);\r\n        /** @param {Slide} transitionController */\r\n        function onTransitionComplete(transitionController){\r\n            if(transitionController === scope.slideOut){\r\n                scope.Hide();\r\n            }\r\n            else{\r\n                scope.rotate = true;\r\n            }\r\n        }\r\n        this.transition.On(Transition.signals.complete, onTransitionComplete);\r\n        \r\n        this.Preview();\r\n    }\r\n\r\n    /** @param {scaleFigure} value */\r\n    set scaleFigure(value){\r\n        this[_scaleFigure] = value;\r\n        let refMesh = this.refMesh;\r\n        if(refMesh instanceof THREE.Mesh){\r\n            /** @type {THREE.Texture} */\r\n            let alphaMap = refMesh.material.alphaMap;\r\n            if(value === scaleFigure.man){\r\n                alphaMap.offset.setX(0);\r\n            }\r\n            else{\r\n                alphaMap.offset.setX(.5);\r\n            }\r\n        }\r\n    }\r\n\r\n    get scaleFigure(){ return this[_scaleFigure]; }\r\n\r\n    static get scaleFigure(){ return scaleFigure; }\r\n\r\n    /**\r\n     * @param {CargoEntry} entry \r\n     */\r\n    Preview(entry){\r\n\r\n        let valid = entry;\r\n\r\n        if(valid){\r\n            if(entry instanceof BoxEntry) valid = entry.dimensions.volume > epsilon;\r\n        }\r\n\r\n        if(!valid){\r\n            this.End();\r\n            return false;\r\n        }\r\n\r\n        let c = this.preview.children;\r\n        while(c.length > 0) this.preview.remove(c[c.length - 1]);\r\n\r\n        let units = this.params.ux.params.units;\r\n        let offsetX = this.offsetX;\r\n\r\n        if(entry instanceof BoxEntry){\r\n            /** @type {CargoBoxView} */\r\n            let boxView = this.previewTypes.get(entry.type);\r\n            if(boxView){\r\n                boxView.entry = entry;\r\n            }\r\n            else{\r\n                boxView = new CargoBoxView(entry);\r\n                this.previewTypes.set(entry.type, boxView);\r\n\r\n                boxView.mesh.material = boxView.mesh.material.clone();\r\n                boxView.mesh.material.depthWrite = false;\r\n            }\r\n\r\n            boxView.mesh.renderOrder = Number.MAX_SAFE_INTEGER - 10;\r\n            this.preview.add(boxView.view);\r\n\r\n            this.preview.position.x = -Math.max(entry.dimensions.width, entry.dimensions.length) / 2 + offsetX;\r\n            this.preview.position.y = entry.dimensions.height / 2 + tempBox3.min.y;\r\n        }\r\n\r\n        this.Start();\r\n    }\r\n\r\n    Show(){\r\n        this.view.visible = true;\r\n    }\r\n\r\n    Start(){\r\n        if(this.previewing === false){\r\n            this.rotate = false;\r\n            this.transition.controller = this.slideIn;\r\n            this.transition.Start();\r\n        }\r\n        this.Show();\r\n    }\r\n\r\n    Hide(){\r\n        this.view.visible = false;\r\n    }\r\n\r\n    End(){\r\n        if(this.previewing === true){\r\n            this.transition.controller = this.slideOut;\r\n            this.transition.Start();\r\n        }\r\n    }\r\n\r\n    get previewing(){ return this.view.visible; }\r\n\r\n    /** @param {Number} now @param {Number} deltaTime */\r\n    Update(now, deltaTime){\r\n        if(this.previewing){\r\n            if(this.rotate) this.preview.rotateY(-Math.PI / 10 * deltaTime / 1000);\r\n            this.transition.Update();\r\n        }\r\n    }\r\n}\r\n\r\nexport default EntryInputView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/EntryInputView.js","class TextField {\r\n    /**\r\n     * @param {string} label \r\n     * @param {string} content \r\n     */\r\n    constructor(label, content){\r\n        /**\r\n         * @type {string}\r\n         */\r\n        this.label = label;\r\n        /**\r\n         * @type {string}\r\n         */\r\n        this.content = content;\r\n    }\r\n\r\n    /**\r\n     * @param {TextField} field \r\n     */\r\n    Copy(field){\r\n        this.label = field.label;\r\n        this.content = field.content;\r\n    }\r\n\r\n    Clone(){\r\n        var field = new TextField(this.label, this.content);\r\n        return field;\r\n    }\r\n\r\n    static get defaultContent(){\r\n        return '-';\r\n    }\r\n}\r\n\r\nexport default TextField;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/common/TextField.js","import Signaler from \"../../utils/cik/Signaler\";\r\nimport Utils from \"../../utils/cik/Utils\";\r\n\r\nvar tlWatchTimer, tlWatchEntries;\r\nfunction tlWatchUpdater(){\r\n    for(let i = 0; i < tlWatchEntries.length; i++){\r\n        let entry = tlWatchEntries[i];\r\n        let newValue = entry.owner[entry.propertyName];\r\n        if(newValue !== entry.savedValue){\r\n            entry.savedValue = newValue;\r\n            entry.tl.value = newValue;\r\n        }\r\n    };\r\n}\r\nfunction addTLWatch(tl, owner, propertyName){\r\n    if(tlWatchTimer === undefined){\r\n        tlWatchEntries = [];\r\n        tlWatchTimer = setInterval(tlWatchUpdater, 200);\r\n    }\r\n    tlWatchEntries.push({tl: tl, owner: owner, propertyName: propertyName, savedValue: null});\r\n}\r\n\r\nconst _value = Symbol('value');\r\nconst typeofString = 'string';\r\n\r\nconst signals = {\r\n    change: 'change'\r\n};\r\n\r\nclass TextLabel extends Signaler{\r\n    constructor(){\r\n        super();\r\n\r\n        this[_value] = '';\r\n    }\r\n\r\n    get value(){\r\n        return this[_value];\r\n    }\r\n\r\n    /** @param {string} v */\r\n    set value(v){\r\n        if(v !== typeofString) v = this.GetString(v);\r\n\r\n        let changed = this[_value] !== v;\r\n        this[_value] = v;\r\n        if(changed) this.Dispatch(signals.change, this);\r\n    }\r\n\r\n    GetString(v){\r\n        return v.ToString ? v.ToString() : v.toString();\r\n    }\r\n\r\n    Watch(owner, propertyName){\r\n        addTLWatch(this, owner, propertyName);\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nconst defaultGeometry = new THREE.PlaneGeometry(1, 1, 1, 1);\r\n\r\n/**\r\n * @typedef TLVParams\r\n * @property {string} font css 32px sans-serif\r\n * @property {string} textAlign start, end, left, right or center\r\n * @property {string} sidePadding px\r\n * @property {Number} fontColor css\r\n * @property {Number} backColor css\r\n * @property {Number} width px\r\n * @property {Number} height px\r\n */\r\n/** @type {TLVParams} */\r\nconst defaultParams = {\r\n    font: '32px sans-serif',\r\n    textAlign: 'center',\r\n    sidePadding: 16,\r\n    fontColor: 0x000000,\r\n    backColor: 0xffffff,\r\n    width: 256,\r\n    height: 64\r\n};\r\n\r\nclass TextLabelView{\r\n    \r\n    /** @param {TLVParams} params */\r\n    constructor(params){\r\n        \r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        let material = new THREE.MeshBasicMaterial({color: 0xffffff, side: THREE.DoubleSide});\r\n        this.view = new THREE.Mesh(defaultGeometry, material);\r\n    }\r\n\r\n    /** @param {TextLabel} value */\r\n    set textLabel(value){\r\n        value.On(TextLabel.signals.change, this.OnChange.bind(this));\r\n    }\r\n\r\n    /** @param {TextLabel} textLabel */\r\n    OnChange(textLabel){\r\n        let text = textLabel.value;\r\n        this.UpdateText(text);\r\n    }\r\n\r\n    /** @param {string} text */\r\n    UpdateText(text){\r\n        if(this.canvas2d === undefined)\r\n            this.canvas2d = document.createElement('canvas');\r\n\r\n        this.canvas2d.width = this.params.width;\r\n        this.canvas2d.height = this.params.height;\r\n\r\n        let context2d = this.canvas2d.getContext('2d');\r\n            context2d.fillStyle = this.params.backColor;\r\n            context2d.fillRect(0, 0, this.params.width + 2, this.params.height + 2);\r\n            context2d.fillStyle = this.params.fontColor;\r\n            context2d.font = this.params.font;\r\n            context2d.textAlign = this.params.textAlign;\r\n            context2d.textBaseline = 'middle';\r\n\r\n        let x = this.params.textAlign === 'start' || this.params.textAlign === 'left' ? this.params.sidePadding :\r\n            ( this.params.textAlign === 'end' || this.params.textAlign === 'right' ? this.params.width - this.params.sidePadding :\r\n            ( this.params.width / 2 ) );\r\n        context2d.fillText(text, x, this.params.height / 2);\r\n\r\n        //\r\n        let mesh = this.view;\r\n        /** @type {THREE.MeshBasicMaterial} */\r\n        let material = mesh.material;\r\n        if(!material.map){\r\n            material.map = new THREE.CanvasTexture(this.canvas2d);\r\n            material.map.minFilter = THREE.LinearFilter;\r\n            material.map.anisotropy = 1.4;\r\n        }\r\n        else{\r\n            material.map.image = this.canvas2d;\r\n        }\r\n        material.map.needsUpdate = true;\r\n    }\r\n\r\n}\r\n\r\nTextLabelView.Label = TextLabel;\r\n\r\nexport default TextLabelView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/components/TextLabelView.js","import EntryInputView from \"./view/EntryInputView\";\r\n\r\nclass Constants{\r\n    constructor(){\r\n\r\n    }\r\n\r\n    static get scaleRefFigure(){ return EntryInputView.scaleFigure; }\r\n}\r\n\r\nexport default Constants;\n\n\n// WEBPACK FOOTER //\n// ./src/api/Constants.js","import { Element } from \"./UIUtils\";\r\n\r\nif(window.dat && !window.dat.guiExtensions){\r\n\r\n    window.dat.guiExtensions = true;\r\n\r\n    Element.CreateCSS([\r\n        '.tooltip .tooltiptext {',\r\n        '    visibility: hidden;',\r\n        '    position: absolute;',\r\n        '    width: 120px;',\r\n        '    background-color: #111;',\r\n        '    color: #fff;',\r\n        '    text-align: center;',\r\n        '    padding: 2px 0;',\r\n        '    border-radius: 2px;',\r\n        '    z-index: 1;',\r\n        '    opacity: 0;',\r\n        '    transition: opacity .6s;',\r\n        '}',\r\n\r\n        '.tooltip-top {',\r\n        '    bottom: 125%;',\r\n        '    left: 50%;',\r\n        '    margin-left: -60px;',\r\n        '}',\r\n        \r\n        '.tooltip:hover .tooltiptext {',\r\n        '    visibility: visible;',\r\n        '    opacity: 1;',\r\n        '}'\r\n    ]);\r\n\r\n    const styles = {\r\n        datDisabled: 'color: #606060 !important; cursor: not-allowed !important;'\r\n    };\r\n\r\n    Object.defineProperty((window.dat || require(\"./datGUIConsole\").default).GUI.prototype, 'onGUIEvent', {\r\n        get: function(){\r\n            if(!this._onGUIEvent)\r\n                this._onGUIEvent = [];\r\n            return this._onGUIEvent;\r\n        }\r\n    });\r\n\r\n    // update all\r\n\r\n    (window.dat || require(\"./datGUIConsole\").default).GUI.prototype.updateAll = function(){\r\n        var gui = this;\r\n        for (var i in gui.__controllers) {\r\n            var controller = gui.__controllers[i];\r\n            controller.updateDisplay();\r\n        }\r\n\r\n        var folders = Object.values(gui.__folders);\r\n        for(i = 0; i < folders.length; i++){\r\n            folders[i].updateAll();\r\n        }\r\n    };\r\n\r\n    // find\r\n\r\n    (window.dat || require(\"./datGUIConsole\").default).GUI.prototype.find = function(object, property){\r\n        var gui = this, controller, i;\r\n\r\n        if(property){ // 2 arguments\r\n            for (i = 0; i < gui.__controllers.length; i++){\r\n                controller = gui.__controllers[i];\r\n                if (controller.object == object && controller.property == property)\r\n                    return controller;\r\n            }\r\n\r\n            var folders = Object.values(gui.__folders);\r\n            for(i = 0; i < folders.length; i++){\r\n                controller = folders[i].find(object, property);\r\n                if(controller) return controller;\r\n            }\r\n        }\r\n        else{\r\n            property = object; // 1 argument\r\n\r\n            var folderKeys = Object.keys(gui.__folders);\r\n            for(i = 0; i < folderKeys.length; i++){\r\n                var folderName = folderKeys[i];\r\n                var folder = gui.__folders[folderName];\r\n                if(folderName === property)\r\n                    return folder;\r\n            }\r\n        }\r\n        return undefined;\r\n    };\r\n\r\n    // On open event\r\n    //if(_this.opening !== undefined) _this.opening = _this.closed; // chadiik\r\n    Object.defineProperty((window.dat || require(\"./datGUIConsole\").default).GUI.prototype, 'opening', {\r\n        get: function(){\r\n            return !this.closed;\r\n        },\r\n\r\n        set: function(value){\r\n            for(var i = 0; i < this.onGUIEvent.length; i++){\r\n                this.onGUIEvent[i](value ? 'open' : 'close');\r\n            }\r\n        }\r\n    });\r\n\r\n    // Disabled\r\n    function blockEvent(event){\r\n        event.stopPropagation();\r\n    }\r\n\r\n    Object.defineProperty((window.dat || require(\"./datGUIConsole\").default).controllers.Controller.prototype, \"disabled\", {\r\n        get: function(){\r\n            return this.domElement.hasAttribute(\"disabled\");\r\n        },\r\n\r\n        set: function(value){\r\n            if (value){\r\n                this.domElement.setAttribute(\"disabled\", \"disabled\");\r\n                this.domElement.addEventListener(\"click\", blockEvent, true);\r\n                Element.AddStyle(this.domElement.parentElement.parentElement, styles.datDisabled);\r\n            }\r\n            else{\r\n                this.domElement.removeAttribute(\"disabled\");\r\n                this.domElement.removeEventListener(\"click\", blockEvent, true);\r\n                Element.RemoveStyle(this.domElement.parentElement.parentElement, styles.datDisabled);\r\n            }\r\n        },\r\n\r\n        enumerable: true\r\n    });\r\n\r\n    (window.dat || require(\"./datGUIConsole\").default).GUI.prototype.enable = function(object, property, value){\r\n        var controller = this.find(object, property);\r\n        controller.disabled = !value;\r\n    };\r\n\r\n    // Tooltip\r\n\r\n    Object.defineProperty((window.dat || require(\"./datGUIConsole\").default).controllers.Controller.prototype, \"tooltip\", {\r\n        get: function(){\r\n            return this._tooltip.innerHTML;\r\n        },\r\n\r\n        set: function(value){\r\n            if (value){\r\n                if(this._tooltip === undefined) {\r\n                    this._tooltip = crel('span', {class: 'tooltiptext'});\r\n\r\n                    /**\r\n                     * @type {HTMLElement}\r\n                     */\r\n                    var container = this.domElement.parentElement.parentElement;\r\n                    container.classList.add('tooltip');\r\n                    container.appendChild(this._tooltip);\r\n                }\r\n                this._tooltip.innerHTML = value;\r\n            }\r\n        },\r\n\r\n        enumerable: true\r\n    });\r\n\r\n    (window.dat || require(\"./datGUIConsole\").default).GUI.prototype.setTooltip = function(object, property, value){\r\n        var controller = this.find(object, property);\r\n        controller.tooltip = value;\r\n    };\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/config/datGUIExtensions.js","\r\n/** @typedef Vec2 @property {Number} x @property {Number} y */\r\n/** @typedef Rectangle @property {Vec2} p1 @property {Vec2} p2 @property {Vec2} p3 @property {Vec2} p4 */\r\n\r\nconst epsilon = Math.pow(2, -52);\r\nconst smallValue = .000001;\r\nconst smallValueSqrt = .001;\r\n\r\n// line intercept math by Paul Bourke http://paulbourke.net/geometry/pointlineplane/\r\n// Determine the intersection point of two line segments\r\n// Return FALSE if the lines don't intersect\r\nfunction segmentIntersect(x1, y1, x2, y2, x3, y3, x4, y4) {\r\n\r\n    // Check if none of the lines are of length 0\r\n    if ((x1 === x2 && y1 === y2) || (x3 === x4 && y3 === y4)) {\r\n        return false;\r\n    }\r\n  \r\n    var denominator = ((y4 - y3) * (x2 - x1) - (x4 - x3) * (y2 - y1));\r\n  \r\n    // Lines are parallel\r\n    if (Math.abs(denominator) < epsilon) {\r\n        return false;\r\n    }\r\n  \r\n    var ua = ((x4 - x3) * (y1 - y3) - (y4 - y3) * (x1 - x3)) / denominator;\r\n    var ub = ((x2 - x1) * (y1 - y3) - (y2 - y1) * (x1 - x3)) / denominator;\r\n  \r\n    // is the intersection along the segments\r\n    if (ua > 0 || ua < 1 || ub > 0 || ub < 1) return false;\r\n  \r\n    // Return a object with the x and y coordinates of the intersection\r\n    var x = x1 + ua * (x2 - x1);\r\n    var y = y1 + ua * (y2 - y1);\r\n\r\n    return {x, y};\r\n}\r\n\r\nfunction linesIntersect(ax, ay, bx, by, cx, cy, dx, dy){\r\n    // Line AB represented as a1x + b1y = c1\r\n    var a1 = by - ay,\r\n        b1 = ax - bx;\r\n    var c1 = a1 * ax + b1 * ay;\r\n  \r\n    // Line CD represented as a2x + b2y = c2\r\n    var a2 = dy - cy,\r\n        b2 = cx - dx;\r\n    var c2 = a2 * cx + b2 * cy;\r\n  \r\n    var determinant = a1 * b2 - a2 * b1;\r\n  \r\n    // The lines are parallel\r\n    if (Math.abs(determinant) < smallValue) return false;\r\n\r\n    var x = (b2 * c1 - b1 * c2) / determinant;\r\n    var y = (a1 * c2 - a2 * c1) / determinant;\r\n    return {x: x, y: y};\r\n}\r\n\r\nfunction rectangleContainsPoint(offset, rx, ry, rw, rh, px, py){\r\n    var x = rx - offset, y = ry - offset, w = rw + offset * 2, h = rh + offset * 2;\r\n    return px > x && px < x + w\r\n        && py > y && py < y + h;\r\n}\r\n\r\n/** @param {Number} offset offsets the region by this before checking * @param {Region} subRegion */\r\nfunction rectangleContainsRectangle(offset, rx, ry, rw, rh, ox, oy, ow, oh){\r\n    var x = rx - offset, y = ry - offset, w = rw + offset * 2, h = rh + offset * 2;\r\n    return ox > x && ox + ow < x + w\r\n        && oy > y && oy + oh < y + h;\r\n}\r\n\r\n/**\r\n * @param {Array<Vec2>} points\r\n */\r\nfunction rectanglesFromPoints(points){\r\n    // Separate points in lists of 'y' coordinate, grouped by 'x' coordinate\r\n    const toInt = Math.round(1 / smallValue);\r\n    var xs = {};\r\n    points.forEach(point => {\r\n        let xCat = Math.floor(point.x * toInt);\r\n        if(xs[xCat] === undefined) xs[xCat] = {x: point.x, ys: []};\r\n        let ys = xs[xCat].ys;\r\n        let yCat = Math.floor(point.y * toInt);\r\n        let insert = true;\r\n        for(let iY = 0; iY < ys.length; iY++){\r\n            if(ys[iY].yCat === yCat) insert = false;\r\n        }\r\n        if(insert) ys.push({yCat: yCat, y: point.y});\r\n    });\r\n\r\n    //console.log('xs:', xs);\r\n\r\n    // Intersect lists\r\n    function sortYCat(a, b){\r\n        if(a.yCat < b.yCat) return -1;\r\n        if(a.yCat > b.yCat) return 1;\r\n        return 0;\r\n    }\r\n    var xsKeys = Object.keys(xs);\r\n    for(let iX = 0; iX < xsKeys.length; iX++){\r\n        let xCat = xs[xsKeys[iX]];\r\n        xCat.ys.sort(sortYCat);\r\n    }\r\n\r\n    /** @typedef IntersectedX @property {Number} x1 @property {Number} x2 @property {Array<Number>} ys */\r\n    /** @type {Array<IntersectedX>} */\r\n    var intersectedXs = [];\r\n    for(let iX = 0; iX < xsKeys.length; iX++){\r\n        let xCat1 = xs[xsKeys[iX]];\r\n        let ys1 = xCat1.ys;\r\n        for(let iX2 = iX + 1; iX2 < xsKeys.length; iX2++){\r\n            let xCat2 = xs[xsKeys[iX2]];\r\n            let ys2 = xCat2.ys;\r\n\r\n            let yIntersect = [];\r\n            let xIntersect = {x1: xCat1.x, x2: xCat2.x, ys: yIntersect};\r\n            for(let iY1 = 0; iY1 < ys1.length; iY1++){\r\n                for(let iY2 = 0; iY2 < ys2.length; iY2++){\r\n                    if(ys1[iY1].yCat === ys2[iY2].yCat){\r\n                        yIntersect.push(ys1[iY1].y);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n\r\n            if(yIntersect.length > 1) intersectedXs.push(xIntersect);\r\n        }\r\n    }\r\n\r\n    //console.log(intersectedXs);\r\n\r\n    /** @type {Array<Rectangle>} */\r\n    var rectangles = [];\r\n    for(let iIX = 0; iIX < intersectedXs.length; iIX++){\r\n        let intersectedX = intersectedXs[iIX];\r\n        let ys = intersectedX.ys;\r\n        let x1 = intersectedX.x1, x2 = intersectedX.x2;\r\n        for(let iY1 = 0; iY1 < ys.length; iY1++){\r\n            for(let iY2 = iY1 + 1; iY2 < ys.length; iY2++){\r\n                let p1 = {x: x1, y: ys[iY1]},\r\n                    p2 = {x: x2, y: ys[iY1]},\r\n                    p3 = {x: x2, y: ys[iY2]},\r\n                    p4 = {x: x1, y: ys[iY2]};\r\n                \r\n                let rectangle = {p1: p1, p2: p2, p3: p3, p4: p4};\r\n                rectangles.push(rectangle);\r\n            }\r\n        }\r\n    }\r\n\r\n    return rectangles;\r\n}\r\n\r\n/**\r\n * @param {Array<Rectangle>} rectangles \r\n * @returns {Array<Rectangle>} the array is edited in-place\r\n */\r\nfunction reduceRectangles(rectangles){\r\n    for(let iRect = 0; iRect < rectangles.length; iRect++){\r\n        let ra = rectangles[iRect];\r\n        let ax = ra.p1.x, ay = ra.p1.y;\r\n        let aw = ra.p3.x - ax, ah = ra.p3.y - ay;\r\n        for(let jRect = 0; jRect < rectangles.length; jRect++){\r\n            if(iRect !== jRect){\r\n                let rb = rectangles[jRect];\r\n                let bx = rb.p1.x, by = rb.p1.y;\r\n                let bw = rb.p3.x - bx, bh = rb.p3.y - by;\r\n                if(rectangleContainsRectangle(smallValue, ax, ay, aw, ah, bx, by, bw, bh)){\r\n                    rectangles.splice(jRect, 1);\r\n                    jRect--;\r\n                    iRect = Math.max(0, jRect - 1);\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return rectangles;\r\n}\r\n\r\n/** @param {Number} ax @param {Number} ay @param {Number} bx @param {Number} by @param {Number} x @param {Number} y */\r\nfunction segmentContainsPoint(ax, ay, bx, by, x, y){\r\n    var vx = bx - ax, vy = by - ay,\r\n        vxa = x - ax, vya = y - ay,\r\n        vxb = x - bx, vyb = y - by;\r\n    var d = Math.sqrt(vx * vx + vy * vy),\r\n        da = Math.sqrt(vxa * vxa + vya * vya),\r\n        db = Math.sqrt(vxb * vxb + vyb * vyb);\r\n    return Math.abs( d - (da + db) ) < smallValueSqrt;\r\n}\r\n\r\nexport {\r\n    linesIntersect,\r\n    rectangleContainsPoint,\r\n    rectangleContainsRectangle,\r\n    reduceRectangles,\r\n    rectanglesFromPoints\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/Math2D.js","import Debug from \"../../debug/Debug\";\r\nimport Region from \"./Region\";\r\n\r\nexport const debugging = false;\r\n\r\nif(debugging){\r\n    Debug.app.sceneSetup.input.ListenKeys(['right', 'space']);\r\n}\r\n\r\nexport function sleep(ms, force) {\r\n    return new Promise(resolve => {\r\n        if(debugging || force) setTimeout(resolve, ms);\r\n        else resolve();\r\n    });\r\n}\r\n\r\nexport function debugLog(...args){\r\n    console.log(...args);\r\n}\r\n\r\nexport function keypress(ms, force) {\r\n    return new Promise(resolve => {\r\n        if(debugging || force){\r\n            let tid = undefined;\r\n            function execute(){\r\n                if(tid !== undefined) clearTimeout(tid);\r\n                removeEventListener('keydown', execute);\r\n                resolve();\r\n            }\r\n            if(ms && ms > 0) tid = setTimeout(execute, ms);\r\n            addEventListener('keydown', execute);\r\n        }\r\n        else{\r\n            resolve();\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * @param {Region} region * @param {Number} color \r\n */\r\nexport function debugRegion(region, color, solid, duration, checkered){\r\n    var x = region.x, y = region.y, z = region.z, w = region.width, h = region.height, l = region.length;\r\n    var debugUID = Debug.Viz.DrawVolume(x + w/2, y + h/2, z + l/2, w, h, l, color || 0xaaffff, duration || -1, !Boolean(solid), checkered);\r\n    return debugUID;\r\n}\r\n\r\n/** @param {Array<string>} */\r\nexport function debugClear(uids){\r\n    if(uids){\r\n        uids.forEach(uid => {\r\n            Debug.Viz.RemoveObjectByUID(uid);\r\n        });\r\n    }\r\n    else{\r\n        Debug.Viz.ClearAll();\r\n    }\r\n}\r\n\r\nfunction numberFormatDefault(n){ return n; }\r\n\r\nexport function numberFormat(n, d){\r\n    if(n > Number.MAX_SAFE_INTEGER - 2) return 'MAX';\r\n    let nStr = Math.round(n) !== n ? n.toFixed(d) : n;\r\n    return nStr;\r\n}\r\n\r\n/** @typedef FormatParams @property {Function} nf number formatting function */\r\n/** @param {string} str @param {FormatParams} params @param {Array<*>} args */\r\nexport function format(str, params, ...args){\r\n    if(params.nf === undefined) params.nf = numberFormatDefault;\r\n    let index = 0;\r\n    while( (index = str.indexOf('@', index)) !== -1 ){\r\n        if(str[index - 1] !== '\\\\'){\r\n            let a = args.shift();\r\n            if(typeof a === 'number') a = params.nf(a);\r\n            str = str.replace('@', a);\r\n        }\r\n        index += 1;\r\n    }\r\n    return str;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/CUBDebug.js","import AFitTest from \"../packer/afit/AFitTest\";\r\nimport Asset from \"../components/assets/Asset\";\r\n\r\nfunction delay(time, callback){\r\n    setTimeout(callback, time);\r\n}\r\n\r\nconst debugGeometry = new THREE.BoxBufferGeometry(1, 1, 1, 1, 1, 1);\r\nvar debugMaterial = new THREE.MeshStandardMaterial({color: 0xff7f00, transparent: true, opacity: .35});\r\nAsset.SetTextureMap('checkers.jpg', debugMaterial, 'map').then( (map) => {\r\n    map.wrapS = map.wrapT = THREE.RepeatWrapping;\r\n});\r\nconst debugBox = new THREE.Mesh(debugGeometry, debugMaterial);\r\n\r\nvar tempVec = new THREE.Vector3();\r\n\r\nclass DebugBox {\r\n\r\n    /**\r\n     * @param {THREE.Vector3} center \r\n     * @param {Number|THREE.Vector3} size \r\n     */\r\n    static FromCenterSize(center, size){\r\n        var box = debugBox.clone();\r\n        box.position.copy(center);\r\n        \r\n        if(size instanceof THREE.Vector3)\r\n            box.scale.copy(size);\r\n        else\r\n            box.scale.set(size, size, size);\r\n\r\n        return box;\r\n    }\r\n\r\n    /**\r\n     * @param {THREE.Box3} box3 \r\n     */\r\n    static FromBox3(box3){\r\n        var box = debugBox.clone();\r\n\r\n        box3.getCenter(tempVec);\r\n        box.position.copy(tempVec);\r\n        box3.getSize(tempVec);\r\n        box.scale.copy(tempVec);\r\n\r\n        return box;\r\n    }\r\n}\r\n\r\n/**\r\n * DebugViz\r\n */\r\n\r\nconst alphaHexMask = 256 * 256 * 256;\r\n\r\n/** @type {THREE.Object3D} */\r\nvar view;\r\n\r\n/** @type {Map<string, *>} */\r\nvar debugObjects = new Map();\r\n\r\nvar tVec3 = new THREE.Vector3(),\r\n    tPos = new THREE.Vector3(),\r\n    tScale = new THREE.Vector3();\r\n\r\nclass DebugViz {\r\n\r\n    /**\r\n     * @param {THREE.Object3D} parent\r\n     */\r\n    static SetViewParent(parent){\r\n        view = new THREE.Object3D();\r\n        view.name = 'DebugViz view';\r\n        console.log(view.name + ' created...');\r\n        view.renderOrder = Number.MAX_SAFE_INTEGER - 10;\r\n        parent.add(view);\r\n    }\r\n\r\n    static get view(){ return view; }\r\n\r\n    /**\r\n     * @param {Number} x center x * @param {Number} y center y * @param {Number} z center z * @param {Number} w * @param {Number} h * @param {Number} l\r\n     * @param {Number} [color] hex color\r\n     * @param {Number} [duration] in milliseconds\r\n     * @param {Boolean} [checkered] checkers map\r\n     */\r\n    static DrawVolume(x, y, z, w, h, l, color, duration, wireframe, checkered){\r\n        tPos.set(x, y, z);\r\n        tScale.set(w, h, l);\r\n\r\n        /** @type {THREE.Mesh} */\r\n        var volume = debugBox.clone();\r\n        view.add(volume);\r\n\r\n        volume.position.copy(tPos);\r\n        volume.scale.copy(tScale);\r\n\r\n        if(color){\r\n            /** @type {THREE.MeshStandardMaterial} */\r\n            let material = volume.material.clone();\r\n            volume.material = material;\r\n            material.color.setHex(color && 0xffffff);\r\n            if(wireframe === true){\r\n                material.wireframe = true;\r\n            }\r\n            else{\r\n                material.opacity = Math.floor(color / alphaHexMask) / 256;\r\n                material.transparent = material.opacity > 0 && material.opacity < .99;\r\n            }\r\n\r\n            if(!checkered){\r\n                material.map = null;\r\n            }\r\n            else{\r\n                material.map.repeat.set(10, 10);\r\n            }\r\n        }\r\n\r\n        let uid = THREE.Math.generateUUID();\r\n        debugObjects.set(uid, volume);\r\n\r\n        if(duration > 0){\r\n            delay(duration, function(){\r\n                DebugViz.RemoveObjectByUID(uid);\r\n            });\r\n        }\r\n\r\n        return uid;\r\n    }\r\n\r\n    /**\r\n     * @param {string} uid \r\n     */\r\n    static RemoveObjectByUID(uid){\r\n        var object = debugObjects.get(uid);\r\n        if(object instanceof THREE.Object3D && object.parent){\r\n            object.parent.remove(object);\r\n        }\r\n    }\r\n\r\n    static ClearAll(){\r\n        for(var uid of debugObjects.keys()){\r\n            DebugViz.RemoveObjectByUID(uid);\r\n        }\r\n    }\r\n\r\n    /** @param {Boolean} visible */\r\n    static SetPackingSpaceVisibility(visible){\r\n        Debug.app.view.packingSpaceView.view.visible = visible;\r\n    }\r\n}\r\n\r\n/**\r\n * DebugViz\r\n */\r\n\r\nclass Debug {\r\n\r\n    static MaterialEdit(callback){\r\n        let objects = Debug.app.view.packResultView.cargoViews;\r\n        objects.forEach(o => {\r\n            let material = o.mesh.material;\r\n            callback(material);\r\n            material.needsUpdate = true;\r\n        });\r\n    }\r\n\r\n    static get AFitTest(){\r\n        return AFitTest;\r\n    }\r\n}\r\n\r\nDebug.Box = DebugBox;\r\nDebug.Viz = DebugViz;\r\n\r\n/** @type {import('../../FreightPacker').default} */\r\nDebug.api;\r\n/** @type {import('../App').default} */\r\nDebug.app;\r\n\r\nexport default Debug;\n\n\n// WEBPACK FOOTER //\n// ./src/api/debug/Debug.js","import Container from \"../packer/container/Container\";\r\nimport ContainerView from \"./ContainerView\";\r\nimport Logger from \"../utils/cik/Logger\";\r\nimport ContainingVolume from \"../packer/container/ContainingVolume\";\r\n\r\nconst typeofString = 'string';\r\n\r\nvar yRotation = new THREE.Matrix4().makeRotationY(-Math.PI / 2);\r\nvar tempMatrix4 = new THREE.Matrix4();\r\n\r\nclass PackingSpaceView{\r\n    constructor(){\r\n        this.view = new THREE.Object3D();\r\n\r\n        /**\r\n         * @type {Array<ContainerView>}\r\n         */\r\n        this.containerViews = [];\r\n    }\r\n\r\n    /** \r\n     * @param {Container} container\r\n     */\r\n    Add(container){\r\n        let containerView = ContainerView.Request(container);\r\n        this.view.add(containerView.view);\r\n        this.containerViews.push(containerView);\r\n    }\r\n\r\n    Clear(){\r\n        for(let i = 0; i < this.containerViews.length; i++){\r\n            let cv = this.containerViews[i];\r\n            this.view.remove(cv.view);\r\n        }\r\n        this.containerViews.length = 0;\r\n    }\r\n\r\n    /**\r\n     * @param {string} containingVolumeUID \r\n     */\r\n    FindContainingVolume(containingVolumeUID){\r\n        for(let iCView = 0; iCView < this.containerViews.length; iCView++){\r\n            let volumes = this.containerViews[iCView].container.volumes;\r\n            for(let iCVolume = 0; iCVolume < volumes.length; iCVolume++){\r\n                if(volumes[iCVolume].uid === containingVolumeUID){\r\n                    return volumes[iCVolume];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {ContainingVolume} containingVolume \r\n     */\r\n    GetMatrix(containingVolume){\r\n        if(typeof containingVolume === typeofString) containingVolume = this.FindContainingVolume(containingVolume);\r\n        tempMatrix4.identity();\r\n        tempMatrix4.makeTranslation(containingVolume.position.x - containingVolume.dimensions.width / 2, containingVolume.position.y, containingVolume.position.z - containingVolume.dimensions.length / 2);\r\n        //tempMatrix4.premultiply(yRotation);\r\n        return tempMatrix4;\r\n    }\r\n}\r\n\r\nexport default PackingSpaceView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/PackingSpaceView.js","import Container from \"../packer/container/Container\";\r\nimport Asset from \"../components/assets/Asset\";\r\nimport Logger from \"../utils/cik/Logger\";\r\nimport ContainingVolume from \"../packer/container/ContainingVolume\";\r\n\r\nclass ContainerBox{\r\n    /** @param {THREE.Mesh} mesh */\r\n    constructor(mesh){\r\n        this.mesh = mesh;\r\n    }\r\n}\r\n\r\n/**\r\n * \r\n * @param {Container} container \r\n */\r\nfunction createContainerBoxes(container){\r\n    /**\r\n     * @type {Map<ContainingVolume, ContainerBox>}\r\n     */\r\n    var boxes = new Map();\r\n\r\n    container.volumes.forEach(cv => {\r\n        let mesh = Asset.CreateMesh();\r\n            \r\n        let extent = cv.dimensions.vec3;\r\n        mesh.scale.copy(extent);\r\n        mesh.position.y += extent.y / 2;\r\n\r\n        mesh.material = mesh.material.clone();\r\n        mesh.material.color.setHex(0xffaaaa);\r\n        mesh.material.transparent = true;\r\n        mesh.material.opacity = .2;\r\n        mesh.material.side = THREE.BackSide;\r\n        mesh.material.polygonOffset = true;\r\n        mesh.material.polygonOffsetFactor = 1;\r\n        mesh.material.polygonOffsetUnits = 1;\r\n\r\n        boxes.set(cv, new ContainerBox(mesh));\r\n    });\r\n\r\n    return boxes;\r\n}\r\n\r\nvar tempVec3 = new THREE.Vector3();\r\n\r\n/** @type {WeakMap<Container, ContainerView>} */\r\nvar views = new WeakMap();\r\n\r\nclass ContainerView {\r\n    /**\r\n     * \r\n     * @param {Container} container \r\n     * @param {THREE.Object3D} view\r\n     */\r\n    constructor(container, view){\r\n\r\n        // Store original dimensions\r\n        this.initializationBox3 = new THREE.Box3();\r\n        this.initializationBox3.setFromObject(view);\r\n\r\n        views.set(container, this);\r\n\r\n        this.container = container;\r\n        this.view = new THREE.Object3D();\r\n        this.view.add(view);\r\n\r\n        Asset.StandardSceneObject(this.view);\r\n        Asset.ColorTemplates('Containers').Apply(this.view);\r\n\r\n        this.containerBoxes = createContainerBoxes(container);\r\n        for(var [cv, box] of this.containerBoxes){\r\n            box.mesh.position.add(cv.position);\r\n            this.view.add(box.mesh);\r\n        }\r\n\r\n    }\r\n\r\n    //** @param {Input} input @param {Camera} cameraController */\r\n    /*InitSliderBoxes(input, cameraController, changeCallback, stopCallback){\r\n        for(var box of this.containerBoxes.values()){\r\n            box.UseInput(input, cameraController);\r\n            box.On(sliderSignals.change, changeCallback);\r\n            box.On(sliderSignals.stop, stopCallback);\r\n        }\r\n    }*/\r\n\r\n    /**\r\n     * @param {Boolean} visible\r\n     * @param {THREE.Vector3} [padding]\r\n     */\r\n    PlatformVisibility(visible, padding){\r\n\r\n        if(visible && this.platformMesh === undefined){\r\n\r\n            if(padding === undefined) padding = new THREE.Vector3(0, .01, 0);\r\n        \r\n            this.initializationBox3.getSize(tempVec3);\r\n\r\n            let planeGeom = new THREE.BoxGeometry(tempVec3.x + padding.x * 2, padding.y, tempVec3.z + padding.z * 2, 1, 1, 1);\r\n            let planeMaterial = new Asset.CreateSolidMaterialMatte(Asset.ColorTemplates('Containers').Apply(0xffffff));\r\n            this.platformMesh = new THREE.Mesh(planeGeom, planeMaterial);\r\n            Asset.ReceiveShadow(this.platformMesh);\r\n\r\n            this.platformMesh.position.y = .001;\r\n            this.view.add(this.platformMesh);\r\n        }\r\n\r\n        this.platformMesh.visible = visible;\r\n    }\r\n\r\n    /**\r\n     * @param {Container} container\r\n     * @returns {ContainerView}\r\n     */\r\n    static Request(container){\r\n        var view = views.get(container);\r\n        if( !view ){\r\n            let boxes = createContainerBoxes(container);\r\n            let object3d = new THREE.Object3D();\r\n            for(var [cv, box] of boxes){\r\n                box.mesh.position.add(cv.position);\r\n                object3d.add(box.mesh);\r\n            }\r\n\r\n            view = new ContainerView(container, object3d);\r\n            views.set(container, view);\r\n            Logger.Warn('View not found for:', container);\r\n        }\r\n        return view;\r\n    }\r\n}\r\n\r\nexport default ContainerView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/ContainerView.js","import Utils from '../utils/cik/Utils';\r\nimport CargoListView from './CargoListView';\r\nimport CargoView from './CargoView';\r\nimport Pool from '../utils/cik/Pool';\r\nimport PackedCargoBoxView from './PackedCargoBoxView';\r\nimport PackingSpaceView from './PackingSpaceView';\r\nimport Tween from '../utils/cik/Tween';\r\nimport Packer from '../packer/Packer';\r\nimport BoxEntry from '../components/box/BoxEntry';\r\nimport Signaler from '../utils/cik/Signaler';\r\n\r\nfunction sleep(ms) {\r\n    return new Promise(resolve => setTimeout(resolve, ms));\r\n}\r\n\r\n/**\r\n * @typedef {Object} PackResultViewParams\r\n * @property {import('../UX').default} ux\r\n * @property {Number} animationDuration\r\n */\r\n\r\n /** @type {PackResultViewParams} */\r\nconst defaultParams = {\r\n    animationDuration: 1\r\n};\r\n\r\n/**\r\n * @param {CargoView} cargoView\r\n * @returns {PackedCargoBoxView}\r\n */\r\nfunction poolNewFN(cargoView){\r\n    //console.log('pool new', cargoView);\r\n    let packedCargoView = new PackedCargoBoxView(cargoView.entry);\r\n    packedCargoView.Extend(cargoView);\r\n    return packedCargoView;\r\n}\r\n\r\n/**\r\n * @param {PackedCargoBoxView} object \r\n * @param {CargoView} cargoView\r\n * @returns {PackedCargoBoxView}\r\n */\r\nfunction poolResetFN(object, cargoView){\r\n    //console.log('pool reset', cargoView);\r\n    object.Extend(cargoView);\r\n    return object;\r\n}\r\n\r\nfunction getOrientationAngles(orientation){\r\n    switch(orientation){\r\n        case 'xyz': return  [0,     0,      0];\r\n        case 'xzy': return  [90,    0,      0];\r\n        case 'yxz': return  [0,     0,      90];\r\n        case 'yzx': return  [90,    0,      90];\r\n        case 'zxy': return  [90,    -90,    0];\r\n        case 'zyx': return  [0,     -90,    0];\r\n    }\r\n}\r\n\r\n/**\r\n * @param {string} orientation \r\n */\r\nfunction getOrientationEuler(orientation){\r\n    const rad = Math.PI / 180.0;\r\n    let a = getOrientationAngles(orientation);\r\n    return new THREE.Euler(a[0] * rad, a[1] * rad, a[2] * rad);\r\n}\r\n\r\nvar tempBox = new THREE.Box3();\r\nvar tempVec = new THREE.Vector3();\r\n\r\nconst signals = {\r\n    packVizStart: 'packVizStart',\r\n    packVizEnd: 'packVizEnd',\r\n    cargoVizCreate: 'cargoVizCreate',\r\n    cargoVizPack: 'cargoVizPack',\r\n    cargoVizUnpack: 'cargoVizUnpack'\r\n};\r\n\r\nclass PackResultView extends Signaler{\r\n    /**\r\n     * @param {CargoListView} cargoListView\r\n     * @param {PackingSpaceView} packingSpaceView\r\n     * @param {PackResultViewParams} params \r\n     */\r\n    constructor(cargoListView, packingSpaceView, params){\r\n\r\n        super();\r\n\r\n        this.cargoListView = cargoListView;\r\n        this.packingSpaceView = packingSpaceView;\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        /** @type {Array<CargoView} */\r\n        this.cargoViews = [];\r\n        this.view = new THREE.Object3D();\r\n\r\n        this.pool = new Pool(poolNewFN, poolResetFN);\r\n\r\n        /** @type {Array<Tween>} */\r\n        this.animatingViews = [];\r\n\r\n        if(typeof window.Pizzicato !== 'undefined'){\r\n            let musipack = new (require('./components/Musipack').default)(this);\r\n        }\r\n    }\r\n\r\n    /** \r\n     * @param {Packer.PackingResult} packingResult\r\n     */\r\n    async DisplayPackingResult(packingResult){\r\n\r\n        this.Dispatch(signals.packVizStart, packingResult);\r\n\r\n        let scope = this;\r\n        let units = this.params.ux.params.units;\r\n        \r\n        let containingVolume = packingResult.packed[0].containingVolume;\r\n        let matrix = this.packingSpaceView.GetMatrix(containingVolume);\r\n        let offset = new THREE.Vector3();\r\n        let orientation = new THREE.Quaternion();\r\n        let scale = new THREE.Vector3();\r\n        matrix.decompose(offset, orientation, scale);\r\n\r\n        /** @type {Map<CargoView, Number>} */\r\n        let packedQuantities = new Map();\r\n\r\n        let animatingViews = this.animatingViews;\r\n        let view = this.view;\r\n        //let onTweenComplete = this.OnCargoFirstTweenComplete.bind(this);\r\n        let zEntry = containingVolume.dimensions.length;\r\n        let numPackedItems = packingResult.packed.length;\r\n        let delayPerItem = this.params.animationDuration * 1000 / numPackedItems;\r\n        for(let i = 0; i < numPackedItems; i++){\r\n            let item = packingResult.packed[i];\r\n            let cargoViewTemplate = this.cargoListView.GetTemplate(item.entry);\r\n\r\n            let packedQuantity = packedQuantities.get(cargoViewTemplate);\r\n            let totalQuantity = cargoViewTemplate.entry.quantity;\r\n            if(packedQuantity === undefined) packedQuantities.set(cargoViewTemplate, packedQuantity = 0);\r\n            packedQuantities.set(cargoViewTemplate, ++packedQuantity);\r\n            let textColor = packedQuantity === totalQuantity ? 'rgb(255, 255, 255)' : 'rgb(255, 0, 0)';\r\n            this.cargoListView.UpdateLabel(cargoViewTemplate, packedQuantity + '/' + totalQuantity, textColor);\r\n\r\n            let packedCargoView = this.pool.Request(cargoViewTemplate);\r\n\r\n            this.cargoViews.push(packedCargoView);\r\n\r\n            let rotation = getOrientationEuler(item.orientation);\r\n            packedCargoView.SetRotationAngles(rotation.x, rotation.y, rotation.z);\r\n\r\n            let x = item.position.x + offset.x,\r\n                y = item.position.y + offset.y,\r\n                z = item.position.z + offset.z;\r\n\r\n            let posTweenCombo = Tween.Combo.RequestN(Tween.functions.ease.easeOutQuad, .5,\r\n                x, 0,\r\n                y, 0,\r\n                zEntry, z - zEntry\r\n            );\r\n\r\n            function onTweenComplete(tween){\r\n                scope.Dispatch(signals.cargoVizPack, item);\r\n                scope.OnCargoFirstTweenComplete(tween);\r\n            }\r\n            \r\n            posTweenCombo.extraData = packedCargoView;\r\n            posTweenCombo.Hook(packedCargoView.position, 'x', 'y', 'z');\r\n            posTweenCombo.onComplete = onTweenComplete;\r\n            posTweenCombo.Update(0);\r\n            animatingViews.push(posTweenCombo);\r\n    \r\n            view.add(packedCargoView.view);\r\n            await sleep(delayPerItem);\r\n        }\r\n\r\n        await sleep(500);\r\n\r\n        let unpackedOffset = 6 * units;\r\n        for(let i = 0, numUnpackedItems = packingResult.unpacked.length; i < numUnpackedItems; i++){\r\n            let item = packingResult.unpacked[i];\r\n            let cargoViewTemplate = this.cargoListView.GetTemplate(item.entry);\r\n\r\n            let totalQuantity = cargoViewTemplate.entry.quantity;\r\n            if(packedQuantities.has(cargoViewTemplate) === false){\r\n                let textColor = false ? 'rgb(255, 255, 255)' : 'rgb(255, 0, 0)';\r\n                this.cargoListView.UpdateLabel(cargoViewTemplate, '0/' + totalQuantity, textColor);\r\n            }\r\n\r\n            if(i === 0) unpackedOffset += item.entry.dimensions.width / 2;\r\n\r\n            for(let j = 0; j < item.unpackedQuantity; j++){\r\n                let packedCargoView = this.pool.Request(cargoViewTemplate);\r\n\r\n                this.cargoViews.push(packedCargoView);\r\n                \r\n                let x = containingVolume.dimensions.width * 1.5 + unpackedOffset + offset.x,\r\n                    y = item.entry.dimensions.height / 2 + offset.y,\r\n                    z = item.entry.dimensions.length * j + offset.z;\r\n\r\n                let posTweenCombo = Tween.Combo.RequestN(Tween.functions.ease.easeOutQuad, .5,\r\n                    x, 0,\r\n                    y, 0,\r\n                    zEntry, z - zEntry\r\n                );\r\n\r\n                function onTweenComplete(tween){\r\n                    scope.Dispatch(signals.cargoVizUnpack, item);\r\n                    scope.OnCargoFirstTweenComplete(tween);\r\n                }\r\n                \r\n                posTweenCombo.extraData = packedCargoView;\r\n                posTweenCombo.Hook(packedCargoView.position, 'x', 'y', 'z');\r\n                posTweenCombo.onComplete = onTweenComplete;\r\n                posTweenCombo.Update(0);\r\n                animatingViews.push(posTweenCombo);\r\n        \r\n                view.add(packedCargoView.view);\r\n                await sleep(delayPerItem * .5);\r\n            }\r\n\r\n            unpackedOffset += item.entry.dimensions.width + 6 * units;\r\n        }\r\n    }\r\n\r\n    /** @param {Tween|Tween.Combo} tween */\r\n    OnCargoFirstTweenComplete(tween){\r\n        let packedCargoView = tween.extraData;\r\n        this.OnTweenComplete(tween);\r\n        let scaleTweenCombo = Tween.Combo.RequestN(Tween.functions.special.pingPong, .1, \r\n            1, .1,\r\n            1, .1,\r\n            1, .1\r\n        );\r\n        \r\n        scaleTweenCombo.extraData = packedCargoView;\r\n        scaleTweenCombo.Hook(packedCargoView.view.scale, 'x', 'y', 'z');\r\n        scaleTweenCombo.onComplete = this.OnTweenComplete.bind(this);;\r\n        scaleTweenCombo.Update(0);\r\n        this.animatingViews.push(scaleTweenCombo);\r\n    }\r\n\r\n    /** @param {Tween|Tween.Combo} tween */\r\n    OnTweenComplete(tween){\r\n        let packedCargoView = tween.extraData;\r\n        packedCargoView.view.scale.set(1, 1, 1);\r\n        let index = this.animatingViews.indexOf(tween);\r\n        if(index != -1){\r\n            this.animatingViews.splice(index, 1);\r\n        }\r\n        tween.Unhook();\r\n        tween.Return();\r\n    }\r\n\r\n    /** @param {string} entryUID */\r\n    SelectEntry(entryUID){\r\n        if(!entryUID){\r\n            this.DisableHighlights();\r\n        }\r\n        else{\r\n            this.Highlight(entryUID);\r\n        }\r\n    }\r\n\r\n    DisableHighlights(){\r\n        for(let i = 0, numCargoViews = this.cargoViews.length; i < numCargoViews; i++){\r\n            this.cargoViews[i].focus = 1;\r\n        }\r\n    }\r\n\r\n    /** @param {string} entryUID */\r\n    Highlight(entryUID){\r\n        for(let i = 0, numCargoViews = this.cargoViews.length; i < numCargoViews; i++){\r\n            let cargoView = this.cargoViews[i];\r\n\r\n            let cvEntry = cargoView.entry;\r\n            if(cvEntry.uid === entryUID){\r\n                cargoView.focus = 1.75;\r\n            }\r\n            else{\r\n                cargoView.focus = .25;\r\n            }\r\n        }\r\n    }\r\n\r\n    /** @param {Number} value */\r\n    Slice(value){\r\n        if(value >= 1){\r\n            this.view.children.forEach(child => {\r\n                child.visible = true;\r\n            });\r\n            return;\r\n        }\r\n\r\n        let minY = Number.MAX_SAFE_INTEGER, maxY = Number.MIN_SAFE_INTEGER;\r\n        this.view.children.forEach(child => {\r\n            tempBox.setFromObject(child);\r\n            tempBox.getSize(tempVec);\r\n            let halfHeight = tempVec.y / 2;\r\n            tempBox.getCenter(tempVec);\r\n            let low = tempVec.y - halfHeight;\r\n            let high = tempVec.y + halfHeight;\r\n            if(low < minY) minY = low;\r\n            if(high > maxY) maxY = high;\r\n        });\r\n\r\n        let y = minY + value * (maxY - minY);\r\n\r\n        //console.log('slice ' + y.toFixed(2) + ' between ' + minY.toFixed(2) + ' and ' + maxY.toFixed(2));\r\n\r\n        this.view.children.forEach(child => {\r\n            tempBox.setFromObject(child);\r\n            tempBox.getSize(tempVec);\r\n            let halfHeight = tempVec.y / 2;\r\n            tempBox.getCenter(tempVec);\r\n            let low = tempVec.y - halfHeight;\r\n\r\n            if(low < y) child.visible = true;\r\n            else child.visible = false;\r\n        });\r\n    }\r\n\r\n    Clear(){\r\n        this.animatingViews.length = 0;\r\n        this.cargoViews.length = 0;\r\n        while(this.view.children.length > 0) this.view.remove(this.view.children[this.view.children.length - 1]);\r\n    }\r\n\r\n    Update(){\r\n        this.animatingViews.forEach(animatingView => {\r\n            animatingView.Update();\r\n        });\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nexport default PackResultView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/PackResultView.js","import { Element, styles } from \"../../utils/cik/config/UIUtils\";\r\nimport Signaler from \"../../utils/cik/Signaler\";\r\nimport Asset from \"../../components/assets/Asset\";\r\nimport Utils from \"../../utils/cik/Utils\";\r\n\r\n//#region crel.js\r\n//Copyright (C) 2012 Kory Nunn\r\n\r\n//Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\r\n\r\n//The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\r\n\r\n//THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n\r\n/*\r\n\r\n    This code is not formatted for readability, but rather run-speed and to assist compilers.\r\n\r\n    However, the code's intention should be transparent.\r\n\r\n\r\n*/\r\n\r\nvar fn = 'function',\r\n    obj = 'object',\r\n    nodeType = 'nodeType',\r\n    textContent = 'textContent',\r\n    setAttribute = 'setAttribute',\r\n    attrMapString = 'attrMap',\r\n    isNodeString = 'isNode',\r\n    isElementString = 'isElement',\r\n    d = typeof document === obj ? document : {},\r\n    isType = function(a, type){\r\n        return typeof a === type;\r\n    },\r\n    isNode = typeof Node === fn ? function (object) {\r\n        return object instanceof Node;\r\n    } :\r\n    // in IE <= 8 Node is an object, obviously..\r\n    function(object){\r\n        return object &&\r\n            isType(object, obj) &&\r\n            (nodeType in object) &&\r\n            isType(object.ownerDocument,obj);\r\n    },\r\n    isElement = function (object) {\r\n        return crel[isNodeString](object) && object[nodeType] === 1;\r\n    },\r\n    isArray = function(a){\r\n        return a instanceof Array;\r\n    },\r\n    appendChild = function(element, child) {\r\n        if (isArray(child)) {\r\n            child.map(function(subChild){\r\n                appendChild(element, subChild);\r\n            });\r\n            return;\r\n        }\r\n        if(!crel[isNodeString](child)){\r\n            child = d.createTextNode(child);\r\n        }\r\n        element.appendChild(child);\r\n    };\r\nfunction crel(){\r\n    var args = arguments, //Note: assigned to a variable to assist compilers. Saves about 40 bytes in closure compiler. Has negligable effect on performance.\r\n        element = args[0],\r\n        child,\r\n        settings = args[1],\r\n        childIndex = 2,\r\n        argumentsLength = args.length,\r\n        attributeMap = crel[attrMapString];\r\n    element = crel[isElementString](element) ? element : d.createElement(element);\r\n    // shortcut\r\n    if(argumentsLength === 1){\r\n        return element;\r\n    }\r\n    if(!isType(settings,obj) || crel[isNodeString](settings) || isArray(settings)) {\r\n        --childIndex;\r\n        settings = null;\r\n    }\r\n    // shortcut if there is only one child that is a string\r\n    if((argumentsLength - childIndex) === 1 && isType(args[childIndex], 'string') && element[textContent] !== undefined){\r\n        element[textContent] = args[childIndex];\r\n    }else{\r\n        for(; childIndex < argumentsLength; ++childIndex){\r\n            child = args[childIndex];\r\n            if(child == null){\r\n                continue;\r\n            }\r\n            if (isArray(child)) {\r\n              for (var i=0; i < child.length; ++i) {\r\n                appendChild(element, child[i]);\r\n              }\r\n            } else {\r\n              appendChild(element, child);\r\n            }\r\n        }\r\n    }\r\n    for(var key in settings){\r\n        if(!attributeMap[key]){\r\n            if(isType(settings[key],fn)){\r\n                element[key] = settings[key];\r\n            }else{\r\n                element[setAttribute](key, settings[key]);\r\n            }\r\n        }else{\r\n            var attr = attributeMap[key];\r\n            if(typeof attr === fn){\r\n                attr(element, settings[key]);\r\n            }else{\r\n                element[setAttribute](attr, settings[key]);\r\n            }\r\n        }\r\n    }\r\n    return element;\r\n}\r\n// Used for mapping one kind of attribute to the supported version of that in bad browsers.\r\ncrel[attrMapString] = {};\r\ncrel[isElementString] = isElement;\r\ncrel[isNodeString] = isNode;\r\nif(typeof Proxy !== 'undefined'){\r\n    crel.proxy = new Proxy(crel, {\r\n        get: function(target, key){\r\n            !(key in crel) && (crel[key] = crel.bind(null, key));\r\n            return crel[key];\r\n        }\r\n    });\r\n}\r\n//#endregion\r\n\r\nfunction numberFormatDefault(n){ return n; }\r\n\r\nfunction numberFormat(n, d){\r\n    if(n > Number.MAX_SAFE_INTEGER - 2) return 'MAX';\r\n    let nStr = Math.round(n) !== n ? n.toFixed(d) : n;\r\n    return nStr;\r\n}\r\n\r\n/** @typedef FormatParams @property {Function} nf number formatting function */\r\n/** @type {FormatParams} */\r\nconst defaultFormatParams = {\r\n    nf: numberFormatDefault\r\n};\r\n\r\n/** @param {string} str string with (at) symbol an argument placeholder @param {FormatParams} params @param {Array<*>} args */\r\nfunction format(str, params, ...args){\r\n    params = Utils.AssignUndefined(params, defaultFormatParams);\r\n    let index = 0;\r\n    while( (index = str.indexOf('@', index)) !== -1 ){\r\n        if(str[index - 1] !== '\\\\'){\r\n            let a = args.shift();\r\n            if(typeof a === 'number') a = params.nf(a);\r\n            str = str.replace('@', a);\r\n        }\r\n        index += 1;\r\n    }\r\n    return str;\r\n}\r\n\r\nElement.CreateCSS([\r\n]);\r\n\r\nconst signals = {\r\n    orthoViewSelected: 'orthoViewSelected'\r\n};\r\n\r\nconst orthoviews = {\r\n    home: 'home',\r\n    top: 'top',\r\n    front: 'front',\r\n    side: 'side'\r\n};\r\n\r\nclass DomUI extends Signaler{\r\n    /**\r\n     * \r\n     * @param {HTMLDivElement} containerDiv \r\n     * @param {UX} ux \r\n     */\r\n    constructor(containerDiv, ux){\r\n        super();\r\n        \r\n        /** @type {HTMLDivElement} */\r\n        //this.domElement = crel('div', {style: 'display: inline-block; position: absolute; left: 0px; top: 0px; width: 100%; height: 100%;'});\r\n        //containerDiv.appendChild(this.domElement);\r\n        this.domElement = containerDiv;\r\n        this.ux = ux;\r\n\r\n        /** @type {HTMLDivElement} */\r\n        //this.sideBar = crel('div', {style: 'float: right; right: 0px; width: 50%; height: 100%;'});\r\n        //this.domElement.appendChild(this.sideBar);\r\n    }\r\n\r\n    CreateOrthoViewsIcons(){\r\n        let scope = this;\r\n        let texturesPath = Asset.resources.texturesPath;\r\n\r\n        let icons = [\r\n            {url: 'orthoviews-map.png', type: orthoviews.home},\r\n            {url: 'orthoviews-map.png', type: orthoviews.top},\r\n            {url: 'orthoviews-map.png', type: orthoviews.front},\r\n            {url: 'orthoviews-map.png', type: orthoviews.side}\r\n        ];\r\n\r\n        /** @type {HTMLDivElement} */\r\n        //this.orthoViewsIcons = crel('div', {style: 'display: inline-block; float: right; right: 0px; width: 100%; height: 100%;'});\r\n        //this.sideBar.appendChild(this.orthoViewsIcons);\r\n\r\n        const dimensions = {x: 52, y: 52};\r\n        const margin = {x: 16, y: 16};\r\n        const padding = 8;\r\n\r\n        function dispatch(icon){\r\n            scope.Dispatch(signals.orthoViewSelected, icon.type);\r\n        }\r\n\r\n        for(let i = 0; i < icons.length; i++){\r\n            let icon = icons[i];\r\n\r\n            let top = i * (dimensions.y + padding) + margin.y;\r\n            let right = margin.x;\r\n            let imageURL = texturesPath + icon.url;\r\n            let style = format(\r\n                'cursor: pointer; display: block; float: right; position: absolute; background-size: 200%; background-position: 0% @%; background-image: url(\"@\"); width: @px; height: @px; right: @px; top: @px;', {\r\n                    nf: function(n){\r\n                        return Math.floor(n);\r\n                    }\r\n                }, \r\n                i / (icons.length - 1) * 100, imageURL, dimensions.x, dimensions.y, right, top);\r\n            \r\n            /** @type {HTMLDivElement} */\r\n            let div = crel('div', {style: style});\r\n            this.domElement.appendChild(div);\r\n\r\n            div.onmouseover = function(){\r\n                div.style.backgroundPositionX = '100%';\r\n            }\r\n\r\n            div.onmouseout = function(){\r\n                div.style.backgroundPositionX = '0%';\r\n            }\r\n\r\n            div.onclick = function(e){\r\n                e.preventDefault();\r\n                dispatch(icon);\r\n            };\r\n        }\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n\r\n    static get orthoviews(){\r\n        return orthoviews;\r\n    }\r\n}\r\n\r\nexport default DomUI;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/dom/DomUI.js","import Logger from '../utils/cik/Logger';\r\nimport BoxEntry from './box/BoxEntry';\r\nimport Dimensions from './box/Dimensions';\r\nimport LightDispatcher from './LightDispatcher';\r\nimport App from '../App';\r\nimport CargoList from '../packer/CargoList';\r\nimport CargoBoxView from '../view/CargoBoxView';\r\nimport Pool from '../utils/cik/Pool';\r\n\r\nconst epsilon = Math.pow(2, -52);\r\nconst numberType = 'number';\r\n\r\nconst _cargoList = Symbol('cargoList');\r\n\r\nfunction poolNewFN(){\r\n    return new BoxEntry();\r\n}\r\n/** @param {BoxEntry} boxEntry */\r\nfunction poolResetFN(boxEntry){\r\n    return boxEntry;\r\n}\r\nvar boxEntryPool = new Pool(poolNewFN, poolResetFN);\r\n\r\nconst signals = {\r\n    show: 'show',\r\n    hide: 'hide',\r\n    insert: 'insert',\r\n    modify: 'modify',\r\n    remove: 'remove'\r\n};\r\n\r\n/** Renews entry: modify uid and color\r\n * @param {BoxEntry} boxEntry */\r\nfunction renewBoxEntry(boxEntry){\r\n    boxEntry.SetUID();\r\n    boxEntry.Description('color', CargoBoxView.GetNextColor().getHex());\r\n}\r\n\r\n/**\r\n * @typedef {Object} CargoInputParams\r\n * @property {import('../UX').default} ux\r\n */\r\n\r\n/**\r\n * Cubic volumes entry\r\n */\r\nclass CargoInput extends LightDispatcher {\r\n\r\n    /**\r\n     * @param {CargoInputParams} params \r\n     */\r\n    constructor(params){\r\n        super();\r\n\r\n        this.params = params;\r\n    }\r\n\r\n    /** @ignore ignore */\r\n    _Bind(value){\r\n        /** @type {App} */\r\n        let app = value;\r\n\r\n        this[_cargoList] = app.packer.cargoList;\r\n    }\r\n\r\n    /** Creates a new BoxEntry, required for inputs. (Can be reused) */\r\n    CreateBoxEntry(){\r\n        let boxEntry = new BoxEntry();\r\n        renewBoxEntry(boxEntry);\r\n        return boxEntry;\r\n    }\r\n\r\n    /** @param {string} entryUID @returns {BoxEntry} a copy of the entry if it exists */\r\n    GetEntry(entryUID){\r\n        /** @type {CargoList} */\r\n        let cargoList = this[_cargoList];\r\n        let entry = cargoList.GetEntry(entryUID);\r\n        let entryMirror = boxEntryPool.Request();\r\n        entryMirror.Copy(entry);\r\n        return entry;\r\n    }\r\n\r\n    /** @returns {Array<BoxEntry>} an array of copies of all entries */\r\n    GetEntries(){\r\n        /** @type {CargoList} */\r\n        let cargoList = this[_cargoList];\r\n        let entries = [];\r\n        cargoList.groups.forEach(value => {\r\n            let entryMirror = boxEntryPool.Request();\r\n            entryMirror.Copy(value.entry);\r\n            entries.push(entryMirror);\r\n        });\r\n\r\n        return entries;\r\n    }\r\n\r\n    /**\r\n     * Return BoxEntry objects to object pool (less memory usage)\r\n     * @param {BoxEntry | Array<BoxEntry>} objects \r\n     */\r\n    Recycle(objects){\r\n        if(objects instanceof Array){\r\n            objects.forEach( (object) => {\r\n                if(object instanceof BoxEntry) boxEntryPool.Return(object);\r\n            });\r\n        }\r\n        else if(objects instanceof BoxEntry){\r\n            boxEntryPool.Return(objects);\r\n        }\r\n    }\r\n\r\n    /** Shows/updates entry 3D display\r\n     * @param {BoxEntry} entry \r\n     * @returns {Boolean}\r\n     */\r\n    Show(entry){\r\n        if(BoxEntry.Assert(entry)){\r\n            try{\r\n                this.Dispatch(signals.show, entry);\r\n                return true;\r\n            }\r\n            catch(error){\r\n                Logger.Warn('Error in CargoInput.Show, error/entry:', error, entry);\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        Logger.Warn('BoxEntry.Assert failed in CargoInput.Show, entry:', entry);\r\n        return false;\r\n    }\r\n\r\n    /** Hides entry 3D display */\r\n    Hide(){\r\n        this.Dispatch(signals.hide);\r\n    }\r\n\r\n    /** Adds a new entry and obtain its uid\r\n     * @param {BoxEntry} entry\r\n     * @returns {Number|Boolean} uid or false if error\r\n     */\r\n    Add(entry){\r\n        if(BoxEntry.Assert(entry)){\r\n\r\n            if( Dimensions.IsVolume(entry.dimensions.Abs()) === false ){\r\n                Logger.Warn('CargoInput.Add, entry rejected, dimensions != Volume:', entry.dimensions);\r\n                return false;\r\n            }\r\n\r\n            try{\r\n                let commitedEntry = entry.Clone();\r\n                let uid = commitedEntry.SetUID();\r\n                \r\n                renewBoxEntry(entry);\r\n\r\n                this.Dispatch(signals.insert, commitedEntry);\r\n                return uid;\r\n            }\r\n            catch(error){\r\n                Logger.Warn('Error in CargoInput.Add, error/entry:', error, entry);\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        Logger.Warn('BoxEntry.Assert failed in CargoInput.Add, entry:', entry);\r\n        return false;\r\n    }\r\n\r\n    /** Modify an existing BoxEntry, referenced by its uid, using a modifed template\r\n     * @param {string} entryUID\r\n     * @param {BoxEntry} boxEntry\r\n     * @returns {Boolean} success\r\n     */\r\n    Modify(entryUID, boxEntry){\r\n        let existing = this.GetEntry(entryUID);\r\n        if(!existing){\r\n            Logger.Warn('CargoInput.Modify, entry not found for:', entryUID);\r\n            return false;\r\n        }\r\n\r\n        if(BoxEntry.Assert(boxEntry)){\r\n\r\n            if( Dimensions.IsVolume(boxEntry.dimensions.Abs()) === false ){\r\n                Logger.Warn('CargoInput.Modify, entry rejected, dimensions != Volume:', boxEntry);\r\n                return false;\r\n            }\r\n\r\n            try{\r\n                existing.Copy(boxEntry);\r\n\r\n                this.Dispatch(signals.modify, existing);\r\n                return true;\r\n            }\r\n            catch(error){\r\n                Logger.Warn('Error in CargoInput.Modify, error/entry:', error, boxEntry);\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        Logger.Warn('BoxEntry.Assert failed in CargoInput.Modify, entry:', boxEntry);\r\n        return false;\r\n    }\r\n\r\n    /** Removes an existing box entry\r\n     * @param {string} entryUID\r\n     * @returns {Boolean} success\r\n     */\r\n    Remove(entryUID){\r\n        \r\n        /** @type {CargoList} */\r\n        let cargoList = this[_cargoList];\r\n        let existing = cargoList.GetEntry(entryUID);\r\n        \r\n        if(!existing){\r\n            Logger.Warn('CargoInput.Remove, entry not found for:', entryUID);\r\n            return false;\r\n        }\r\n\r\n        this.Dispatch(signals.remove, existing);\r\n        return true;\r\n    }\r\n\r\n    /** Enumeration of dispatched types */\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nCargoInput.BoxEntry = BoxEntry;\r\n\r\nexport default CargoInput;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/CargoInput.js","import Container from \"../packer/container/Container\";\r\nimport PackingSpace from \"../packer/PackingSpace\";\r\nimport ContainerView from \"../view/ContainerView\";\r\nimport Asset from \"./assets/Asset\";\r\nimport LightDispatcher from \"./LightDispatcher\";\r\nimport Logger from \"../utils/cik/Logger\";\r\nimport ContainingVolume from \"../packer/container/ContainingVolume\";\r\n\r\n/**\r\n * @typedef PackingSpaceJSON\r\n * @property {*} jsonObject.view json data\r\n * @property {Container} jsonObject.container json data\r\n */\r\n\r\nconst signals = {\r\n    containerLoaded: 'containerLoaded',\r\n    sliderValueChange: 'sliderValueChange',\r\n    sliderValueStop: 'sliderValueStop'\r\n};\r\n\r\n/**\r\n * @typedef {Object} PackingSpaceInputParams\r\n * @property {import('../UX').default} ux\r\n */\r\n\r\n/** @param {Container} container @param {THREE.Object3D} model */\r\nfunction createContainerView(container, model, units){\r\n    let containerView;\r\n    if(model){\r\n        containerView = new ContainerView(container, model);\r\n    }\r\n    else{\r\n        containerView = ContainerView.Request(container);\r\n    }\r\n    \r\n    let padding = 60 * units;\r\n    let thickness = 2 * units;\r\n    containerView.PlatformVisibility(true, new THREE.Vector3(padding, thickness, padding));\r\n}\r\n\r\nclass PackingSpaceInput extends LightDispatcher {\r\n    /**\r\n     * @param {PackingSpaceInputParams} params \r\n     */\r\n    constructor(params){\r\n        super();\r\n\r\n        this.params = params;\r\n\r\n        this.packingSpace = new PackingSpace();\r\n    }\r\n\r\n    /** @ignore ignore */\r\n    _Bind(value){\r\n        /** @type {App} */\r\n        let app = value;\r\n    }\r\n\r\n    /**\r\n     * Creates a dummy container, get an uid for later changes (or false on error)\r\n     * @param {Number} width\r\n     * @param {Number} length\r\n     * @param {Number} height\r\n     * @param {Number} weightCapacity\r\n     * @returns {Number|Boolean} uid or false if error\r\n     */\r\n    FromInput(width, length, height, weightCapacity){\r\n        let container = new Container();\r\n\r\n        let containingVolume = new ContainingVolume(container);\r\n            containingVolume.dimensions.Set(width, length, height);\r\n            containingVolume.weightCapacity = weightCapacity;\r\n\r\n        container.Add(containingVolume);\r\n\r\n        let units = this.params.ux.params.units;\r\n        createContainerView(container, null, units);\r\n\r\n        this.packingSpace.AddContainer(container);\r\n        \r\n        this.Dispatch(signals.containerLoaded, container);\r\n        return container.uid;\r\n    }\r\n\r\n    /**\r\n     * Load packing config, get an uid for later changes (or false on error)\r\n     * @param {PackingSpaceJSON} jsonObject \r\n     * @returns {Number|Boolean} uid or false if error\r\n     */\r\n    Load(jsonObject){\r\n\r\n        /** @type {PackingSpaceJSON} jsonObject */\r\n        let data;\r\n        try{\r\n            data = typeof jsonObject === 'string' ? JSON.parse(jsonObject) : jsonObject;\r\n        }\r\n        catch(error){\r\n            Logger.Warn('Error in PackingSpaceInput.Load, error/jsonObject:', error, jsonObject);\r\n            return false;\r\n        }\r\n\r\n        if(data.container){\r\n            let container;\r\n            try{\r\n                container = Container.FromJSON(data.container);\r\n            }\r\n            catch(error){\r\n                Logger.Warn('Error in PackingSpaceInput.Load, error/jsonObject.container:', error, data.container);\r\n                return false;\r\n            }\r\n\r\n            if(!container.uid) container.SetUID();\r\n            let uid = container.uid;\r\n            \r\n            let model;\r\n            if(data.view){\r\n                try{\r\n                    model = Asset.FromJSON(data.view);\r\n                }\r\n                catch(error){\r\n                    Logger.Warn('Error in PackingSpaceInput.Load, error/jsonObject.view:', error, data.view);\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            let units = this.params.ux.params.units;\r\n            createContainerView(container, model, units);\r\n\r\n            this.packingSpace.AddContainer(container);\r\n\r\n            this.Dispatch(signals.containerLoaded, container);\r\n            return uid;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /** Enumeration of dispatched types */\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n\r\n}\r\n\r\nexport default PackingSpaceInput;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/PackingSpaceInput.js","import LightDispatcher from \"./LightDispatcher\";\r\nimport Packer from \"../packer/Packer\";\r\nimport Utils from \"../utils/cik/Utils\";\r\n\r\n/** @typedef {import('../packer/Packer').SolverParams} SolverParams */\r\n\r\n/** @typedef {import('../packer/cub/CUB').CUBParams} CUBParams */\r\n\r\nclass ResultSpace{\r\n    /** @param {string} uid */\r\n    constructor(uid){\r\n        this.uid = uid;\r\n    }\r\n}\r\n\r\nclass ResultEntry{\r\n    /** @param {string} uid @param {ResultSpace} space @param {Number} quantity */\r\n    constructor(uid, space, quantity){\r\n        this.uid = uid;\r\n        this.space = space;\r\n        this.quantity = quantity || 0;\r\n    }\r\n}\r\n\r\nclass PackingResult{\r\n    constructor(){\r\n        /** @type {Array<ResultSpace>} */\r\n        this.packingSpaces = [];\r\n        /** @type {Array<ResultEntry>} */\r\n        this.packed = [];\r\n        /** @type {Array<ResultEntry>} */\r\n        this.unpacked = [];\r\n\r\n        this.totalPacked = 0;\r\n        this.totalUnpacked = 0;\r\n        /** algorithm runtime in seconds */\r\n        this.solveDuration = 1;\r\n    }\r\n}\r\n\r\n/** @param {Packer.PackingResult} packingResult */\r\nfunction toInterfaceResults(packingResult){\r\n    let result = new PackingResult();\r\n    \r\n    /** @param {string} containerUID */\r\n    function getSpace(containerUID){\r\n        for(let i = 0; i < result.packingSpaces.length; i++){\r\n            if(result.packingSpaces[i].uid === containerUID){\r\n                return result.packingSpaces[i];\r\n            }\r\n        }\r\n\r\n        let ps = new ResultSpace(containerUID);\r\n        result.packingSpaces.push(ps);\r\n        return ps;\r\n    }\r\n\r\n    let totalPacked = 0,\r\n        totalUnpacked = 0;\r\n\r\n    /** @param {ResultEntry} resultEntry @param {Array<ResultEntry>} list */\r\n    function packEntry(resultEntry, list){\r\n        let isFirst = true;\r\n        for(let i = 0; i < list.length; i++){\r\n            if(list[i].uid === resultEntry.uid){\r\n                isFirst = false;\r\n                list[i].quantity ++;\r\n                break;\r\n            }\r\n        }\r\n\r\n        if(isFirst){\r\n            resultEntry.quantity = 1;\r\n            list.push(resultEntry);\r\n        }\r\n    }\r\n\r\n    packingResult.packed.forEach(p => {\r\n        let uid = p.entry.uid;\r\n        let space = getSpace(p.containingVolume.container.uid);\r\n        packEntry(new ResultEntry(uid, space), result.packed);\r\n        totalPacked++;\r\n    });\r\n\r\n    packingResult.unpacked.forEach(p => {\r\n        let uid = p.entry.uid;\r\n        let space = null;\r\n        let unpackedQuantity = p.unpackedQuantity;\r\n        result.unpacked.push(new ResultEntry(uid, space, unpackedQuantity));\r\n        totalUnpacked += unpackedQuantity;\r\n    });\r\n\r\n    result.totalPacked = totalPacked;\r\n    result.totalUnpacked = totalUnpacked;\r\n    result.solveDuration = packingResult.runtime;\r\n\r\n    return result;\r\n}\r\n\r\nconst signals = {\r\n    solveRequest: 'solveRequest',\r\n    solved: 'solved',\r\n    failed: 'failed'\r\n};\r\n\r\n/** @typedef PackerParams \r\n * @property {Number} defaultStackingFactor default = 5, multiplier for stacking capacity (capacity = weight * defaultStackingFactor) if stackingProperty is not enabled */\r\nconst defaultParams = {\r\n    defaultStackingFactor: 5\r\n};\r\n\r\n/** @type {SolverParams} */\r\nconst defaultSolverParams = {\r\n    algorithm: 'cub'\r\n};\r\n\r\nclass PackerInterface extends LightDispatcher {\r\n\r\n    /** @param {PackerParams} params */\r\n    constructor(params){\r\n        super();\r\n        \r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n    }\r\n\r\n    /** Solve packing for current cargo list in loaded packing space \r\n     * @param {SolverParams} params */\r\n    Solve(params){\r\n        params = Utils.AssignUndefined(params, defaultSolverParams);\r\n        this.Dispatch(signals.solveRequest, params);\r\n    }\r\n\r\n    /** @ignore ignore */\r\n    _Notify(...args){\r\n        let value = args[0];\r\n        switch(value){\r\n            case signals.solved:\r\n                let packingResult = args[1];\r\n                let result = toInterfaceResults(packingResult);\r\n                this.Dispatch(signals.solved, result);\r\n                break;\r\n            case signals.failed:\r\n                let error = args[1];\r\n                this.Dispatch(signals.failed, error);\r\n                break;\r\n        }\r\n    }\r\n\r\n    /** Enumeration of dispatched types */\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nexport default PackerInterface;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/PackerInterface.js","const api = require('./FreightPacker').default;\r\nwindow.FreightPacker = api;\n\n\n// WEBPACK FOOTER //\n// ./src/dev.js","import Capabilities from './api/utils/Capabilities';\r\nimport App, { AppParams } from './api/App';\r\nimport CargoInput, { CargoInputParams } from './api/components/CargoInput';\r\nimport Logger from './api/utils/cik/Logger';\r\nimport Utils from './api/utils/cik/Utils';\r\nimport PackingSpaceInput, { PackingSpaceInputParams } from './api/components/PackingSpaceInput';\r\nimport UX, { UXParams } from './api/UX';\r\nimport PackerInterface, { PackerParams } from './api/components/PackerInterface';\r\nimport LightDispatcher from './api/components/LightDispatcher';\r\nimport Constants from './api/Constants';\r\nimport Resources from './api/Resources';\r\n\r\n//#region dev\r\nconst utils = {\r\n\tTHREE: THREE,\r\n\tdat: (window.dat || require('./api/utils/cik/config/datGUIConsole').default),\r\n\tSignaler: require('./api/utils/cik/Signaler').default,\r\n\tUtils: require('./api/utils/cik/Utils').default,\r\n\tDebug: require('./api/debug/Debug').default,\r\n\tConfig: require('./api/utils/cik/config/Config').default\r\n};\r\n\r\n/** @param {FreightPacker|App} domain */\r\nfunction devSetup(domain){\r\n\tif(domain instanceof FreightPacker){\r\n\t\tlet fp = domain;\r\n\t\tglobal.fp = fp;\r\n\t\tFreightPacker.utils.Debug.api = fp;\r\n\t\tlet params = fp.params;\r\n\t\tif(params.debug) {\r\n\t\t\tLogger.active = true;\r\n\t\t\tLogger.toConsole = true;\r\n\t\t\tLogger.traceToConsole = true;\r\n\t\t}\r\n\r\n\t\t//require('./api/debug/Tester').testPool();\r\n\t\t//utils.Debug.CLPTest.Test1();\r\n\t}\r\n\r\n\tif(domain instanceof App){\r\n\t\tconst SceneSetup = require('./api/view/SceneSetup').default;\r\n\t\tlet app = domain;\r\n\t\tFreightPacker.utils.Debug.app = app;\r\n\t\tapp.sceneSetup.OnIncludingPrior(SceneSetup.signals.init, function(){\r\n\t\t\tFreightPacker.utils.Debug.Viz.SetViewParent(app.sceneSetup.sceneController.scene);\r\n\t\t});\r\n\t}\r\n}\r\n\r\n/** @param {FreightPacker} fp */\r\nfunction auto(fp){\r\n\t\r\n}\r\n\r\n//#endregion\r\n\r\n/**\r\n * @typedef InitializationParams\r\n * @property {Boolean} debug set to false for deployment\r\n * @property {string} texturesPath url to textures directory\r\n * @property {UXParams} uxParams UX parameters\r\n * @property {PackerParams} packerParams Packer general parameters\r\n */\r\n\r\n/**\r\n * @type {InitializationParams}\r\n */\r\nconst defaultParams = {\r\n\tdebug: false\r\n};\r\n\r\nconst signals = {\r\n\tready: 'ready'\r\n};\r\n\r\nclass FreightPacker extends LightDispatcher {\r\n\t/**\r\n\t * Freight Packer API instance\r\n\t * @param {HTMLDivElement} containerDiv\r\n\t * @param {InitializationParams} params\r\n\t */\r\n\tconstructor( containerDiv, params ) {\r\n\r\n\t\tsuper();\r\n\t\tlet scope = this;\r\n\r\n\t\tthis.params = Utils.AssignUndefined(params, defaultParams);\r\n\t\tdevSetup(this);\r\n\r\n\t\tthis.ux = new UX(this.params.uxParams);\r\n\r\n\t\t/** @type {CargoInputParams} */\r\n\t\tlet cargoInputParams = {ux: this.ux};\r\n\r\n\t\t/** Handles input of: description fields (label, etc.), dimensions and constraints */\r\n\t\tthis.cargoInput = new CargoInput(cargoInputParams);\r\n\r\n\t\t/** @type {PackingSpaceInputParams} */\r\n\t\tlet packingSpaceInputParams = {ux: this.ux};\r\n\r\n\t\t/** Handles input of: packing spaces configurations and assets */\r\n\t\tthis.packingSpaceInput = new PackingSpaceInput(packingSpaceInputParams);\r\n\r\n\t\t/** Manual solving and notification */\r\n\t\tthis.packer = new PackerInterface(this.params.packerParams);\r\n\r\n\t\tlet resources = new Resources();\r\n\t\t\tresources.texturesPath = this.params.texturesPath;\r\n\r\n\t\t/** @type {AppParams} */\r\n\t\tlet appParams = {ux: this.ux, cargoInput: this.cargoInput, packingSpaceInput: this.packingSpaceInput, packerInterface: this.packer, resources: resources};\r\n\t\tlet app = new App(containerDiv, appParams);\r\n\t\t\tapp.On(App.signals.start, function(){\r\n\t\t\t\tscope.Dispatch(signals.ready);\r\n\t\t\t});\r\n\r\n\t\tdevSetup(app);\r\n\r\n\t\tif(this.params.debug){\r\n\t\t\tauto(this);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Check that webgl, etc are supported in this browser.\r\n\t * Will resolve if requirements are met, otherwise rejects with an error message\r\n\t * @return {Promise<Void>|Promise<string>} \r\n\t */\r\n\tstatic CheckRequirements () {\r\n\t\tlet webgl = Capabilities.IsWebGLReady();\r\n\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tif(webgl){\r\n\t\t\t\tresolve();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet message = 'WebGL not supported.';\r\n\t\t\t\treject(message);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/** Enumeration of dispatched types */\r\n\tstatic get signals(){\r\n\t\treturn signals;\r\n\t}\r\n\r\n\tstatic get utils(){\r\n\t\treturn utils;\r\n\t}\r\n\r\n}\r\n\r\nFreightPacker.UX = UX;\r\nFreightPacker.CargoInput = CargoInput;\r\nFreightPacker.PackingSpaceInput = PackingSpaceInput;\r\nFreightPacker.Packer = PackerInterface;\r\nFreightPacker.Constants = Constants;\r\n\r\nexport default FreightPacker;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/FreightPacker.js","\r\nclass Capabilities {\r\n    constructor() {\r\n      \r\n    }\r\n  \r\n    static IsWebGLReady(){\r\n        var canvas = document.createElement('canvas');\r\n        var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\r\n        return gl && gl instanceof WebGLRenderingContext;\r\n    }\r\n}\r\n\r\nexport default Capabilities;\r\n  \n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/Capabilities.js","import UpdateComponent from \"./UpdateComponent\";\r\nimport RaycastGroup from \"./RaycastGroup\";\r\n\r\nconst keypress = require('../../../../min-dependencies/lib/keypress');\r\n\r\n/**\r\n * @typedef {Object} IScreen\r\n * @property {Number} x\r\n * @property {Number} y\r\n * @property {Number} width\r\n * @property {Number} height\r\n * @property {Number} left\r\n * @property {Number} right\r\n * @property {Number} bottom\r\n * @property {Number} top\r\n */\r\n\r\n/**\r\n * @typedef {Object} DragEvent\r\n * @property {MouseEvent} mouseEvent\r\n * @property {Number} sx - Start screen x\r\n * @property {Number} sy - Start screen y\r\n * @property {Number} x - Current screen x\r\n * @property {Number} y - Current screen y\r\n * @property {Number} dx - Delta x\r\n * @property {Number} dy - Delta y\r\n * @property {Number} distance - Distance (current - start)\r\n * @property {Number} minDist - Minimum distance to raise onDrag\r\n */\r\n\r\n /** keyboard api (http://dmauro.github.io/Keypress/)\r\n * @typedef keyboard\r\n * @property {function} on\r\n * @property {function} unregister\r\n */\r\n\r\nconst epsilon = Math.pow(2, -52);\r\nconst defaultKeysListen = 'abcdefghijklmnopqrtsuvwxyz'.split('').concat(['ctlr', 'shift', 'alt']);\r\n\r\nclass Input {\r\n\r\n    /**\r\n     * \r\n     * @param {HTMLElement} domContainer \r\n     */\r\n    constructor (domContainer){\r\n        this.enabled = true;\r\n        \r\n        var scope = this;\r\n        Object.defineProperty(this, 'camera', {\r\n            get: function(){\r\n                return scope._camera;\r\n            },\r\n            set: function(camera){\r\n                scope._camera = camera;\r\n                scope.fov = {min: 40, max: camera.fov, target: camera.fov};\r\n            }\r\n        });\r\n\r\n        this.domContainer = domContainer;\r\n\r\n        this._mouse = {x:0, y:0};\r\n        this.mouseScreen = new THREE.Vector2();\r\n        this.mouseViewport = new THREE.Vector2();\r\n        this.mouseDelta = new THREE.Vector2();\r\n        this.lastMouseDownTime = 0;\r\n        /**\r\n         * @type {IScreen}\r\n         */\r\n        this.screen = {};\r\n        this.ComputeScreen();\r\n\r\n        this.raycaster = new THREE.Raycaster();\r\n\r\n        this.clock = new THREE.Clock();\r\n        this.clock.start();\r\n\r\n        this._raycastGroups = {Update:{}, Update25:{}, Update10:{}, OnMouseDown:{}, OnDoubleClick:{}, OnMouseUp:{}, OnRightClick:{}, OnClick:{}};\r\n        this.updateComponents = [\r\n            new UpdateComponent(true, 1/25, this.Update25.bind(this)),\r\n            new UpdateComponent(true, 1/10, this.Update10.bind(this))\r\n        ];\r\n\r\n        this.fireOnce = [];\r\n\r\n        this.onMouseDown = [];\r\n        this.onMouseUp = [];\r\n        this.onRightClick = [];\r\n        this.onDoubleClick = [];\r\n        this.onClick = [];\r\n        this.onDrag = [];\r\n\r\n        /**\r\n         * @type {DragEvent}\r\n         */\r\n        this.onDragEvent = {\r\n            mouseEvent: undefined,\r\n            sx: undefined, sy: undefined,\r\n            x: 0, y: 0,\r\n            dx: 0, dy: 0,\r\n            distance: 0,\r\n            minDist: 4 // pixels \r\n        };\r\n        var onDragStatus = false;\r\n        Object.defineProperty(this.onDragEvent, '_status', {\r\n            get: function(){\r\n                return onDragStatus;\r\n            },\r\n            set: function(value){\r\n                onDragStatus = value;\r\n                this.sx = this.sy = undefined;\r\n                this.dx = this.dy = 0;\r\n            }\r\n        })\r\n\r\n        this.doubleClickTime = .2;\r\n        \r\n        this.domContainer.addEventListener('mousedown', this.OnMouseDown.bind(this));\r\n        this.domContainer.addEventListener('mouseup', this.OnMouseUp.bind(this));\r\n        this.domContainer.addEventListener('contextmenu', this.OnRightClick.bind(this));\r\n        this.domContainer.addEventListener('mousemove', this.OnMouseMove.bind(this), false);\r\n\r\n        var thisOnMouseWheel = this.OnMouseWheel.bind(this);\r\n        if (this.domContainer.addEventListener) {\r\n            this.domContainer.addEventListener(\"mousewheel\", thisOnMouseWheel, false);\r\n            this.domContainer.addEventListener(\"DOMMouseScroll\", thisOnMouseWheel, false);\r\n        }\r\n        else\r\n            this.domContainer.attachEvent(\"onmousewheel\", thisOnMouseWheel);\r\n\r\n        this.screenNeedsUpdate = true;\r\n        window.addEventListener('scroll', this.OnScroll.bind(this));\r\n\r\n        this.cameraNeedsUpdate = true;\r\n        this.onResize = [];\r\n        window.addEventListener('resize', this.OnResize.bind(this));\r\n\r\n        /**\r\n         * @type {keyboard}\r\n         */\r\n        this.keyboard = new keypress.Listener();\r\n        this.keyboard.on = this.keyboard.simple_combo;\r\n        this.keyboard.unregister = this.keyboard.unregister_combo;\r\n        this.keys = {};\r\n\r\n        //\r\n        \r\n    }\r\n\r\n    Dispose(){\r\n        // remove listeners\r\n    }\r\n\r\n    ListenKeys(keys){\r\n        if(keys === undefined) {\r\n            keys = defaultKeysListen;\r\n        }\r\n\r\n        var scope = this;\r\n        keys.forEach(key => {\r\n            scope.keys[key] = false;\r\n            scope.keyboard.register_combo({\r\n                keys: key,\r\n                prevent_repeat: true,\r\n                on_keydown: function(){\r\n                    scope.keys[key] = true;\r\n                },\r\n                on_keyup: function(){\r\n                    scope.keys[key] = false;\r\n                }\r\n            });\r\n        });\r\n    }\r\n\r\n    ComputeScreen(){\r\n        var screen = this.domContainer.getBoundingClientRect();\r\n        this.screen.x = screen.x;\r\n        this.screen.y = screen.y;\r\n        this.screen.width = screen.width;\r\n        this.screen.height = screen.height;\r\n        this.screen.left = screen.left;\r\n        this.screen.right = screen.right;\r\n        this.screen.bottom = screen.bottom;\r\n        this.screen.top = screen.top;\r\n        \r\n        /*\r\n        var rectOffset = Utils.GetRectOffset(this.domContainer);\r\n        this.screen.x += rectOffset.x;\r\n        this.screen.left += rectOffset.x;\r\n        this.screen.y += rectOffset.y;\r\n        this.screen.top += rectOffset.y;\r\n        */\r\n    }\r\n\r\n    OnMouseDown(mouseEvent){\r\n        if(mouseEvent.button === 0){\r\n            this.UpdateScreenAndMouse(mouseEvent);\r\n            var now = this.clock.getElapsedTime();\r\n            if(now - this.lastMouseDownTime < this.doubleClickTime){\r\n                if(this._dridMouseDown !== undefined){\r\n                    this.AbortDelayedAction(this._dridMouseDown);\r\n                    this._dridMouseDown = undefined;\r\n                }\r\n                this.OnDoubleClick(mouseEvent);\r\n                return;\r\n            }\r\n\r\n            this.lastMouseDownTime = now;\r\n            this.onDragEvent._status = true;\r\n\r\n            var scope = this;\r\n            this._dridMouseDown = this.DelayedAction(\r\n                this._mouseDownDelayed = function(){\r\n                    scope._dridMouseDown = undefined;\r\n                    for(var i = 0; i < scope.onMouseDown.length; i++){\r\n                        scope.onMouseDown[i](mouseEvent);\r\n                    }\r\n                    scope.UpdateRaycast('OnMouseDown');\r\n                    scope.mouseDelta.copy(scope.mouseScreen);\r\n                }, \r\n                this.doubleClickTime * 1000\r\n            );\r\n        }\r\n    }\r\n\r\n    OnDoubleClick(mouseEvent){\r\n        for(var i = 0; i < this.onDoubleClick.length; i++){\r\n            this.onDoubleClick[i](mouseEvent);\r\n        }\r\n\r\n        this.UpdateRaycast('OnDoubleClick');\r\n    }\r\n\r\n    ExecuteDelayedMD(mouseEvent){\r\n        if(this._dridMouseDown !== undefined){\r\n            this.AbortDelayedAction(this._dridMouseDown);\r\n            this._dridMouseDown = undefined;\r\n            this._mouseDownDelayed();\r\n        }\r\n    }\r\n\r\n    OnMouseUp(mouseEvent){\r\n        if(mouseEvent.button === 0){\r\n            var now = this.clock.getElapsedTime();\r\n            if(now - this.lastMouseDownTime < this.doubleClickTime){\r\n                this.ExecuteDelayedMD(mouseEvent);\r\n            }\r\n            \r\n            this.UpdateScreenAndMouse(mouseEvent);\r\n            for(var i = 0; i < this.onMouseUp.length; i++){\r\n                this.onMouseUp[i](mouseEvent);\r\n            }\r\n\r\n            this.UpdateRaycast('OnMouseUp');\r\n            var d = this.mouseDelta.distanceToSquared(this.mouseScreen);\r\n            var noMouseDrag = d < 10; // pixels squared\r\n            if(noMouseDrag){\r\n                this.OnClick(mouseEvent);\r\n            }\r\n\r\n            this.onDragEvent._status = false;\r\n        }\r\n    }\r\n\r\n    OnMouseDrag(){\r\n        var p = this.onDragEvent;\r\n        if(p._status){\r\n            let m = this.mouseScreen;\r\n            if(p.sx === undefined) p.sx = p.x = m.x;\r\n            if(p.sy === undefined) p.sy = p.y = m.y;\r\n\r\n            let vx = p.x - p.sx,\r\n                vy = p.y - p.sy;\r\n            p.distance = Math.sqrt(vx * vx + vy * vy);\r\n            if(p.distance > p.minDist && \r\n                (Math.abs(p.dx) > epsilon || Math.abs(p.dy) > epsilon)\r\n            ){\r\n                for(var i = 0; i < this.onDrag.length; i++){\r\n                    this.onDrag[i](p);\r\n                }\r\n            }\r\n\r\n            p.dx = p.x - m.x;\r\n            p.dy = p.y - m.y;\r\n\r\n            p.x = m.x;\r\n            p.y = m.y;\r\n        }\r\n    }\r\n\r\n    OnClick(mouseEvent){\r\n        for(var i = 0; i < this.onClick.length; i++){\r\n            this.onClick[i](mouseEvent);\r\n        }\r\n\r\n        this.UpdateRaycast('OnClick');\r\n    }\r\n\r\n    OnRightClick(mouseEvent){\r\n        //mouseEvent.preventDefault();\r\n        this.UpdateScreenAndMouse(mouseEvent);\r\n        for(var i = 0; i < this.onRightClick.length; i++){\r\n            this.onRightClick[i](mouseEvent);\r\n        }\r\n\r\n        this.UpdateRaycast('OnRightClick');\r\n    }\r\n\r\n    OnMouseMove(mouseEvent){\r\n        this._mouse.x = THREE.Math.clamp(mouseEvent.clientX - this.screen.left, 0, this.screen.width);\r\n        this._mouse.y = THREE.Math.clamp(mouseEvent.clientY - this.screen.top, 0, this.screen.height);\r\n        this.onDragEvent.mouseEvent = mouseEvent;\r\n        this.ExecuteDelayedMD(mouseEvent);\r\n    }\r\n\r\n    OnScroll(event){\r\n        this.screenNeedsUpdate = true;\r\n    }\r\n\r\n    OnMouseWheel(mouseEvent){\r\n        mouseEvent.preventDefault();\r\n        var delta = THREE.Math.clamp(mouseEvent.wheelDelta || -mouseEvent.detail, -1, 1);\r\n        this.fov.target = THREE.Math.clamp(this.fov.target - delta * 2., this.fov.min, this.fov.max);\r\n        this.fov.lerp = 0;\r\n    }\r\n\r\n    LerpZoom(){\r\n        this.fov.lerp += .1;\r\n        if(this.fov.lerp >= 1 || Number.isNaN(this.fov.lerp)){\r\n            return;\r\n        }\r\n        this.camera.fov += (this.fov.target - this.camera.fov) * this.fov.lerp;\r\n        this.camera.updateProjectionMatrix();\r\n    }\r\n\r\n    OnResize(event) {\r\n        this.screenNeedsUpdate = true;\r\n        this.cameraNeedsUpdate = true;\r\n    }\r\n\r\n    RemoveEventCallback(eventType, callback){\r\n        var callbacks = this[eventType];\r\n        for(var iCallback = 0; iCallback < callbacks.length; iCallback++){\r\n            if(callbacks[iCallback] === callback){\r\n                callbacks.splice(iCallback, 1);\r\n            }\r\n        }\r\n    }\r\n\r\n    Update(){\r\n        this.UpdateScreenAndMouse();\r\n\r\n        this.FireOnce();\r\n\r\n        // Raycasts\r\n        this.UpdateRaycaster();\r\n        this.UpdateRaycast('Update');\r\n\r\n        var now = this.clock.getElapsedTime();\r\n        for(var iUpdate = 0; iUpdate < this.updateComponents.length; iUpdate++){\r\n            var updateComponent = this.updateComponents[iUpdate];\r\n            if(updateComponent.active\r\n                && (now - updateComponent.lastUpdateTime > updateComponent.interval)\r\n            ){\r\n                updateComponent.Update(now);\r\n            }\r\n        }\r\n\r\n        this.OnMouseDrag();\r\n    }\r\n\r\n    Update25(){\r\n        this.LerpZoom();\r\n        this.UpdateRaycast('Update25');\r\n    }\r\n\r\n    Update10(){\r\n        this.UpdateRaycast('Update10');\r\n    }\r\n\r\n    FireOnce(){\r\n        for(var iCallback = this.fireOnce.length; iCallback-- > 0;){\r\n            this.fireOnce[iCallback]();\r\n        }\r\n        this.fireOnce.length = 0;\r\n    }\r\n\r\n    DelayedAction(action, delay){\r\n        var drid = window.setTimeout(function(){\r\n            action();\r\n        }, delay);\r\n        return drid;\r\n    }\r\n\r\n    AbortDelayedAction(drid){\r\n        window.clearTimeout(drid);\r\n        return;\r\n    }\r\n\r\n    Repeat(action, interval){\r\n        if(this._repeats === undefined) this._repeats = [];\r\n        var drid = window.setInterval(function(){\r\n            action();\r\n        }, interval);\r\n        this._repeats.push({action:action, drid:drid});\r\n        return drid;\r\n    }\r\n\r\n    StopRepeat(action){\r\n        if(this._repeats === undefined) return;\r\n        if(typeof action === 'number'){\r\n            window.clearInterval(action);\r\n            return;\r\n        }\r\n        for(var i = 0; i < this._repeats.length; i++){\r\n            if(this._repeats[i].action === action){\r\n                window.clearInterval(this._repeats[i].drid);\r\n                this._repeats.splice(i, 1);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n\r\n    UpdateScreenAndMouse(mouseEvent){\r\n        if(this.screenNeedsUpdate) {\r\n            this.ComputeScreen();\r\n            this.screenNeedsUpdate = false;\r\n        }\r\n        if(this.cameraNeedsUpdate) {\r\n            for(var i = 0; i < this.onResize.length; i++){\r\n                this.onResize[i](this.screen);\r\n            }\r\n            this.cameraNeedsUpdate = false;\r\n        }\r\n\r\n        if(mouseEvent !== undefined){\r\n            this._mouse.x = THREE.Math.clamp(mouseEvent.clientX - this.screen.left, 0, this.screen.width);\r\n            this._mouse.y = THREE.Math.clamp(mouseEvent.clientY - this.screen.top, 0, this.screen.height);\r\n        }\r\n\r\n        this.mouseScreen.x = this._mouse.x;\r\n        this.mouseScreen.y = this._mouse.y;\r\n\r\n        this.mouseViewport.x = this._mouse.x / this.screen.width * 2 - 1;\r\n        this.mouseViewport.y = -this._mouse.y / this.screen.height * 2 + 1;\r\n    }\r\n\r\n    RaycastTest(objects, recursive){\r\n        this.UpdateRaycaster();\r\n        recursive = recursive !== undefined ? recursive : false;\r\n        var intersects = objects instanceof Array ? this.raycaster.intersectObjects(objects, recursive) : this.raycaster.intersectObject(objects, recursive);\r\n        if (intersects.length > 0) {\r\n            return intersects[0];\r\n        }\r\n        return undefined;\r\n    }\r\n\r\n    /**\r\n     * @param {string} event Update Update25 Update10 OnMouseDown OnDoubleClick OnMouseUp OnRightClick OnClick\r\n     * @param {string} groupID \r\n     * @param {RaycastGroup} group \r\n     */\r\n    AddRaycastGroup(event, groupID, group){\r\n        if(this._raycastGroups[event][groupID] !== undefined) console.log('RaycastGroup ' + groupID + ' is being overwritten.');\r\n        this._raycastGroups[event][groupID] = group;\r\n    }\r\n\r\n    RemoveRaycastGroup(event, groupID){\r\n        delete this._raycastGroups[event][groupID];\r\n    }\r\n\r\n    UpdateRaycaster(){\r\n        this.camera.updateMatrixWorld();\r\n        this.raycaster.setFromCamera(this.mouseViewport, this.camera);\r\n    }\r\n\r\n    UpdateRaycast(event){\r\n        var raycastGroupsKeys = Object.keys(this._raycastGroups[event]);\r\n        var numRaycastGroups = raycastGroupsKeys.length;\r\n        if(numRaycastGroups > 0){\r\n            if(numRaycastGroups > 1)\r\n                raycastGroupsKeys.sort().reverse();\r\n            \r\n            for(var iGroup = 0; iGroup < numRaycastGroups; iGroup++){\r\n                var key = raycastGroupsKeys[iGroup];\r\n                this._raycastGroups[event][key].Raycast(this.raycaster);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nexport default Input;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/input/Input.js","// Generated by CoffeeScript 1.8.0\r\n\r\n/*\r\nCopyright 2014 David Mauro\r\n\r\nLicensed under the Apache License, Version 2.0 (the \"License\");\r\nyou may not use this file except in compliance with the License.\r\nYou may obtain a copy of the License at\r\n\r\nhttp://www.apache.org/licenses/LICENSE-2.0\r\n\r\nUnless required by applicable law or agreed to in writing, software\r\ndistributed under the License is distributed on an \"AS IS\" BASIS,\r\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\nSee the License for the specific language governing permissions and\r\nlimitations under the License.\r\n\r\nKeypress is a robust keyboard input capturing Javascript utility\r\nfocused on input for games.\r\n\r\nversion 2.1.3\r\n */\r\n\r\n\r\n/*\r\nCombo options available and their defaults:\r\n    keys            : []            - An array of the keys pressed together to activate combo.\r\n    count           : 0             - The number of times a counting combo has been pressed. Reset on release.\r\n    is_unordered    : false         - Unless this is set to true, the keys can be pressed down in any order.\r\n    is_counting     : false         - Makes this a counting combo (see documentation).\r\n    is_exclusive    : false         - This combo will replace other exclusive combos when true.\r\n    is_solitary     : false         - This combo will only fire if ONLY it's keys are pressed down.\r\n    is_sequence     : false         - Rather than a key combo, this is an ordered key sequence.\r\n    prevent_default : false         - Prevent default behavior for all component key keypresses.\r\n    prevent_repeat  : false         - Prevent the combo from repeating when keydown is held.\r\n    on_keydown      : null          - A function that is called when the combo is pressed.\r\n    on_keyup        : null          - A function that is called when the combo is released.\r\n    on_release      : null          - A function that is called when all keys in the combo are released.\r\n    this            : undefined     - Defines the scope for your callback functions.\r\n */\r\n\r\n(function() {\r\n  var Combo, keypress, _change_keycodes_by_browser, _compare_arrays, _compare_arrays_sorted, _convert_key_to_readable, _convert_to_shifted_key, _decide_meta_key, _factory_defaults, _filter_array, _index_of_in_array, _is_array_in_array, _is_array_in_array_sorted, _key_is_valid, _keycode_alternate_names, _keycode_dictionary, _keycode_shifted_keys, _log_error, _metakey, _modifier_event_mapping, _modifier_keys, _validate_combo,\r\n    __hasProp = {}.hasOwnProperty,\r\n    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };\r\n\r\n  _factory_defaults = {\r\n    is_unordered: false,\r\n    is_counting: false,\r\n    is_exclusive: false,\r\n    is_solitary: false,\r\n    prevent_default: false,\r\n    prevent_repeat: false\r\n  };\r\n\r\n  _modifier_keys = [\"meta\", \"alt\", \"option\", \"ctrl\", \"shift\", \"cmd\"];\r\n\r\n  _metakey = \"ctrl\";\r\n\r\n  keypress = {};\r\n\r\n  keypress.debug = false;\r\n\r\n  Combo = (function() {\r\n    function Combo(dictionary) {\r\n      var property, value;\r\n      for (property in dictionary) {\r\n        if (!__hasProp.call(dictionary, property)) continue;\r\n        value = dictionary[property];\r\n        if (value !== false) {\r\n          this[property] = value;\r\n        }\r\n      }\r\n      this.keys = this.keys || [];\r\n      this.count = this.count || 0;\r\n    }\r\n\r\n    Combo.prototype.allows_key_repeat = function() {\r\n      return !this.prevent_repeat && typeof this.on_keydown === \"function\";\r\n    };\r\n\r\n    Combo.prototype.reset = function() {\r\n      this.count = 0;\r\n      return this.keyup_fired = null;\r\n    };\r\n\r\n    return Combo;\r\n\r\n  })();\r\n\r\n  keypress.Listener = (function() {\r\n    function Listener(element, defaults) {\r\n      var attach_handler, property, value;\r\n      if ((typeof jQuery !== \"undefined\" && jQuery !== null) && element instanceof jQuery) {\r\n        if (element.length !== 1) {\r\n          _log_error(\"Warning: your jQuery selector should have exactly one object.\");\r\n        }\r\n        element = element[0];\r\n      }\r\n      this.should_suppress_event_defaults = false;\r\n      this.should_force_event_defaults = false;\r\n      this.sequence_delay = 800;\r\n      this._registered_combos = [];\r\n      this._keys_down = [];\r\n      this._active_combos = [];\r\n      this._sequence = [];\r\n      this._sequence_timer = null;\r\n      this._prevent_capture = false;\r\n      this._defaults = defaults || {};\r\n      for (property in _factory_defaults) {\r\n        if (!__hasProp.call(_factory_defaults, property)) continue;\r\n        value = _factory_defaults[property];\r\n        this._defaults[property] = this._defaults[property] || value;\r\n      }\r\n      this.element = element || document.body;\r\n      attach_handler = function(target, event, handler) {\r\n        if (target.addEventListener) {\r\n          target.addEventListener(event, handler);\r\n        } else if (target.attachEvent) {\r\n          target.attachEvent(\"on\" + event, handler);\r\n        }\r\n        return handler;\r\n      };\r\n      this.keydown_event = attach_handler(this.element, \"keydown\", (function(_this) {\r\n        return function(e) {\r\n          e = e || window.event;\r\n          _this._receive_input(e, true);\r\n          return _this._bug_catcher(e);\r\n        };\r\n      })(this));\r\n      this.keyup_event = attach_handler(this.element, \"keyup\", (function(_this) {\r\n        return function(e) {\r\n          e = e || window.event;\r\n          return _this._receive_input(e, false);\r\n        };\r\n      })(this));\r\n      this.blur_event = attach_handler(window, \"blur\", (function(_this) {\r\n        return function() {\r\n          var key, _i, _len, _ref;\r\n          _ref = _this._keys_down;\r\n          for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n            key = _ref[_i];\r\n            _this._key_up(key, {});\r\n          }\r\n          return _this._keys_down = [];\r\n        };\r\n      })(this));\r\n    }\r\n\r\n    Listener.prototype.destroy = function() {\r\n      var remove_handler;\r\n      remove_handler = function(target, event, handler) {\r\n        if (target.removeEventListener != null) {\r\n          return target.removeEventListener(event, handler);\r\n        } else if (target.removeEvent != null) {\r\n          return target.removeEvent(\"on\" + event, handler);\r\n        }\r\n      };\r\n      remove_handler(this.element, \"keydown\", this.keydown_event);\r\n      remove_handler(this.element, \"keyup\", this.keyup_event);\r\n      return remove_handler(window, \"blur\", this.blur_event);\r\n    };\r\n\r\n    Listener.prototype._bug_catcher = function(e) {\r\n      var _ref, _ref1;\r\n      if (_metakey === \"cmd\" && __indexOf.call(this._keys_down, \"cmd\") >= 0 && ((_ref = _convert_key_to_readable((_ref1 = e.keyCode) != null ? _ref1 : e.key)) !== \"cmd\" && _ref !== \"shift\" && _ref !== \"alt\" && _ref !== \"caps\" && _ref !== \"tab\")) {\r\n        return this._receive_input(e, false);\r\n      }\r\n    };\r\n\r\n    Listener.prototype._cmd_bug_check = function(combo_keys) {\r\n      if (_metakey === \"cmd\" && __indexOf.call(this._keys_down, \"cmd\") >= 0 && __indexOf.call(combo_keys, \"cmd\") < 0) {\r\n        return false;\r\n      }\r\n      return true;\r\n    };\r\n\r\n    Listener.prototype._prevent_default = function(e, should_prevent) {\r\n      if ((should_prevent || this.should_suppress_event_defaults) && !this.should_force_event_defaults) {\r\n        if (e.preventDefault) {\r\n          e.preventDefault();\r\n        } else {\r\n          e.returnValue = false;\r\n        }\r\n        if (e.stopPropagation) {\r\n          return e.stopPropagation();\r\n        }\r\n      }\r\n    };\r\n\r\n    Listener.prototype._get_active_combos = function(key) {\r\n      var active_combos, keys_down;\r\n      active_combos = [];\r\n      keys_down = _filter_array(this._keys_down, function(down_key) {\r\n        return down_key !== key;\r\n      });\r\n      keys_down.push(key);\r\n      this._match_combo_arrays(keys_down, (function(_this) {\r\n        return function(match) {\r\n          if (_this._cmd_bug_check(match.keys)) {\r\n            return active_combos.push(match);\r\n          }\r\n        };\r\n      })(this));\r\n      this._fuzzy_match_combo_arrays(keys_down, (function(_this) {\r\n        return function(match) {\r\n          if (__indexOf.call(active_combos, match) >= 0) {\r\n            return;\r\n          }\r\n          if (!(match.is_solitary || !_this._cmd_bug_check(match.keys))) {\r\n            return active_combos.push(match);\r\n          }\r\n        };\r\n      })(this));\r\n      return active_combos;\r\n    };\r\n\r\n    Listener.prototype._get_potential_combos = function(key) {\r\n      var combo, potentials, _i, _len, _ref;\r\n      potentials = [];\r\n      _ref = this._registered_combos;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        combo = _ref[_i];\r\n        if (combo.is_sequence) {\r\n          continue;\r\n        }\r\n        if (__indexOf.call(combo.keys, key) >= 0 && this._cmd_bug_check(combo.keys)) {\r\n          potentials.push(combo);\r\n        }\r\n      }\r\n      return potentials;\r\n    };\r\n\r\n    Listener.prototype._add_to_active_combos = function(combo) {\r\n      var active_combo, active_key, active_keys, already_replaced, combo_key, i, should_prepend, should_replace, _i, _j, _k, _len, _len1, _ref, _ref1;\r\n      should_replace = false;\r\n      should_prepend = true;\r\n      already_replaced = false;\r\n      if (__indexOf.call(this._active_combos, combo) >= 0) {\r\n        return true;\r\n      } else if (this._active_combos.length) {\r\n        for (i = _i = 0, _ref = this._active_combos.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n          active_combo = this._active_combos[i];\r\n          if (!(active_combo && active_combo.is_exclusive && combo.is_exclusive)) {\r\n            continue;\r\n          }\r\n          active_keys = active_combo.keys;\r\n          if (!should_replace) {\r\n            for (_j = 0, _len = active_keys.length; _j < _len; _j++) {\r\n              active_key = active_keys[_j];\r\n              should_replace = true;\r\n              if (__indexOf.call(combo.keys, active_key) < 0) {\r\n                should_replace = false;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          if (should_prepend && !should_replace) {\r\n            _ref1 = combo.keys;\r\n            for (_k = 0, _len1 = _ref1.length; _k < _len1; _k++) {\r\n              combo_key = _ref1[_k];\r\n              should_prepend = false;\r\n              if (__indexOf.call(active_keys, combo_key) < 0) {\r\n                should_prepend = true;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          if (should_replace) {\r\n            if (already_replaced) {\r\n              active_combo = this._active_combos.splice(i, 1)[0];\r\n              if (active_combo != null) {\r\n                active_combo.reset();\r\n              }\r\n            } else {\r\n              active_combo = this._active_combos.splice(i, 1, combo)[0];\r\n              if (active_combo != null) {\r\n                active_combo.reset();\r\n              }\r\n              already_replaced = true;\r\n            }\r\n            should_prepend = false;\r\n          }\r\n        }\r\n      }\r\n      if (should_prepend) {\r\n        this._active_combos.unshift(combo);\r\n      }\r\n      return should_replace || should_prepend;\r\n    };\r\n\r\n    Listener.prototype._remove_from_active_combos = function(combo) {\r\n      var active_combo, i, _i, _ref;\r\n      for (i = _i = 0, _ref = this._active_combos.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n        active_combo = this._active_combos[i];\r\n        if (active_combo === combo) {\r\n          combo = this._active_combos.splice(i, 1)[0];\r\n          combo.reset();\r\n          break;\r\n        }\r\n      }\r\n    };\r\n\r\n    Listener.prototype._get_possible_sequences = function() {\r\n      var combo, i, j, match, matches, sequence, _i, _j, _k, _len, _ref, _ref1, _ref2;\r\n      matches = [];\r\n      _ref = this._registered_combos;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        combo = _ref[_i];\r\n        for (j = _j = 1, _ref1 = this._sequence.length; 1 <= _ref1 ? _j <= _ref1 : _j >= _ref1; j = 1 <= _ref1 ? ++_j : --_j) {\r\n          sequence = this._sequence.slice(-j);\r\n          if (!combo.is_sequence) {\r\n            continue;\r\n          }\r\n          if (__indexOf.call(combo.keys, \"shift\") < 0) {\r\n            sequence = _filter_array(sequence, function(key) {\r\n              return key !== \"shift\";\r\n            });\r\n            if (!sequence.length) {\r\n              continue;\r\n            }\r\n          }\r\n          for (i = _k = 0, _ref2 = sequence.length; 0 <= _ref2 ? _k < _ref2 : _k > _ref2; i = 0 <= _ref2 ? ++_k : --_k) {\r\n            if (combo.keys[i] === sequence[i]) {\r\n              match = true;\r\n            } else {\r\n              match = false;\r\n              break;\r\n            }\r\n          }\r\n          if (match) {\r\n            matches.push(combo);\r\n          }\r\n        }\r\n      }\r\n      return matches;\r\n    };\r\n\r\n    Listener.prototype._add_key_to_sequence = function(key, e) {\r\n      var combo, sequence_combos, _i, _len;\r\n      this._sequence.push(key);\r\n      sequence_combos = this._get_possible_sequences();\r\n      if (sequence_combos.length) {\r\n        for (_i = 0, _len = sequence_combos.length; _i < _len; _i++) {\r\n          combo = sequence_combos[_i];\r\n          this._prevent_default(e, combo.prevent_default);\r\n        }\r\n        if (this._sequence_timer) {\r\n          clearTimeout(this._sequence_timer);\r\n        }\r\n        if (this.sequence_delay > -1) {\r\n          this._sequence_timer = setTimeout(function() {\r\n            return this._sequence = [];\r\n          }, this.sequence_delay);\r\n        }\r\n      } else {\r\n        this._sequence = [];\r\n      }\r\n    };\r\n\r\n    Listener.prototype._get_sequence = function(key) {\r\n      var combo, i, j, match, seq_key, sequence, _i, _j, _k, _len, _ref, _ref1, _ref2;\r\n      _ref = this._registered_combos;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        combo = _ref[_i];\r\n        if (!combo.is_sequence) {\r\n          continue;\r\n        }\r\n        for (j = _j = 1, _ref1 = this._sequence.length; 1 <= _ref1 ? _j <= _ref1 : _j >= _ref1; j = 1 <= _ref1 ? ++_j : --_j) {\r\n          sequence = (_filter_array(this._sequence, function(seq_key) {\r\n            if (__indexOf.call(combo.keys, \"shift\") >= 0) {\r\n              return true;\r\n            }\r\n            return seq_key !== \"shift\";\r\n          })).slice(-j);\r\n          if (combo.keys.length !== sequence.length) {\r\n            continue;\r\n          }\r\n          for (i = _k = 0, _ref2 = sequence.length; 0 <= _ref2 ? _k < _ref2 : _k > _ref2; i = 0 <= _ref2 ? ++_k : --_k) {\r\n            seq_key = sequence[i];\r\n            if (__indexOf.call(combo.keys, \"shift\") < 0) {\r\n              if (seq_key === \"shift\") {\r\n                continue;\r\n              }\r\n            }\r\n            if (key === \"shift\" && __indexOf.call(combo.keys, \"shift\") < 0) {\r\n              continue;\r\n            }\r\n            if (combo.keys[i] === seq_key) {\r\n              match = true;\r\n            } else {\r\n              match = false;\r\n              break;\r\n            }\r\n          }\r\n        }\r\n        if (match) {\r\n          if (combo.is_exclusive) {\r\n            this._sequence = [];\r\n          }\r\n          return combo;\r\n        }\r\n      }\r\n      return false;\r\n    };\r\n\r\n    Listener.prototype._receive_input = function(e, is_keydown) {\r\n      var key, _ref;\r\n      if (this._prevent_capture) {\r\n        if (this._keys_down.length) {\r\n          this._keys_down = [];\r\n        }\r\n        return;\r\n      }\r\n      key = _convert_key_to_readable((_ref = e.keyCode) != null ? _ref : e.key);\r\n      if (!is_keydown && !this._keys_down.length && (key === \"alt\" || key === _metakey)) {\r\n        return;\r\n      }\r\n      if (!key) {\r\n        return;\r\n      }\r\n      if (is_keydown) {\r\n        return this._key_down(key, e);\r\n      } else {\r\n        return this._key_up(key, e);\r\n      }\r\n    };\r\n\r\n    Listener.prototype._fire = function(event, combo, key_event, is_autorepeat) {\r\n      if (typeof combo[\"on_\" + event] === \"function\") {\r\n        this._prevent_default(key_event, combo[\"on_\" + event].call(combo[\"this\"], key_event, combo.count, is_autorepeat) !== true);\r\n      }\r\n      if (event === \"release\") {\r\n        combo.count = 0;\r\n      }\r\n      if (event === \"keyup\") {\r\n        return combo.keyup_fired = true;\r\n      }\r\n    };\r\n\r\n    Listener.prototype._match_combo_arrays = function(potential_match, match_handler) {\r\n      var source_combo, _i, _len, _ref;\r\n      _ref = this._registered_combos;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        source_combo = _ref[_i];\r\n        if ((!source_combo.is_unordered && _compare_arrays_sorted(potential_match, source_combo.keys)) || (source_combo.is_unordered && _compare_arrays(potential_match, source_combo.keys))) {\r\n          match_handler(source_combo);\r\n        }\r\n      }\r\n    };\r\n\r\n    Listener.prototype._fuzzy_match_combo_arrays = function(potential_match, match_handler) {\r\n      var source_combo, _i, _len, _ref;\r\n      _ref = this._registered_combos;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        source_combo = _ref[_i];\r\n        if ((!source_combo.is_unordered && _is_array_in_array_sorted(source_combo.keys, potential_match)) || (source_combo.is_unordered && _is_array_in_array(source_combo.keys, potential_match))) {\r\n          match_handler(source_combo);\r\n        }\r\n      }\r\n    };\r\n\r\n    Listener.prototype._keys_remain = function(combo) {\r\n      var key, keys_remain, _i, _len, _ref;\r\n      _ref = combo.keys;\r\n      for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n        key = _ref[_i];\r\n        if (__indexOf.call(this._keys_down, key) >= 0) {\r\n          keys_remain = true;\r\n          break;\r\n        }\r\n      }\r\n      return keys_remain;\r\n    };\r\n\r\n    Listener.prototype._key_down = function(key, e) {\r\n      var combo, combos, event_mod, i, mod, potential, potential_combos, sequence_combo, shifted_key, _i, _j, _k, _len, _len1, _ref;\r\n      shifted_key = _convert_to_shifted_key(key, e);\r\n      if (shifted_key) {\r\n        key = shifted_key;\r\n      }\r\n      this._add_key_to_sequence(key, e);\r\n      sequence_combo = this._get_sequence(key);\r\n      if (sequence_combo) {\r\n        this._fire(\"keydown\", sequence_combo, e);\r\n      }\r\n      for (mod in _modifier_event_mapping) {\r\n        event_mod = _modifier_event_mapping[mod];\r\n        if (!e[event_mod]) {\r\n          continue;\r\n        }\r\n        if (mod === key || __indexOf.call(this._keys_down, mod) >= 0) {\r\n          continue;\r\n        }\r\n        this._keys_down.push(mod);\r\n      }\r\n      for (mod in _modifier_event_mapping) {\r\n        event_mod = _modifier_event_mapping[mod];\r\n        if (mod === key) {\r\n          continue;\r\n        }\r\n        if (__indexOf.call(this._keys_down, mod) >= 0 && !e[event_mod]) {\r\n          if (mod === \"cmd\" && _metakey !== \"cmd\") {\r\n            continue;\r\n          }\r\n          for (i = _i = 0, _ref = this._keys_down.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n            if (this._keys_down[i] === mod) {\r\n              this._keys_down.splice(i, 1);\r\n            }\r\n          }\r\n        }\r\n      }\r\n      combos = this._get_active_combos(key);\r\n      potential_combos = this._get_potential_combos(key);\r\n      for (_j = 0, _len = combos.length; _j < _len; _j++) {\r\n        combo = combos[_j];\r\n        this._handle_combo_down(combo, potential_combos, key, e);\r\n      }\r\n      if (potential_combos.length) {\r\n        for (_k = 0, _len1 = potential_combos.length; _k < _len1; _k++) {\r\n          potential = potential_combos[_k];\r\n          this._prevent_default(e, potential.prevent_default);\r\n        }\r\n      }\r\n      if (__indexOf.call(this._keys_down, key) < 0) {\r\n        this._keys_down.push(key);\r\n      }\r\n    };\r\n\r\n    Listener.prototype._handle_combo_down = function(combo, potential_combos, key, e) {\r\n      var is_autorepeat, is_other_exclusive, potential_combo, result, _i, _len;\r\n      if (__indexOf.call(combo.keys, key) < 0) {\r\n        return false;\r\n      }\r\n      this._prevent_default(e, combo && combo.prevent_default);\r\n      is_autorepeat = false;\r\n      if (__indexOf.call(this._keys_down, key) >= 0) {\r\n        is_autorepeat = true;\r\n        if (!combo.allows_key_repeat()) {\r\n          return false;\r\n        }\r\n      }\r\n      result = this._add_to_active_combos(combo, key);\r\n      combo.keyup_fired = false;\r\n      is_other_exclusive = false;\r\n      if (combo.is_exclusive) {\r\n        for (_i = 0, _len = potential_combos.length; _i < _len; _i++) {\r\n          potential_combo = potential_combos[_i];\r\n          if (potential_combo.is_exclusive && potential_combo.keys.length > combo.keys.length) {\r\n            is_other_exclusive = true;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      if (!is_other_exclusive) {\r\n        if (combo.is_counting && typeof combo.on_keydown === \"function\") {\r\n          combo.count += 1;\r\n        }\r\n        if (result) {\r\n          return this._fire(\"keydown\", combo, e, is_autorepeat);\r\n        }\r\n      }\r\n    };\r\n\r\n    Listener.prototype._key_up = function(key, e) {\r\n      var active_combo, active_combos_length, combo, combos, i, sequence_combo, shifted_key, unshifted_key, _i, _j, _k, _l, _len, _len1, _len2, _ref, _ref1, _ref2, _ref3;\r\n      unshifted_key = key;\r\n      shifted_key = _convert_to_shifted_key(key, e);\r\n      if (shifted_key) {\r\n        key = shifted_key;\r\n      }\r\n      shifted_key = _keycode_shifted_keys[unshifted_key];\r\n      if (e.shiftKey) {\r\n        if (!(shifted_key && __indexOf.call(this._keys_down, shifted_key) >= 0)) {\r\n          key = unshifted_key;\r\n        }\r\n      } else {\r\n        if (!(unshifted_key && __indexOf.call(this._keys_down, unshifted_key) >= 0)) {\r\n          key = shifted_key;\r\n        }\r\n      }\r\n      sequence_combo = this._get_sequence(key);\r\n      if (sequence_combo) {\r\n        this._fire(\"keyup\", sequence_combo, e);\r\n      }\r\n      if (__indexOf.call(this._keys_down, key) < 0) {\r\n        return false;\r\n      }\r\n      for (i = _i = 0, _ref = this._keys_down.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n        if ((_ref1 = this._keys_down[i]) === key || _ref1 === shifted_key || _ref1 === unshifted_key) {\r\n          this._keys_down.splice(i, 1);\r\n          break;\r\n        }\r\n      }\r\n      active_combos_length = this._active_combos.length;\r\n      combos = [];\r\n      _ref2 = this._active_combos;\r\n      for (_j = 0, _len = _ref2.length; _j < _len; _j++) {\r\n        active_combo = _ref2[_j];\r\n        if (__indexOf.call(active_combo.keys, key) >= 0) {\r\n          combos.push(active_combo);\r\n        }\r\n      }\r\n      for (_k = 0, _len1 = combos.length; _k < _len1; _k++) {\r\n        combo = combos[_k];\r\n        this._handle_combo_up(combo, e, key);\r\n      }\r\n      if (active_combos_length > 1) {\r\n        _ref3 = this._active_combos;\r\n        for (_l = 0, _len2 = _ref3.length; _l < _len2; _l++) {\r\n          active_combo = _ref3[_l];\r\n          if (active_combo === void 0 || __indexOf.call(combos, active_combo) >= 0) {\r\n            continue;\r\n          }\r\n          if (!this._keys_remain(active_combo)) {\r\n            this._remove_from_active_combos(active_combo);\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n    Listener.prototype._handle_combo_up = function(combo, e, key) {\r\n      var keys_down, keys_remaining;\r\n      this._prevent_default(e, combo && combo.prevent_default);\r\n      keys_remaining = this._keys_remain(combo);\r\n      if (!combo.keyup_fired) {\r\n        keys_down = this._keys_down.slice();\r\n        keys_down.push(key);\r\n        if (!combo.is_solitary || _compare_arrays(keys_down, combo.keys)) {\r\n          this._fire(\"keyup\", combo, e);\r\n          if (combo.is_counting && typeof combo.on_keyup === \"function\" && typeof combo.on_keydown !== \"function\") {\r\n            combo.count += 1;\r\n          }\r\n        }\r\n      }\r\n      if (!keys_remaining) {\r\n        this._fire(\"release\", combo, e);\r\n        this._remove_from_active_combos(combo);\r\n      }\r\n    };\r\n\r\n    Listener.prototype.simple_combo = function(keys, callback) {\r\n      return this.register_combo({\r\n        keys: keys,\r\n        on_keydown: callback\r\n      });\r\n    };\r\n\r\n    Listener.prototype.counting_combo = function(keys, count_callback) {\r\n      return this.register_combo({\r\n        keys: keys,\r\n        is_counting: true,\r\n        is_unordered: false,\r\n        on_keydown: count_callback\r\n      });\r\n    };\r\n\r\n    Listener.prototype.sequence_combo = function(keys, callback) {\r\n      return this.register_combo({\r\n        keys: keys,\r\n        on_keydown: callback,\r\n        is_sequence: true,\r\n        is_exclusive: true\r\n      });\r\n    };\r\n\r\n    Listener.prototype.register_combo = function(combo_dictionary) {\r\n      var combo, property, value, _ref;\r\n      if (typeof combo_dictionary[\"keys\"] === \"string\") {\r\n        combo_dictionary[\"keys\"] = combo_dictionary[\"keys\"].split(\" \");\r\n      }\r\n      _ref = this._defaults;\r\n      for (property in _ref) {\r\n        if (!__hasProp.call(_ref, property)) continue;\r\n        value = _ref[property];\r\n        if (combo_dictionary[property] === void 0) {\r\n          combo_dictionary[property] = value;\r\n        }\r\n      }\r\n      combo = new Combo(combo_dictionary);\r\n      if (_validate_combo(combo)) {\r\n        this._registered_combos.push(combo);\r\n        return combo;\r\n      }\r\n    };\r\n\r\n    Listener.prototype.register_many = function(combo_array) {\r\n      var combo, _i, _len, _results;\r\n      _results = [];\r\n      for (_i = 0, _len = combo_array.length; _i < _len; _i++) {\r\n        combo = combo_array[_i];\r\n        _results.push(this.register_combo(combo));\r\n      }\r\n      return _results;\r\n    };\r\n\r\n    Listener.prototype.unregister_combo = function(keys_or_combo) {\r\n      var combo, unregister_combo, _i, _len, _ref, _results;\r\n      if (!keys_or_combo) {\r\n        return false;\r\n      }\r\n      unregister_combo = (function(_this) {\r\n        return function(combo) {\r\n          var i, _i, _ref, _results;\r\n          _results = [];\r\n          for (i = _i = 0, _ref = _this._registered_combos.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n            if (combo === _this._registered_combos[i]) {\r\n              _this._registered_combos.splice(i, 1);\r\n              break;\r\n            } else {\r\n              _results.push(void 0);\r\n            }\r\n          }\r\n          return _results;\r\n        };\r\n      })(this);\r\n      if (keys_or_combo instanceof Combo) {\r\n        return unregister_combo(keys_or_combo);\r\n      } else {\r\n        if (typeof keys_or_combo === \"string\") {\r\n          keys_or_combo = keys_or_combo.split(\" \");\r\n        }\r\n        _ref = this._registered_combos;\r\n        _results = [];\r\n        for (_i = 0, _len = _ref.length; _i < _len; _i++) {\r\n          combo = _ref[_i];\r\n          if (combo == null) {\r\n            continue;\r\n          }\r\n          if ((combo.is_unordered && _compare_arrays(keys_or_combo, combo.keys)) || (!combo.is_unordered && _compare_arrays_sorted(keys_or_combo, combo.keys))) {\r\n            _results.push(unregister_combo(combo));\r\n          } else {\r\n            _results.push(void 0);\r\n          }\r\n        }\r\n        return _results;\r\n      }\r\n    };\r\n\r\n    Listener.prototype.unregister_many = function(combo_array) {\r\n      var combo, _i, _len, _results;\r\n      _results = [];\r\n      for (_i = 0, _len = combo_array.length; _i < _len; _i++) {\r\n        combo = combo_array[_i];\r\n        _results.push(this.unregister_combo(combo));\r\n      }\r\n      return _results;\r\n    };\r\n\r\n    Listener.prototype.get_registered_combos = function() {\r\n      return this._registered_combos;\r\n    };\r\n\r\n    Listener.prototype.reset = function() {\r\n      return this._registered_combos = [];\r\n    };\r\n\r\n    Listener.prototype.listen = function() {\r\n      return this._prevent_capture = false;\r\n    };\r\n\r\n    Listener.prototype.stop_listening = function() {\r\n      return this._prevent_capture = true;\r\n    };\r\n\r\n    Listener.prototype.get_meta_key = function() {\r\n      return _metakey;\r\n    };\r\n\r\n    return Listener;\r\n\r\n  })();\r\n\r\n  _decide_meta_key = function() {\r\n    if (navigator.userAgent.indexOf(\"Mac OS X\") !== -1) {\r\n      _metakey = \"cmd\";\r\n    }\r\n  };\r\n\r\n  _change_keycodes_by_browser = function() {\r\n    if (navigator.userAgent.indexOf(\"Opera\") !== -1) {\r\n      _keycode_dictionary[\"17\"] = \"cmd\";\r\n    }\r\n  };\r\n\r\n  _convert_key_to_readable = function(k) {\r\n    return _keycode_dictionary[k];\r\n  };\r\n\r\n  _filter_array = function(array, callback) {\r\n    var element;\r\n    if (array.filter) {\r\n      return array.filter(callback);\r\n    } else {\r\n      return (function() {\r\n        var _i, _len, _results;\r\n        _results = [];\r\n        for (_i = 0, _len = array.length; _i < _len; _i++) {\r\n          element = array[_i];\r\n          if (callback(element)) {\r\n            _results.push(element);\r\n          }\r\n        }\r\n        return _results;\r\n      })();\r\n    }\r\n  };\r\n\r\n  _compare_arrays = function(a1, a2) {\r\n    var item, _i, _len;\r\n    if (a1.length !== a2.length) {\r\n      return false;\r\n    }\r\n    for (_i = 0, _len = a1.length; _i < _len; _i++) {\r\n      item = a1[_i];\r\n      if (__indexOf.call(a2, item) >= 0) {\r\n        continue;\r\n      }\r\n      return false;\r\n    }\r\n    return true;\r\n  };\r\n\r\n  _compare_arrays_sorted = function(a1, a2) {\r\n    var i, _i, _ref;\r\n    if (a1.length !== a2.length) {\r\n      return false;\r\n    }\r\n    for (i = _i = 0, _ref = a1.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n      if (a1[i] !== a2[i]) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n\r\n  _is_array_in_array = function(a1, a2) {\r\n    var item, _i, _len;\r\n    for (_i = 0, _len = a1.length; _i < _len; _i++) {\r\n      item = a1[_i];\r\n      if (__indexOf.call(a2, item) < 0) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n\r\n  _index_of_in_array = Array.prototype.indexOf || function(a, item) {\r\n    var i, _i, _ref;\r\n    for (i = _i = 0, _ref = a.length; 0 <= _ref ? _i <= _ref : _i >= _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n      if (a[i] === item) {\r\n        return i;\r\n      }\r\n    }\r\n    return -1;\r\n  };\r\n\r\n  _is_array_in_array_sorted = function(a1, a2) {\r\n    var index, item, prev, _i, _len;\r\n    prev = 0;\r\n    for (_i = 0, _len = a1.length; _i < _len; _i++) {\r\n      item = a1[_i];\r\n      index = _index_of_in_array.call(a2, item);\r\n      if (index >= prev) {\r\n        prev = index;\r\n      } else {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  };\r\n\r\n  _log_error = function() {\r\n    if (keypress.debug) {\r\n      return console.log.apply(console, arguments);\r\n    }\r\n  };\r\n\r\n  _key_is_valid = function(key) {\r\n    var valid, valid_key, _;\r\n    valid = false;\r\n    for (_ in _keycode_dictionary) {\r\n      valid_key = _keycode_dictionary[_];\r\n      if (key === valid_key) {\r\n        valid = true;\r\n        break;\r\n      }\r\n    }\r\n    if (!valid) {\r\n      for (_ in _keycode_shifted_keys) {\r\n        valid_key = _keycode_shifted_keys[_];\r\n        if (key === valid_key) {\r\n          valid = true;\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    return valid;\r\n  };\r\n\r\n  _validate_combo = function(combo) {\r\n    var alt_name, i, key, mod_key, non_modifier_keys, property, validated, value, _i, _j, _k, _len, _len1, _ref, _ref1;\r\n    validated = true;\r\n    if (!combo.keys.length) {\r\n      _log_error(\"You're trying to bind a combo with no keys:\", combo);\r\n    }\r\n    for (i = _i = 0, _ref = combo.keys.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {\r\n      key = combo.keys[i];\r\n      alt_name = _keycode_alternate_names[key];\r\n      if (alt_name) {\r\n        key = combo.keys[i] = alt_name;\r\n      }\r\n      if (key === \"meta\") {\r\n        combo.keys.splice(i, 1, _metakey);\r\n      }\r\n      if (key === \"cmd\") {\r\n        _log_error(\"Warning: use the \\\"meta\\\" key rather than \\\"cmd\\\" for Windows compatibility\");\r\n      }\r\n    }\r\n    _ref1 = combo.keys;\r\n    for (_j = 0, _len = _ref1.length; _j < _len; _j++) {\r\n      key = _ref1[_j];\r\n      if (!_key_is_valid(key)) {\r\n        _log_error(\"Do not recognize the key \\\"\" + key + \"\\\"\");\r\n        validated = false;\r\n      }\r\n    }\r\n    if (__indexOf.call(combo.keys, \"meta\") >= 0 || __indexOf.call(combo.keys, \"cmd\") >= 0) {\r\n      non_modifier_keys = combo.keys.slice();\r\n      for (_k = 0, _len1 = _modifier_keys.length; _k < _len1; _k++) {\r\n        mod_key = _modifier_keys[_k];\r\n        if ((i = _index_of_in_array.call(non_modifier_keys, mod_key)) > -1) {\r\n          non_modifier_keys.splice(i, 1);\r\n        }\r\n      }\r\n      if (non_modifier_keys.length > 1) {\r\n        _log_error(\"META and CMD key combos cannot have more than 1 non-modifier keys\", combo, non_modifier_keys);\r\n        validated = false;\r\n      }\r\n    }\r\n    for (property in combo) {\r\n      value = combo[property];\r\n      if (_factory_defaults[property] === \"undefined\") {\r\n        _log_error(\"The property \" + property + \" is not a valid combo property. Your combo has still been registered.\");\r\n      }\r\n    }\r\n    return validated;\r\n  };\r\n\r\n  _convert_to_shifted_key = function(key, e) {\r\n    var k;\r\n    if (!e.shiftKey) {\r\n      return false;\r\n    }\r\n    k = _keycode_shifted_keys[key];\r\n    if (k != null) {\r\n      return k;\r\n    }\r\n    return false;\r\n  };\r\n\r\n  _modifier_event_mapping = {\r\n    \"cmd\": \"metaKey\",\r\n    \"ctrl\": \"ctrlKey\",\r\n    \"shift\": \"shiftKey\",\r\n    \"alt\": \"altKey\"\r\n  };\r\n\r\n  _keycode_alternate_names = {\r\n    \"escape\": \"esc\",\r\n    \"control\": \"ctrl\",\r\n    \"command\": \"cmd\",\r\n    \"break\": \"pause\",\r\n    \"windows\": \"cmd\",\r\n    \"option\": \"alt\",\r\n    \"caps_lock\": \"caps\",\r\n    \"apostrophe\": \"\\'\",\r\n    \"semicolon\": \";\",\r\n    \"tilde\": \"~\",\r\n    \"accent\": \"`\",\r\n    \"scroll_lock\": \"scroll\",\r\n    \"num_lock\": \"num\"\r\n  };\r\n\r\n  _keycode_shifted_keys = {\r\n    \"/\": \"?\",\r\n    \".\": \">\",\r\n    \",\": \"<\",\r\n    \"\\'\": \"\\\"\",\r\n    \";\": \":\",\r\n    \"[\": \"{\",\r\n    \"]\": \"}\",\r\n    \"\\\\\": \"|\",\r\n    \"`\": \"~\",\r\n    \"=\": \"+\",\r\n    \"-\": \"_\",\r\n    \"1\": \"!\",\r\n    \"2\": \"@\",\r\n    \"3\": \"#\",\r\n    \"4\": \"$\",\r\n    \"5\": \"%\",\r\n    \"6\": \"^\",\r\n    \"7\": \"&\",\r\n    \"8\": \"*\",\r\n    \"9\": \"(\",\r\n    \"0\": \")\"\r\n  };\r\n\r\n  _keycode_dictionary = {\r\n    0: \"\\\\\",\r\n    8: \"backspace\",\r\n    9: \"tab\",\r\n    12: \"num\",\r\n    13: \"enter\",\r\n    16: \"shift\",\r\n    17: \"ctrl\",\r\n    18: \"alt\",\r\n    19: \"pause\",\r\n    20: \"caps\",\r\n    27: \"esc\",\r\n    32: \"space\",\r\n    33: \"pageup\",\r\n    34: \"pagedown\",\r\n    35: \"end\",\r\n    36: \"home\",\r\n    37: \"left\",\r\n    38: \"up\",\r\n    39: \"right\",\r\n    40: \"down\",\r\n    44: \"print\",\r\n    45: \"insert\",\r\n    46: \"delete\",\r\n    48: \"0\",\r\n    49: \"1\",\r\n    50: \"2\",\r\n    51: \"3\",\r\n    52: \"4\",\r\n    53: \"5\",\r\n    54: \"6\",\r\n    55: \"7\",\r\n    56: \"8\",\r\n    57: \"9\",\r\n    65: \"a\",\r\n    66: \"b\",\r\n    67: \"c\",\r\n    68: \"d\",\r\n    69: \"e\",\r\n    70: \"f\",\r\n    71: \"g\",\r\n    72: \"h\",\r\n    73: \"i\",\r\n    74: \"j\",\r\n    75: \"k\",\r\n    76: \"l\",\r\n    77: \"m\",\r\n    78: \"n\",\r\n    79: \"o\",\r\n    80: \"p\",\r\n    81: \"q\",\r\n    82: \"r\",\r\n    83: \"s\",\r\n    84: \"t\",\r\n    85: \"u\",\r\n    86: \"v\",\r\n    87: \"w\",\r\n    88: \"x\",\r\n    89: \"y\",\r\n    90: \"z\",\r\n    91: \"cmd\",\r\n    92: \"cmd\",\r\n    93: \"cmd\",\r\n    96: \"num_0\",\r\n    97: \"num_1\",\r\n    98: \"num_2\",\r\n    99: \"num_3\",\r\n    100: \"num_4\",\r\n    101: \"num_5\",\r\n    102: \"num_6\",\r\n    103: \"num_7\",\r\n    104: \"num_8\",\r\n    105: \"num_9\",\r\n    106: \"num_multiply\",\r\n    107: \"num_add\",\r\n    108: \"num_enter\",\r\n    109: \"num_subtract\",\r\n    110: \"num_decimal\",\r\n    111: \"num_divide\",\r\n    112: \"f1\",\r\n    113: \"f2\",\r\n    114: \"f3\",\r\n    115: \"f4\",\r\n    116: \"f5\",\r\n    117: \"f6\",\r\n    118: \"f7\",\r\n    119: \"f8\",\r\n    120: \"f9\",\r\n    121: \"f10\",\r\n    122: \"f11\",\r\n    123: \"f12\",\r\n    124: \"print\",\r\n    144: \"num\",\r\n    145: \"scroll\",\r\n    186: \";\",\r\n    187: \"=\",\r\n    188: \",\",\r\n    189: \"-\",\r\n    190: \".\",\r\n    191: \"/\",\r\n    192: \"`\",\r\n    219: \"[\",\r\n    220: \"\\\\\",\r\n    221: \"]\",\r\n    222: \"\\'\",\r\n    223: \"`\",\r\n    224: \"cmd\",\r\n    225: \"alt\",\r\n    57392: \"ctrl\",\r\n    63289: \"num\",\r\n    59: \";\",\r\n    61: \"=\",\r\n    173: \"-\"\r\n  };\r\n\r\n  keypress._keycode_dictionary = _keycode_dictionary;\r\n\r\n  keypress._is_array_in_array_sorted = _is_array_in_array_sorted;\r\n\r\n  _decide_meta_key();\r\n\r\n  _change_keycodes_by_browser();\r\n\r\n  if (typeof define === \"function\" && define.amd) {\r\n    define([], function() {\r\n      return keypress;\r\n    });\r\n  } else if (typeof exports !== \"undefined\" && exports !== null) {\r\n    exports.keypress = keypress;\r\n  } else {\r\n    window.keypress = keypress;\r\n  }\r\n\r\n}).call(this);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/min-dependencies/lib/keypress.js","class Quality {\r\n    constructor(callback){\r\n        this.testCallback = callback;\r\n    }\r\n\r\n    Common(quality){\r\n        //                      0       1       2       3\r\n        var composer        = [ 0,      0,      0,      1       ];\r\n        var antialias       = [ 0,      1,      1,      0       ];\r\n        var shadows         = [ 0,      0,      1,      1       ];\r\n        var renderSizeMul   = [ .5,     1,      1,      1       ];\r\n        \r\n        var result = {\r\n            composer: Boolean(composer[quality]), \r\n            antialias: Boolean(antialias[quality]),\r\n            shadows: Boolean(shadows[quality]),\r\n            renderSizeMul: renderSizeMul[quality]\r\n        };\r\n        return result;\r\n    }\r\n\r\n    OnTestComplete(quality){\r\n        var result = this.Common(quality);\r\n        this.testCallback(result);\r\n    }\r\n\r\n    PerformanceTest1(){\r\n        var quality = 2;\r\n        // Test webgl supported shader precision, see WebGLRenderer, https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API/WebGL_best_practices\r\n        this.OnTestComplete(quality);\r\n    }\r\n\r\n}\r\n\r\nexport default Quality;\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/Quality.js","import Utils from \"../utils/cik/Utils\";\r\n\r\n/**\r\n * @typedef RendererParams\r\n * @property {Boolean} antialias\r\n * @property {Boolean} shadows\r\n * @property {Boolean} shadowsAutoUpdate\r\n * @property {Number} clearColor - hex color 0xff7f00\r\n * @property {Number} renderSizeMul\r\n * @property {Boolean} composer\r\n */\r\n\r\n/** @type {RendererParams} */\r\nconst defaultParams = {\r\n    antialias: true,\r\n    shadows: true,\r\n    shadowMapType: THREE.PCFSoftShadowMap,\r\n    shadowsAutoUpdate: true,\r\n    clearColor: 0xcfcfcf,\r\n    renderSizeMul: 1,\r\n    composer: false\r\n};\r\n\r\nclass Renderer {\r\n    /**\r\n     * @param {RendererParams} params \r\n     */\r\n    constructor(params) {\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n        this.renderer = new THREE.WebGLRenderer({antialias: this.params.antialias});\r\n\r\n        this.renderer.shadowMap.enabled = this.params.shadows;\r\n        this.renderer.shadowMap.type = this.params.shadowMapType;\r\n        this.renderer.shadowMap.autoUpdate = this.params.shadowsAutoUpdate;\r\n\r\n        this.renderer.physicallyCorrectLights = true;\r\n        this.renderer.gammaInput = true;\r\n        this.renderer.gammaOutput = true;\r\n        this.renderer.toneMapping = THREE.Uncharted2ToneMapping;\r\n        this.renderer.toneMappingExposure = 1.4;\r\n        //this.renderer.toneMappingExposure = ;\r\n        \r\n        this.maxTextureSize = this.renderer.context.getParameter(this.renderer.context.MAX_TEXTURE_SIZE);\r\n        this.pixelRatio = window.devicePixelRatio !== undefined ? window.devicePixelRatio : 1;\r\n        this.renderer.setPixelRatio(this.pixelRatio);\r\n        this.renderer.setClearColor(new THREE.Color(this.params.clearColor), 1);\r\n\r\n        this.ResizeRenderer = function(screen){\r\n            var newWidth = screen.width * this.params.renderSizeMul;\r\n            var newHeight = screen.height * this.params.renderSizeMul;\r\n            this.renderer.setSize(newWidth, newHeight);\r\n        };\r\n\r\n        this.Render = function(scene, camera){\r\n            this.renderer.render(scene, camera);\r\n        };\r\n        \r\n        this.UpdateShadowMaps = function(){\r\n            this.renderer.shadowMap.needsUpdate = true;\r\n        };\r\n\r\n        this.ResizeDomElement = function(screen){\r\n            this.renderer.domElement.style.width = Math.floor(screen.width) + 'px';\r\n            this.renderer.domElement.style.height = Math.floor(screen.height) + 'px';\r\n        };\r\n\r\n        this.AdjustCamera = function(screen, camera){\r\n            camera.aspect = screen.width / screen.height;\r\n            camera.updateProjectionMatrix();\r\n        };\r\n\r\n        this.ReconfigureViewport = function(screen, camera){\r\n            this.AdjustCamera(screen, camera);\r\n\r\n            this.ResizeRenderer(screen);\r\n            this.ResizeDomElement(screen);\r\n        };\r\n\r\n        if(this.params.composer){\r\n            Renderer.UseComposer(this);\r\n        }\r\n    }\r\n\r\n    Dispose(){\r\n        this.renderer.dispose();\r\n    }\r\n\r\n    static UseComposer (sceneRenderer){\r\n        sceneRenderer.composer = new THREE.EffectComposer(sceneRenderer.renderer);\r\n        sceneRenderer.renderPass = new THREE.RenderPass(undefined, undefined);\r\n        sceneRenderer.renderPass.renderToScreen = true;\r\n        sceneRenderer.composer.addPass(sceneRenderer.renderPass);\r\n        sceneRenderer.renderPasses = [sceneRenderer.renderPass];\r\n\r\n        sceneRenderer.UseCamera = function(camera){\r\n            sceneRenderer.camera = camera;\r\n            sceneRenderer.renderPass.camera = camera;\r\n        };\r\n\r\n        sceneRenderer.ResizeRenderer = function(screen){\r\n            var newWidth = screen.width * sceneRenderer.params.renderSizeMul;\r\n            var newHeight = screen.height * sceneRenderer.params.renderSizeMul;\r\n            sceneRenderer.renderer.setSize(newWidth, newHeight);\r\n\r\n            newWidth  = Math.floor( newWidth / sceneRenderer.pixelRatio ) || 1;\r\n\t\t\tnewHeight = Math.floor( newWidth / sceneRenderer.pixelRatio ) || 1;\r\n\t\t\tsceneRenderer.composer.setSize( newWidth, newHeight );\r\n        };\r\n\r\n        sceneRenderer.Render = function(scene){\r\n            sceneRenderer.renderPass.scene = scene;\r\n            sceneRenderer.composer.render();\r\n        };\r\n    }\r\n}\r\n\r\nexport default Renderer;\n\n\n// WEBPACK FOOTER //\n// ./src/api/scene/Renderer.js","/**\r\n * @author qiao / https://github.com/qiao\r\n * @author mrdoob / http://mrdoob.com\r\n * @author alteredq / http://alteredqualia.com/\r\n * @author WestLangley / http://github.com/WestLangley\r\n * @author erich666 / http://erichaines.com\r\n */\r\n\r\n// This set of controls performs orbiting, dollying (zooming), and panning.\r\n// Unlike TrackballControls, it maintains the \"up\" direction object.up (+Y by default).\r\n//\r\n//    Orbit - left mouse / touch: one finger move\r\n//    Zoom - middle mouse, or mousewheel / touch: two finger spread or squish\r\n//    Pan - right mouse, or arrow keys / touch: three finger swipe\r\n\r\nTHREE.OrbitControls = function ( object, domElement ) {\r\n\r\n\tthis.object = object;\r\n\r\n\tthis.domElement = ( domElement !== undefined ) ? domElement : document;\r\n\r\n\t// Set to false to disable this control\r\n\tthis.enabled = true;\r\n\r\n\t// Rect areas that are ignored\r\n\tthis.ignoredAreas = [];\r\n\r\n\t// \"target\" sets the location of focus, where the object orbits around\r\n\tthis.target = new THREE.Vector3();\r\n\r\n\t// How far you can dolly in and out ( PerspectiveCamera only )\r\n\tthis.minDistance = 0;\r\n\tthis.maxDistance = Infinity;\r\n\r\n\t// How far you can zoom in and out ( OrthographicCamera only )\r\n\tthis.minZoom = 0;\r\n\tthis.maxZoom = Infinity;\r\n\r\n\t// How far you can orbit vertically, upper and lower limits.\r\n\t// Range is 0 to Math.PI radians.\r\n\tthis.minPolarAngle = 0; // radians\r\n\tthis.maxPolarAngle = Math.PI; // radians\r\n\r\n\t// How far you can orbit horizontally, upper and lower limits.\r\n\t// If set, must be a sub-interval of the interval [ - Math.PI, Math.PI ].\r\n\tthis.minAzimuthAngle = - Infinity; // radians\r\n\tthis.maxAzimuthAngle = Infinity; // radians\r\n\r\n\t// Set to true to enable damping (inertia)\r\n\t// If damping is enabled, you must call controls.update() in your animation loop\r\n\tthis.enableDamping = false;\r\n\tthis.dampingFactor = 0.25;\r\n\r\n\t// This option actually enables dollying in and out; left as \"zoom\" for backwards compatibility.\r\n\t// Set to false to disable zooming\r\n\tthis.enableZoom = true;\r\n\tthis.zoomSpeed = 1.0;\r\n\r\n\t// Set to false to disable rotating\r\n\tthis.enableRotate = true;\r\n\tthis.rotateSpeed = 1.0;\r\n\r\n\t// Set to false to disable panning\r\n\tthis.enablePan = true;\r\n\tthis.panningMode = THREE.ScreenSpacePanning; // alternate THREE.HorizontalPanning\r\n\tthis.keyPanSpeed = 7.0;\t// pixels moved per arrow key push\r\n\r\n\t// Set to true to automatically rotate around the target\r\n\t// If auto-rotate is enabled, you must call controls.update() in your animation loop\r\n\tthis.autoRotate = false;\r\n\tthis.autoRotateSpeed = 2.0; // 30 seconds per round when fps is 60\r\n\r\n\t// Set to false to disable use of the keys\r\n\tthis.enableKeys = true;\r\n\r\n\t// The four arrow keys\r\n\tthis.keys = { LEFT: 37, UP: 38, RIGHT: 39, BOTTOM: 40 };\r\n\r\n\t// Mouse buttons\r\n\tthis.mouseButtons = { ORBIT: THREE.MOUSE.LEFT, ZOOM: THREE.MOUSE.MIDDLE, PAN: THREE.MOUSE.RIGHT };\r\n\r\n\t// for reset\r\n\tthis.target0 = this.target.clone();\r\n\tthis.position0 = this.object.position.clone();\r\n\tthis.zoom0 = this.object.zoom;\r\n\r\n\t//\r\n\t// public methods\r\n\t//\r\n\r\n\tthis.getPolarAngle = function () {\r\n\r\n\t\treturn spherical.phi;\r\n\r\n\t};\r\n\r\n\tthis.getAzimuthalAngle = function () {\r\n\r\n\t\treturn spherical.theta;\r\n\r\n\t};\r\n\r\n\tthis.saveState = function () {\r\n\r\n\t\tscope.target0.copy( scope.target );\r\n\t\tscope.position0.copy( scope.object.position );\r\n\t\tscope.zoom0 = scope.object.zoom;\r\n\r\n\t};\r\n\r\n\tthis.reset = function () {\r\n\r\n\t\tscope.target.copy( scope.target0 );\r\n\t\tscope.object.position.copy( scope.position0 );\r\n\t\tscope.object.zoom = scope.zoom0;\r\n\r\n\t\tscope.object.updateProjectionMatrix();\r\n\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\tscope.update();\r\n\r\n\t\tstate = STATE.NONE;\r\n\r\n\t};\r\n\r\n\t// this method is exposed, but perhaps it would be better if we can make it private...\r\n\tthis.update = function () {\r\n\r\n\t\tvar offset = new THREE.Vector3();\r\n\r\n\t\t// so camera.up is the orbit axis\r\n\t\tvar quat = new THREE.Quaternion().setFromUnitVectors( object.up, new THREE.Vector3( 0, 1, 0 ) );\r\n\t\tvar quatInverse = quat.clone().inverse();\r\n\r\n\t\tvar lastPosition = new THREE.Vector3();\r\n\t\tvar lastQuaternion = new THREE.Quaternion();\r\n\r\n\t\treturn function update() {\r\n\r\n\t\t\tvar position = scope.object.position;\r\n\r\n\t\t\toffset.copy( position ).sub( scope.target );\r\n\r\n\t\t\t// rotate offset to \"y-axis-is-up\" space\r\n\t\t\toffset.applyQuaternion( quat );\r\n\r\n\t\t\t// angle from z-axis around y-axis\r\n\t\t\tspherical.setFromVector3( offset );\r\n\r\n\t\t\tif ( scope.autoRotate && state === STATE.NONE ) {\r\n\r\n\t\t\t\trotateLeft( getAutoRotationAngle() );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tspherical.theta += sphericalDelta.theta;\r\n\t\t\tspherical.phi += sphericalDelta.phi;\r\n\r\n\t\t\t// restrict theta to be between desired limits\r\n\t\t\tspherical.theta = Math.max( scope.minAzimuthAngle, Math.min( scope.maxAzimuthAngle, spherical.theta ) );\r\n\r\n\t\t\t// restrict phi to be between desired limits\r\n\t\t\tspherical.phi = Math.max( scope.minPolarAngle, Math.min( scope.maxPolarAngle, spherical.phi ) );\r\n\r\n\t\t\tspherical.makeSafe();\r\n\r\n\r\n\t\t\tspherical.radius *= scale;\r\n\r\n\t\t\t// restrict radius to be between desired limits\r\n\t\t\tspherical.radius = Math.max( scope.minDistance, Math.min( scope.maxDistance, spherical.radius ) );\r\n\r\n\t\t\t// move target to panned location\r\n\t\t\tscope.target.add( panOffset );\r\n\r\n\t\t\toffset.setFromSpherical( spherical );\r\n\r\n\t\t\t// rotate offset back to \"camera-up-vector-is-up\" space\r\n\t\t\toffset.applyQuaternion( quatInverse );\r\n\r\n\t\t\tposition.copy( scope.target ).add( offset );\r\n\r\n\t\t\tscope.object.lookAt( scope.target );\r\n\r\n\t\t\tif ( scope.enableDamping === true ) {\r\n\r\n\t\t\t\tsphericalDelta.theta *= ( 1 - scope.dampingFactor );\r\n\t\t\t\tsphericalDelta.phi *= ( 1 - scope.dampingFactor );\r\n\r\n\t\t\t\tpanOffset.multiplyScalar( 1 - scope.dampingFactor );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tsphericalDelta.set( 0, 0, 0 );\r\n\r\n\t\t\t\tpanOffset.set( 0, 0, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscale = 1;\r\n\r\n\t\t\t// update condition is:\r\n\t\t\t// min(camera displacement, camera rotation in radians)^2 > EPS\r\n\t\t\t// using small-angle approximation cos(x/2) = 1 - x^2 / 8\r\n\r\n\t\t\tif ( zoomChanged ||\r\n\t\t\t\tlastPosition.distanceToSquared( scope.object.position ) > EPS ||\r\n\t\t\t\t8 * ( 1 - lastQuaternion.dot( scope.object.quaternion ) ) > EPS ) {\r\n\r\n\t\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t\t\tlastPosition.copy( scope.object.position );\r\n\t\t\t\tlastQuaternion.copy( scope.object.quaternion );\r\n\t\t\t\tzoomChanged = false;\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\tthis.dispose = function () {\r\n\r\n\t\tscope.domElement.removeEventListener( 'contextmenu', onContextMenu, false );\r\n\t\tscope.domElement.removeEventListener( 'mousedown', onMouseDown, false );\r\n\t\tscope.domElement.removeEventListener( 'wheel', onMouseWheel, false );\r\n\r\n\t\tscope.domElement.removeEventListener( 'touchstart', onTouchStart, false );\r\n\t\tscope.domElement.removeEventListener( 'touchend', onTouchEnd, false );\r\n\t\tscope.domElement.removeEventListener( 'touchmove', onTouchMove, false );\r\n\r\n\t\tscope.domElement.removeEventListener( 'mousemove', onMouseMove, false );\r\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t\twindow.removeEventListener( 'keydown', onKeyDown, false );\r\n\r\n\t\t//scope.dispatchEvent( { type: 'dispose' } ); // should this be added here?\r\n\r\n\t};\r\n\r\n\t//\r\n\t// internals\r\n\t//\r\n\r\n\tvar scope = this;\r\n\r\n\tvar changeEvent = { type: 'change' };\r\n\tvar startEvent = { type: 'start' };\r\n\tvar endEvent = { type: 'end' };\r\n\r\n\tvar STATE = { NONE: - 1, ROTATE: 0, DOLLY: 1, PAN: 2, TOUCH_ROTATE: 3, TOUCH_DOLLY: 4, TOUCH_PAN: 5 };\r\n\r\n\tvar state = STATE.NONE;\r\n\r\n\tvar EPS = 0.000001;\r\n\r\n\t// current position in spherical coordinates\r\n\tvar spherical = new THREE.Spherical();\r\n\tvar sphericalDelta = new THREE.Spherical();\r\n\r\n\tvar scale = 1;\r\n\tvar panOffset = new THREE.Vector3();\r\n\tvar zoomChanged = false;\r\n\r\n\tvar rotateStart = new THREE.Vector2();\r\n\tvar rotateEnd = new THREE.Vector2();\r\n\tvar rotateDelta = new THREE.Vector2();\r\n\r\n\tvar panStart = new THREE.Vector2();\r\n\tvar panEnd = new THREE.Vector2();\r\n\tvar panDelta = new THREE.Vector2();\r\n\r\n\tvar dollyStart = new THREE.Vector2();\r\n\tvar dollyEnd = new THREE.Vector2();\r\n\tvar dollyDelta = new THREE.Vector2();\r\n\r\n\tfunction getAutoRotationAngle() {\r\n\r\n\t\treturn 2 * Math.PI / 60 / 60 * scope.autoRotateSpeed;\r\n\r\n\t}\r\n\r\n\tfunction getZoomScale() {\r\n\r\n\t\treturn Math.pow( 0.95, scope.zoomSpeed );\r\n\r\n\t}\r\n\r\n\tfunction rotateLeft( angle ) {\r\n\r\n\t\tsphericalDelta.theta -= angle;\r\n\r\n\t}\r\n\r\n\tfunction rotateUp( angle ) {\r\n\r\n\t\tsphericalDelta.phi -= angle;\r\n\r\n\t}\r\n\r\n\tvar panLeft = function () {\r\n\r\n\t\tvar v = new THREE.Vector3();\r\n\r\n\t\treturn function panLeft( distance, objectMatrix ) {\r\n\r\n\t\t\tv.setFromMatrixColumn( objectMatrix, 0 ); // get X column of objectMatrix\r\n\t\t\tv.multiplyScalar( - distance );\r\n\r\n\t\t\tpanOffset.add( v );\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\tvar panUp = function () {\r\n\r\n\t\tvar v = new THREE.Vector3();\r\n\r\n\t\treturn function panUp( distance, objectMatrix ) {\r\n\r\n\t\t\tswitch ( scope.panningMode ) {\r\n\r\n\t\t\t\tcase THREE.ScreenSpacePanning:\r\n\r\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 1 );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase THREE.HorizontalPanning:\r\n\r\n\t\t\t\t\tv.setFromMatrixColumn( objectMatrix, 0 );\r\n\t\t\t\t\tv.crossVectors( scope.object.up, v );\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tv.multiplyScalar( distance );\r\n\r\n\t\t\tpanOffset.add( v );\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\t// deltaX and deltaY are in pixels; right and down are positive\r\n\tvar pan = function () {\r\n\r\n\t\tvar offset = new THREE.Vector3();\r\n\r\n\t\treturn function pan( deltaX, deltaY ) {\r\n\r\n\t\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\r\n\t\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\t\t// perspective\r\n\t\t\t\tvar position = scope.object.position;\r\n\t\t\t\toffset.copy( position ).sub( scope.target );\r\n\t\t\t\tvar targetDistance = offset.length();\r\n\r\n\t\t\t\t// half of the fov is center to top of screen\r\n\t\t\t\ttargetDistance *= Math.tan( ( scope.object.fov / 2 ) * Math.PI / 180.0 );\r\n\r\n\t\t\t\t// we actually don't use screenWidth, since perspective camera is fixed to screen height\r\n\t\t\t\tpanLeft( 2 * deltaX * targetDistance / element.clientHeight, scope.object.matrix );\r\n\t\t\t\tpanUp( 2 * deltaY * targetDistance / element.clientHeight, scope.object.matrix );\r\n\r\n\t\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\t\t// orthographic\r\n\t\t\t\tpanLeft( deltaX * ( scope.object.right - scope.object.left ) / scope.object.zoom / element.clientWidth, scope.object.matrix );\r\n\t\t\t\tpanUp( deltaY * ( scope.object.top - scope.object.bottom ) / scope.object.zoom / element.clientHeight, scope.object.matrix );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t// camera neither orthographic nor perspective\r\n\t\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.' );\r\n\t\t\t\tscope.enablePan = false;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t}();\r\n\r\n\tfunction dollyIn( dollyScale ) {\r\n\r\n\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\tscale /= dollyScale;\r\n\r\n\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom * dollyScale ) );\r\n\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\tzoomChanged = true;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\r\n\t\t\tscope.enableZoom = false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction dollyOut( dollyScale ) {\r\n\r\n\t\tif ( scope.object.isPerspectiveCamera ) {\r\n\r\n\t\t\tscale *= dollyScale;\r\n\r\n\t\t} else if ( scope.object.isOrthographicCamera ) {\r\n\r\n\t\t\tscope.object.zoom = Math.max( scope.minZoom, Math.min( scope.maxZoom, scope.object.zoom / dollyScale ) );\r\n\t\t\tscope.object.updateProjectionMatrix();\r\n\t\t\tzoomChanged = true;\r\n\r\n\t\t} else {\r\n\r\n\t\t\tconsole.warn( 'WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled.' );\r\n\t\t\tscope.enableZoom = false;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t//\r\n\t// event callbacks - update the object state\r\n\t//\r\n\r\n\tfunction handleMouseDownRotate( event ) {\r\n\r\n\t\t//console.log( 'handleMouseDownRotate' );\r\n\r\n\t\trotateStart.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction handleMouseDownDolly( event ) {\r\n\r\n\t\t//console.log( 'handleMouseDownDolly' );\r\n\r\n\t\tdollyStart.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction handleMouseDownPan( event ) {\r\n\r\n\t\t//console.log( 'handleMouseDownPan' );\r\n\r\n\t\tpanStart.set( event.clientX, event.clientY );\r\n\r\n\t}\r\n\r\n\tfunction handleMouseMoveRotate( event ) {\r\n\r\n\t\t//console.log( 'handleMouseMoveRotate' );\r\n\r\n\t\trotateEnd.set( event.clientX, event.clientY );\r\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\r\n\r\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\r\n\t\t// rotating across whole screen goes 360 degrees around\r\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\r\n\r\n\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\r\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\r\n\r\n\t\trotateStart.copy( rotateEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleMouseMoveDolly( event ) {\r\n\r\n\t\t//console.log( 'handleMouseMoveDolly' );\r\n\r\n\t\tdollyEnd.set( event.clientX, event.clientY );\r\n\r\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\r\n\r\n\t\tif ( dollyDelta.y > 0 ) {\r\n\r\n\t\t\tdollyIn( getZoomScale() );\r\n\r\n\t\t} else if ( dollyDelta.y < 0 ) {\r\n\r\n\t\t\tdollyOut( getZoomScale() );\r\n\r\n\t\t}\r\n\r\n\t\tdollyStart.copy( dollyEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleMouseMovePan( event ) {\r\n\r\n\t\t//console.log( 'handleMouseMovePan' );\r\n\r\n\t\tpanEnd.set( event.clientX, event.clientY );\r\n\r\n\t\tpanDelta.subVectors( panEnd, panStart );\r\n\r\n\t\tpan( panDelta.x, panDelta.y );\r\n\r\n\t\tpanStart.copy( panEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleMouseUp( event ) {\r\n\r\n\t\t// console.log( 'handleMouseUp' );\r\n\r\n\t}\r\n\r\n\tfunction handleMouseWheel( event ) {\r\n\r\n\t\t// console.log( 'handleMouseWheel' );\r\n\r\n\t\tif ( event.deltaY < 0 ) {\r\n\r\n\t\t\tdollyOut( getZoomScale() );\r\n\r\n\t\t} else if ( event.deltaY > 0 ) {\r\n\r\n\t\t\tdollyIn( getZoomScale() );\r\n\r\n\t\t}\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleKeyDown( event ) {\r\n\r\n\t\t//console.log( 'handleKeyDown' );\r\n\r\n\t\tswitch ( event.keyCode ) {\r\n\r\n\t\t\tcase scope.keys.UP:\r\n\t\t\t\tpan( 0, scope.keyPanSpeed );\r\n\t\t\t\tscope.update();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.keys.BOTTOM:\r\n\t\t\t\tpan( 0, - scope.keyPanSpeed );\r\n\t\t\t\tscope.update();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.keys.LEFT:\r\n\t\t\t\tpan( scope.keyPanSpeed, 0 );\r\n\t\t\t\tscope.update();\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.keys.RIGHT:\r\n\t\t\t\tpan( - scope.keyPanSpeed, 0 );\r\n\t\t\t\tscope.update();\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartRotate( event ) {\r\n\r\n\t\t//console.log( 'handleTouchStartRotate' );\r\n\r\n\t\trotateStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartDolly( event ) {\r\n\r\n\t\t//console.log( 'handleTouchStartDolly' );\r\n\r\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\r\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\tdollyStart.set( 0, distance );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchStartPan( event ) {\r\n\r\n\t\t//console.log( 'handleTouchStartPan' );\r\n\r\n\t\tpanStart.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMoveRotate( event ) {\r\n\r\n\t\t//console.log( 'handleTouchMoveRotate' );\r\n\r\n\t\trotateEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\t\trotateDelta.subVectors( rotateEnd, rotateStart );\r\n\r\n\t\tvar element = scope.domElement === document ? scope.domElement.body : scope.domElement;\r\n\r\n\t\t// rotating across whole screen goes 360 degrees around\r\n\t\trotateLeft( 2 * Math.PI * rotateDelta.x / element.clientWidth * scope.rotateSpeed );\r\n\r\n\t\t// rotating up and down along whole screen attempts to go 360, but limited to 180\r\n\t\trotateUp( 2 * Math.PI * rotateDelta.y / element.clientHeight * scope.rotateSpeed );\r\n\r\n\t\trotateStart.copy( rotateEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMoveDolly( event ) {\r\n\r\n\t\t//console.log( 'handleTouchMoveDolly' );\r\n\r\n\t\tvar dx = event.touches[ 0 ].pageX - event.touches[ 1 ].pageX;\r\n\t\tvar dy = event.touches[ 0 ].pageY - event.touches[ 1 ].pageY;\r\n\r\n\t\tvar distance = Math.sqrt( dx * dx + dy * dy );\r\n\r\n\t\tdollyEnd.set( 0, distance );\r\n\r\n\t\tdollyDelta.subVectors( dollyEnd, dollyStart );\r\n\r\n\t\tif ( dollyDelta.y > 0 ) {\r\n\r\n\t\t\tdollyOut( getZoomScale() );\r\n\r\n\t\t} else if ( dollyDelta.y < 0 ) {\r\n\r\n\t\t\tdollyIn( getZoomScale() );\r\n\r\n\t\t}\r\n\r\n\t\tdollyStart.copy( dollyEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleTouchMovePan( event ) {\r\n\r\n\t\t//console.log( 'handleTouchMovePan' );\r\n\r\n\t\tpanEnd.set( event.touches[ 0 ].pageX, event.touches[ 0 ].pageY );\r\n\r\n\t\tpanDelta.subVectors( panEnd, panStart );\r\n\r\n\t\tpan( panDelta.x, panDelta.y );\r\n\r\n\t\tpanStart.copy( panEnd );\r\n\r\n\t\tscope.update();\r\n\r\n\t}\r\n\r\n\tfunction handleTouchEnd( event ) {\r\n\r\n\t\t//console.log( 'handleTouchEnd' );\r\n\r\n\t}\r\n\r\n\tfunction checkIgnoredAreas( event ){\r\n\r\n\t\tvar rects = scope.ignoredAreas;\r\n\t\tfor(var i = 0; i < rects.length; i++){\r\n\t\t\t\r\n\t\t\tif(rects[i].ContainsPoint(event.clientX, event.clientY))\r\n\t\t\t\treturn true;\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t//\r\n\t// event handlers - FSM: listen for events and reset state\r\n\t//\r\n\r\n\tfunction onMouseDown( event ) {\r\n\r\n\t\tif ( scope.enabled === false || checkIgnoredAreas( event ) ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tswitch ( event.button ) {\r\n\r\n\t\t\tcase scope.mouseButtons.ORBIT:\r\n\r\n\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\thandleMouseDownRotate( event );\r\n\r\n\t\t\t\tstate = STATE.ROTATE;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.mouseButtons.ZOOM:\r\n\r\n\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\r\n\t\t\t\thandleMouseDownDolly( event );\r\n\r\n\t\t\t\tstate = STATE.DOLLY;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase scope.mouseButtons.PAN:\r\n\r\n\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\thandleMouseDownPan( event );\r\n\r\n\t\t\t\tstate = STATE.PAN;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t\tif ( state !== STATE.NONE ) {\r\n\r\n\t\t\tscope.domElement.addEventListener( 'mousemove', onMouseMove, false );\r\n\t\t\tdocument.addEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t\t\tscope.dispatchEvent( startEvent );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onMouseMove( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tswitch ( state ) {\r\n\r\n\t\t\tcase STATE.ROTATE:\r\n\r\n\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\thandleMouseMoveRotate( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase STATE.DOLLY:\r\n\r\n\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\r\n\t\t\t\thandleMouseMoveDolly( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase STATE.PAN:\r\n\r\n\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\thandleMouseMovePan( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onMouseUp( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\thandleMouseUp( event );\r\n\r\n\t\tscope.domElement.removeEventListener( 'mousemove', onMouseMove, false );\r\n\t\tdocument.removeEventListener( 'mouseup', onMouseUp, false );\r\n\r\n\t\tscope.dispatchEvent( endEvent );\r\n\r\n\t\tstate = STATE.NONE;\r\n\r\n\t}\r\n\r\n\tfunction onMouseWheel( event ) {\r\n\r\n\t\tif ( scope.enabled === false || scope.enableZoom === false || ( state !== STATE.NONE && state !== STATE.ROTATE ) ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tscope.dispatchEvent( startEvent );\r\n\r\n\t\thandleMouseWheel( event );\r\n\r\n\t\tscope.dispatchEvent( endEvent );\r\n\r\n\t}\r\n\r\n\tfunction onKeyDown( event ) {\r\n\r\n\t\tif ( scope.enabled === false || scope.enableKeys === false || scope.enablePan === false ) return;\r\n\r\n\t\thandleKeyDown( event );\r\n\r\n\t}\r\n\r\n\tfunction onTouchStart( event ) {\r\n\r\n\t\tif ( scope.enabled === false  || checkIgnoredAreas( event ) ) return;\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1:\t// one-fingered touch: rotate\r\n\r\n\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\r\n\t\t\t\thandleTouchStartRotate( event );\r\n\r\n\t\t\t\tstate = STATE.TOUCH_ROTATE;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2:\t// two-fingered touch: dolly\r\n\r\n\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\r\n\t\t\t\thandleTouchStartDolly( event );\r\n\r\n\t\t\t\tstate = STATE.TOUCH_DOLLY;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 3: // three-fingered touch: pan\r\n\r\n\t\t\t\tif ( scope.enablePan === false ) return;\r\n\r\n\t\t\t\thandleTouchStartPan( event );\r\n\r\n\t\t\t\tstate = STATE.TOUCH_PAN;\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t}\r\n\r\n\t\tif ( state !== STATE.NONE ) {\r\n\r\n\t\t\tscope.dispatchEvent( startEvent );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onTouchMove( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\t\tevent.stopPropagation();\r\n\r\n\t\tswitch ( event.touches.length ) {\r\n\r\n\t\t\tcase 1: // one-fingered touch: rotate\r\n\r\n\t\t\t\tif ( scope.enableRotate === false ) return;\r\n\t\t\t\tif ( state !== STATE.TOUCH_ROTATE ) return; // is this needed?...\r\n\r\n\t\t\t\thandleTouchMoveRotate( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 2: // two-fingered touch: dolly\r\n\r\n\t\t\t\tif ( scope.enableZoom === false ) return;\r\n\t\t\t\tif ( state !== STATE.TOUCH_DOLLY ) return; // is this needed?...\r\n\r\n\t\t\t\thandleTouchMoveDolly( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tcase 3: // three-fingered touch: pan\r\n\r\n\t\t\t\tif ( scope.enablePan === false ) return;\r\n\t\t\t\tif ( state !== STATE.TOUCH_PAN ) return; // is this needed?...\r\n\r\n\t\t\t\thandleTouchMovePan( event );\r\n\r\n\t\t\t\tbreak;\r\n\r\n\t\t\tdefault:\r\n\r\n\t\t\t\tstate = STATE.NONE;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction onTouchEnd( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\thandleTouchEnd( event );\r\n\r\n\t\tscope.dispatchEvent( endEvent );\r\n\r\n\t\tstate = STATE.NONE;\r\n\r\n\t}\r\n\r\n\tfunction onContextMenu( event ) {\r\n\r\n\t\tif ( scope.enabled === false ) return;\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t}\r\n\r\n\t//\r\n\r\n\tscope.domElement.addEventListener( 'contextmenu', onContextMenu, false );\r\n\r\n\tscope.domElement.addEventListener( 'mousedown', onMouseDown, false );\r\n\tscope.domElement.addEventListener( 'wheel', onMouseWheel, false );\r\n\r\n\tscope.domElement.addEventListener( 'touchstart', onTouchStart, false );\r\n\tscope.domElement.addEventListener( 'touchend', onTouchEnd, false );\r\n\tscope.domElement.addEventListener( 'touchmove', onTouchMove, false );\r\n\r\n\twindow.addEventListener( 'keydown', onKeyDown, false );\r\n\r\n\t// force an update at start\r\n\r\n\tthis.update();\r\n\r\n};\r\n\r\nTHREE.OrbitControls.prototype = Object.create( THREE.EventDispatcher.prototype );\r\nTHREE.OrbitControls.prototype.constructor = THREE.OrbitControls;\r\n\r\nObject.defineProperties( THREE.OrbitControls.prototype, {\r\n\r\n\tcenter: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .center has been renamed to .target' );\r\n\t\t\treturn this.target;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\t// backward compatibility\r\n\r\n\tnoZoom: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\r\n\t\t\treturn ! this.enableZoom;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead.' );\r\n\t\t\tthis.enableZoom = ! value;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tnoRotate: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\r\n\t\t\treturn ! this.enableRotate;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead.' );\r\n\t\t\tthis.enableRotate = ! value;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tnoPan: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\r\n\t\t\treturn ! this.enablePan;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead.' );\r\n\t\t\tthis.enablePan = ! value;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tnoKeys: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\r\n\t\t\treturn ! this.enableKeys;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead.' );\r\n\t\t\tthis.enableKeys = ! value;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tstaticMoving: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\r\n\t\t\treturn ! this.enableDamping;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead.' );\r\n\t\t\tthis.enableDamping = ! value;\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tdynamicDampingFactor: {\r\n\r\n\t\tget: function () {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\r\n\t\t\treturn this.dampingFactor;\r\n\r\n\t\t},\r\n\r\n\t\tset: function ( value ) {\r\n\r\n\t\t\tconsole.warn( 'THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead.' );\r\n\t\t\tthis.dampingFactor = value;\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n} );\r\n\r\nTHREE.ScreenSpacePanning = 0;\r\nTHREE.HorizontalPanning = 1;\n\n\n// WEBPACK FOOTER //\n// ./src/min-dependencies/lib/three/controls/OrbitControls.js","import Controller from \"../scene/Controller\";\r\nimport Camera from \"../scene/Camera\";\r\nimport Transform from \"../scene/Transform\";\r\nimport Utils from \"../utils/cik/Utils\";\r\nimport EntryInputView, { EntryInputViewParams } from \"./EntryInputView\";\r\nimport CargoEntry from \"../components/common/CargoEntry\";\r\nimport SceneSetup from \"./SceneSetup\";\r\n\r\n/**\r\n * @typedef {Object} HUDViewParams\r\n * @property {import('../UX').default} ux\r\n * @property {SceneSetup} sceneSetup\r\n * @property {HTMLElement} container\r\n */\r\n\r\n/** @type {HUDViewParams} */\r\nconst defaultParams = {};\r\n\r\n// -11.3, 23.9, 215.5\r\nconst defaultCamTRS = new Transform( new THREE.Vector3(0, 100, 800), new THREE.Euler(0, Math.PI, 0) );\r\n\r\nclass HUDView extends Controller {\r\n    /**\r\n     * @param {HUDViewParams} params \r\n     * @param {import('../scene/Camera').CameraParams} cameraParams \r\n     */\r\n    constructor(params, cameraParams){\r\n        super(params);\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        let units = this.params.ux.params.units;\r\n\r\n        this.cameraController = new Camera(cameraParams);\r\n\r\n        this.cameraTransform = defaultCamTRS.Clone();\r\n        this.cameraTransform.position.multiplyScalar(units);\r\n        this.cameraTransform.Apply(this.cameraController);\r\n        this.cameraController.camera.updateMatrixWorld();\r\n        this.cameraController.OrbitControls(this.params.container);\r\n        this.cameraController.SetTarget(new THREE.Vector3());\r\n        this.cameraController.Hold();\r\n\r\n        //var gridHelper = new THREE.GridHelper(100 * units, 20);\r\n        //this.AddDefault(gridHelper);\r\n\r\n        /** @type {EntryInputViewParams} */\r\n        let entryInputViewParams = {ux: this.params.ux, sceneSetup: this.params.sceneSetup, scaleFigure: this.params.ux.params.scaleRefFigure};\r\n        this.entryInputView = new EntryInputView(entryInputViewParams);\r\n        this.AddDefault(this.entryInputView.view);\r\n\r\n        this.lastUpdateTime = 0;\r\n\r\n        this.params.sceneSetup.input.onMouseUp.push(this.OnMouseUp.bind(this));\r\n    }\r\n\r\n    OnMouseUp(){\r\n        if(this.entryInputView.previewing){\r\n            this.entryInputView.Preview(false);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * @param {CargoEntry} entry \r\n     */\r\n    Preview(entry){\r\n        this.entryInputView.Preview(entry);\r\n    }\r\n\r\n    /** @param {Number} now */\r\n    Update(now){\r\n        let deltaTime = now - this.lastUpdateTime;\r\n        this.lastUpdateTime = now;\r\n        this.cameraController.Update();\r\n        \r\n        this.entryInputView.Update(now, deltaTime);\r\n    }\r\n}\r\n\r\nexport default HUDView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/HUDView.js","\r\nconst _position = Symbol('position');\r\nconst _rotation = Symbol('rotation');\r\n\r\nclass Transform {\r\n\r\n    /**\r\n     * @param {THREE.Vector3} position \r\n     * @param {THREE.Euler} rotation \r\n     */\r\n    constructor(position, rotation){\r\n        this[_position] = position || new THREE.Vector3();\r\n        this[_rotation] = rotation || new THREE.Euler();\r\n    }\r\n\r\n    /**\r\n     * @returns {THREE.Vector3}\r\n     */\r\n    get position(){\r\n        return this[_position];\r\n    }\r\n\r\n    set position(value){\r\n        this[_position] = value;\r\n    }\r\n\r\n    /**\r\n     * @returns {THREE.Euler}\r\n     */\r\n    get rotation(){\r\n        return this[_rotation];\r\n    }\r\n\r\n    set rotation(value){\r\n        this[_rotation] = value;\r\n    }\r\n\r\n    /**\r\n     * \r\n     * @param {THREE.Object3D} target \r\n     */\r\n    Apply(target){\r\n        target.position.copy(this[_position]);\r\n        target.rotation.copy(this[_rotation]);\r\n    }\r\n\r\n    Clone(){\r\n        var transform = new Transform(this[_position].clone(), this[_rotation].clone());\r\n        return transform;\r\n    }\r\n}\r\n\r\nexport default Transform;\n\n\n// WEBPACK FOOTER //\n// ./src/api/scene/Transform.js","import Logger from \"../../utils/cik/Logger\";\r\n\r\nconst _enabled = Symbol('enabled');\r\n\r\nclass PackingProperty {\r\n    constructor(){\r\n        this[_enabled] = false;\r\n    }\r\n\r\n    /** @returns {Boolean} Is property enabled */\r\n    get enabled(){ return this[_enabled]; }\r\n    set enabled(value){\r\n        this[_enabled] = value;\r\n    }\r\n\r\n    Reset(){\r\n        this.enabled = false;\r\n    }\r\n\r\n    /**\r\n     * @param {PackingProperty} prop \r\n     */\r\n    Copy(prop){\r\n        this.enabled = prop.enabled;\r\n    }\r\n\r\n    Clone(){\r\n        Logger.Warn('PackingProperty.Clone is not implemented');\r\n    }\r\n\r\n    static Assert(prop){\r\n        return prop instanceof PackingProperty;\r\n    }\r\n}\r\n\r\nclass StackingProperty extends PackingProperty {\r\n    constructor(){\r\n        super();\r\n\r\n        /** Maximum stacking capacity (weight) */\r\n        this.capacity = Number.MAX_SAFE_INTEGER;\r\n    }\r\n\r\n    Reset(){\r\n        super.Reset();\r\n        this.capacity = Number.MAX_SAFE_INTEGER;\r\n    }\r\n\r\n    /**\r\n     * @param {StackingProperty} prop \r\n     */\r\n    Copy(prop){\r\n        super.Copy(prop);\r\n        this.capacity = prop.capacity;\r\n    }\r\n\r\n    Clone(){\r\n        var prop = new StackingProperty();\r\n        prop.Copy(this);\r\n        return prop;\r\n    }\r\n}\r\n\r\nclass Constraint extends PackingProperty {\r\n    constructor(){\r\n        super();\r\n    }\r\n\r\n    Copy(prop){\r\n        super.Copy(prop);\r\n    }\r\n\r\n    Clone(){\r\n        Logger.Warn('Constraint.Clone is not implemented');\r\n    }\r\n}\r\n\r\nconst orientations = { xyz: 'xyz', zyx: 'zyx', yxz: 'yxz', yzx: 'yzx', zxy: 'zxy', xzy: 'xzy' };\r\nconst _allowedOrientations = Symbol('allowedOrientations');\r\nclass RotationConstraint extends Constraint {\r\n    constructor(){\r\n        super();\r\n    }\r\n\r\n    /** Enables each orientation enumeration in array\r\n     * @param {Array<orientations>} value */\r\n    set allowedOrientations(value){\r\n        this[_allowedOrientations] = value;\r\n    }\r\n    get allowedOrientations(){ return this[_allowedOrientations]; }\r\n\r\n    Reset(){\r\n        super.Reset();\r\n        if(this.allowedOrientations instanceof Array) this.allowedOrientations.length = 0;\r\n    }\r\n\r\n    /** @param {Boolean} allowX @param {Boolean} allowY @param {Boolean} allowZ */\r\n    SetOrientationsByAxis(allowX, allowY, allowZ){\r\n        let allowed = this.allowedOrientations;\r\n        if(allowed) allowed.length = 0;\r\n        else allowed = [];\r\n\r\n        if(allowY){\r\n            allowed.push(orientations.xyz, orientations.zyx);\r\n\r\n            if(allowX) allowed.push(orientations.yzx);\r\n            if(allowZ) allowed.push(orientations.zxy);\r\n        }\r\n        if(allowX) allowed.push(orientations.xzy);\r\n        if(allowZ) allowed.push(orientations.yxz);\r\n\r\n        this.allowedOrientations = allowed;\r\n    }\r\n\r\n    /** @param {Boolean} allowWH @param {Boolean} allowLH @param {Boolean} allowWL */\r\n    SetOrientationsBySide(allowWH, allowLH, allowWL){\r\n        let allowed = this.allowedOrientations;\r\n        if(allowed) allowed.length = 0;\r\n        else allowed = [];\r\n\r\n        if(allowWH) allowed.push(orientations.yxz, orientations.yzx);\r\n        if(allowLH) allowed.push(orientations.xzy, orientations.zxy);\r\n        if(allowWL) allowed.push(orientations.xyz, orientations.zyx);\r\n\r\n        this.allowedOrientations = allowed;\r\n    }\r\n\r\n    /**\r\n     * @param {RotationConstraint} prop \r\n     */\r\n    Copy(prop){\r\n        super.Copy(prop);\r\n        this.allowedOrientations = prop.allowedOrientations instanceof Array ? prop.allowedOrientations.slice() : undefined;\r\n    }\r\n\r\n    Clone(){\r\n        var prop = new RotationConstraint();\r\n        prop.Copy(this);\r\n        return prop;\r\n    }\r\n\r\n    /** Enumerations of orientation values, do not modify directly */\r\n    static get orientations(){\r\n        return orientations;\r\n    }\r\n}\r\n\r\nclass TranslationConstraint extends Constraint {\r\n    constructor(){\r\n        super();\r\n\r\n        /** Should be positioned on the platform surface (on the ground) */\r\n        this.grounded = false;\r\n    }\r\n\r\n    Reset(){\r\n        super.Reset();\r\n        this.grounded = false;\r\n    }\r\n\r\n    /**\r\n     * @param {TranslationConstraint} prop \r\n     */\r\n    Copy(prop){\r\n        super.Copy(prop);\r\n        this.grounded = prop.grounded;\r\n    }\r\n\r\n    Clone(){\r\n        var prop = new TranslationConstraint();\r\n        prop.Copy(this);\r\n        return prop;\r\n    }\r\n}\r\n\r\nexport {\r\n    PackingProperty,\r\n    StackingProperty,\r\n    RotationConstraint,\r\n    TranslationConstraint\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/box/PackingProperty.js","\r\nconst typeofNumber = 'number';\r\n\r\n/** @param {THREE.Color} source @param {Array<THREE.Color>} colors */\r\nfunction findNearest(source, colors){\r\n    var dMin = Number.MAX_SAFE_INTEGER;\r\n    var nearest = source;\r\n    colors.forEach(color => {\r\n        let vx = color.r - source.r,\r\n            vy = color.g - source.g,\r\n            vz = color.b - source.b;\r\n        let d = vx * vx + vy * vy + vz * vz;\r\n        if(d < dMin){\r\n            dMin = d;\r\n            nearest = color;\r\n        }\r\n    });\r\n\r\n    return nearest;\r\n}\r\n\r\nvar tempColor = new THREE.Color();\r\n\r\nclass ColorTemplate{\r\n    /**\r\n     * @param {Array<string|THREE.Color>} colors \r\n     */\r\n    constructor(...colors){\r\n        /** @type {Array<THREE.Color>} */\r\n        this.colors = [];\r\n        colors.forEach(color => {\r\n            if( !(color instanceof THREE.Color) ) color = new THREE.Color(color);\r\n            this.colors.push(color);\r\n        });\r\n    }\r\n\r\n    /**\r\n     * @template T\r\n     * @param {T} target \r\n     * @returns {T}\r\n     */\r\n    Apply(target){\r\n        var scope = this;\r\n        if(typeof target === typeofNumber){\r\n            let mapColor = findNearest(tempColor.setHex(target), this.colors);\r\n            target = mapColor.getHex();\r\n        }\r\n        else if(target instanceof THREE.Color){\r\n            let mapColor = findNearest(target, this.colors);\r\n            target.copy(mapColor);\r\n        }\r\n        else if(target instanceof THREE.Material){\r\n            let color = target.color;\r\n            if(color instanceof THREE.Color){\r\n                let mapColor = findNearest(color, this.colors);\r\n                color.copy(mapColor);\r\n            }\r\n        }\r\n        else if(target instanceof THREE.Object3D){\r\n            target.traverse(function(child){\r\n                if(child instanceof THREE.Mesh){\r\n                    scope.Apply(child.material);\r\n                }\r\n            });\r\n        }\r\n        return target;\r\n    }\r\n}\r\n\r\nexport default ColorTemplate;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/assets/ColorTemplate.js","import Tween from \"../Tween\";\r\nimport Signaler from \"../Signaler\";\r\n\r\nvar tempBox3 = new THREE.Box3();\r\nvar tempVec3 = new THREE.Vector3();\r\nvar clock = new THREE.Clock();\r\n\r\nclass TransitionController{\r\n    constructor(){\r\n\r\n    }\r\n}\r\n\r\nclass Slide extends TransitionController{\r\n    /**\r\n     * Slide from, to. ie: slideFromLeft -> from = 1 & to = 0\r\n     * @param {string} property \r\n     * @param {Number} from \r\n     * @param {Number} to \r\n     */\r\n    constructor(property, from, to){\r\n        super();\r\n\r\n        this.tween = new Tween(Tween.functions.linear, 0, 0, 0);\r\n        this.property = property;\r\n        this.from = from;\r\n        this.to = to;\r\n    }\r\n\r\n    /** @param {Transition} transition */\r\n    Init(transition){\r\n\r\n        transition.bounds.getSize(tempVec3);\r\n        let offset = tempVec3.x;\r\n        transition.bounds.getCenter(tempVec3);\r\n        offset += transition.target.position.x - tempVec3.x;\r\n\r\n        this.tween.startValue = offset * this.from;\r\n        this.tween.delta = -(offset * this.from) + offset * this.to;\r\n        this.tween.duration = transition.duration;\r\n        this.tween.onComplete = transition.OnComplete.bind(transition);\r\n\r\n        this.tween.Hook(transition.target.position, this.property);\r\n    }\r\n\r\n    Start(){\r\n        this.tween.Update(0);\r\n    }\r\n\r\n    /** @param {Number} t */\r\n    Update(t){\r\n        this.tween.Update(t);\r\n    }\r\n}\r\n\r\nconst signals = {\r\n    complete: 'complete'\r\n};\r\n\r\nconst _controller = Symbol('controller');\r\n\r\nclass Transition extends Signaler{\r\n    /**\r\n     * @param {THREE.Object3D} boundsView object to calculate bounds from\r\n     * @param {THREE.Object3D} transformView object to transform\r\n     * @param {Number} duration\r\n     */\r\n    constructor(boundsView, transformView, duration){\r\n        super();\r\n        \r\n        this.bounds = new THREE.Box3();\r\n        this.bounds.setFromObject(boundsView);\r\n\r\n        this.target = transformView;\r\n        this.duration = duration;\r\n    }\r\n\r\n    /** @param {TransitionController} value */\r\n    set controller(value){\r\n        this[_controller] = value;\r\n    }\r\n\r\n    get controller(){ return this[_controller]; }\r\n\r\n    OnComplete(){\r\n        this.Dispatch(signals.complete, this.controller);\r\n    }\r\n\r\n    Start(){\r\n        this.startTime = clock.getElapsedTime();\r\n        if(this.controller) this.controller.Start();\r\n    }\r\n\r\n    Update(){\r\n        let t = clock.getElapsedTime() - this.startTime;\r\n        if(this.controller) this.controller.Update(t);\r\n    }\r\n\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n}\r\n\r\nexport {\r\n    Transition, \r\n    Slide\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/api/utils/cik/transitions/Transition.js","import App from \"../App\";\r\nimport LightDispatcher from \"./LightDispatcher\";\r\nimport Logger from \"../utils/cik/Logger\";\r\n\r\nconst _app = Symbol('app');\r\n\r\nconst typeofNumber = 'number';\r\n\r\nclass PackResults {\r\n    \r\n    /** @param {App} app */\r\n    constructor(app){\r\n\r\n        this[_app] = app;\r\n    }\r\n\r\n    get animationDuration(){ \r\n        /** @type {App} */\r\n        let app = this[_app];\r\n        return app.view.packResultView.params.animationDuration;\r\n    }\r\n    set animationDuration(value){\r\n\r\n        if(typeof value !== typeofNumber){\r\n            Logger.Warn('PackResults.animationDuration error, parameter is not a number:', value);\r\n            return;\r\n        }\r\n\r\n        /** @type {App} */\r\n        let app = this[_app];\r\n        app.view.packResultView.params.animationDuration = value; \r\n    }\r\n\r\n    /** Hides stacked boxes in viewer by vertical position\r\n     * 0: None - 1: All (over y span)\r\n     * @param {Number} value\r\n     */\r\n    SliceResults(value){\r\n\r\n        if(typeof value !== typeofNumber){\r\n            Logger.Warn('PackResults.SliceResults error, parameter is not a number:', value);\r\n            return;\r\n        }\r\n\r\n        /** @type {App} */\r\n        let app = this[_app];\r\n        app.view.packResultView.Slice(value);\r\n    }\r\n\r\n}\r\n\r\nconst visualizationSignals = {\r\n    \r\n};\r\n\r\nclass Visualization extends LightDispatcher{\r\n    \r\n    /** @param {App} app */\r\n    constructor(app){\r\n        super();\r\n\r\n        this[_app] = app;\r\n\r\n        this.packResults = new PackResults(app);\r\n    }\r\n\r\n    /** Selects an entry in the scene, optionally highlighting packed instances\r\n     *  @param {string | Boolean} [entryUID] default = false (deselect) @param {Boolean} [highlightPackedInstances] default = true */\r\n    SelectEntry(entryUID, highlightPackedInstances){\r\n        /** @type {App} */\r\n        let app = this[_app];\r\n\r\n        if(entryUID && !app.packer.cargoList.GetEntry(entryUID)){\r\n            Logger.Warn('Visualization.SelectEntry failed, entry not found for:', entryUID);\r\n            return;\r\n        }\r\n\r\n        app.view.cargoListView.Select(entryUID);\r\n\r\n        if(highlightPackedInstances === undefined) highlightPackedInstances = true;\r\n        if(highlightPackedInstances || !entryUID) app.view.packResultView.SelectEntry(entryUID);\r\n    }\r\n\r\n    /** Enumeration of dispatched types */\r\n    static get signals(){\r\n        return visualizationSignals;\r\n    }\r\n}\r\n\r\nexport default Visualization;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/Visualization.js","import LightDispatcher from \"./LightDispatcher\";\r\nimport App from \"../App\";\r\nimport CargoListView from \"../view/CargoListView\";\r\nimport CargoEntry from \"./common/CargoEntry\";\r\n\r\nconst _app = Symbol('app');\r\n\r\nconst signals = {\r\n    boxEntryInteract: 'beInteract0'\r\n};\r\n\r\nclass User extends LightDispatcher{\r\n    /** @param {App} app */\r\n    constructor(app){\r\n        super();\r\n\r\n        this[_app] = app;\r\n\r\n        let scope = this;\r\n        /** @param {CargoEntry} cargoEntry */\r\n        function onCargoInteract(cargoEntry){\r\n            scope.Dispatch(signals.boxEntryInteract, cargoEntry.uid);\r\n        }\r\n\r\n        app.view.cargoListView.On(CargoListView.signals.interact, onCargoInteract);\r\n    }\r\n\r\n    /** Enumeration of dispatched types */\r\n    static get signals(){\r\n        return signals;\r\n    }\r\n\r\n}\r\n\r\nexport default User;\n\n\n// WEBPACK FOOTER //\n// ./src/api/components/User.js","import CargoGroup from \"./CargoGroup\";\r\n\r\nvar _position = Symbol('position');\r\nvar _rotation = Symbol('rotation');\r\n\r\nclass PackingItem {\r\n    constructor(){\r\n        this[_position] = new THREE.Vector3();\r\n        this[_rotation] = new THREE.Euler();\r\n    }\r\n\r\n    /** @returns {THREE.Vector3} */\r\n    get position(){ return this[_position]; }\r\n    set position(value){\r\n        this[_position] = value;\r\n    }\r\n\r\n    /** @returns {THREE.Euler} */\r\n    get rotation(){ return this[_position]; }\r\n    set rotation(value){\r\n        this[_rotation] = value;\r\n    }\r\n}\r\n\r\nclass Cargo extends PackingItem {\r\n    /**\r\n     * \r\n     * @param {CargoGroup} group\r\n     */\r\n    constructor(group){\r\n        super();\r\n\r\n        this.group = group;\r\n    }\r\n\r\n    get entry(){\r\n        return this.group.entry;\r\n    }\r\n\r\n    Clone(){\r\n        var cargo = new Cargo(this.group);\r\n        return cargo;\r\n    }\r\n\r\n    ToString(){\r\n        var output = 'Cargo(' + this.entry.ToString() + ')';\r\n\r\n        return output;\r\n    }\r\n}\r\n\r\nexport default Cargo;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/Cargo.js","import Utils from \"../../utils/cik/Utils\";\r\nimport Asset from \"../../components/assets/Asset\";\r\n\r\n/** @typedef FloatingShelfParams @property {THREE.Vector3} padding x z for padding, y for thickness @property {Number} colorHex */\r\n/** @type {FloatingShelfParams} */\r\nconst defaultParams = {\r\n    padding: new THREE.Vector3(0, .001, 0),\r\n    colorHex: 0xffffff\r\n};\r\n\r\nvar box3 = new THREE.Box3();\r\nvar vec3 = new THREE.Vector3();\r\n\r\nclass FloatingShelf{\r\n    /** @param {THREE.Object3D} targetView @param {FloatingShelfParams} params */\r\n    constructor(targetView, params){\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        this.targetView = targetView;\r\n        this.view = new THREE.Object3D();\r\n\r\n        let planeGeom = new THREE.BoxGeometry(1, 1, 1, 1, 1, 1);\r\n        let planeMaterial = new Asset.CreateSolidMaterialMatte(this.params.colorHex);\r\n        this.platformMesh = new THREE.Mesh(planeGeom, planeMaterial);\r\n        Asset.ReceiveShadow(this.platformMesh);\r\n\r\n        this.view.add(this.platformMesh);\r\n\r\n        this.Update();\r\n    }\r\n\r\n    Update(){\r\n        box3.setFromObject(this.targetView);\r\n        const worldToLocal = new THREE.Matrix4().getInverse(this.targetView.matrixWorld);\r\n        box3.applyMatrix4(worldToLocal);\r\n        box3.getSize(vec3);\r\n        let height = vec3.y;\r\n\r\n        let padding = this.params.padding;\r\n        let thickness = Math.max(.0001, padding.y);\r\n        this.platformMesh.scale.set(Math.max(.0001, vec3.x + padding.x * 2), thickness, Math.max(.0001, vec3.z + padding.z * 2));\r\n\r\n        box3.getCenter(vec3);\r\n        this.platformMesh.position.set(vec3.x, vec3.y - height / 2 - thickness, vec3.z);\r\n    }\r\n}\r\n\r\nexport default FloatingShelf;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/components/FloatingShelf.js","import Utils from \"../../utils/cik/Utils\";\r\n\r\n\r\nconst cubeGeometry = new THREE.BoxBufferGeometry(1, 1, 1, 1, 1, 1);\r\nconst outlineMaterial = new THREE.MeshBasicMaterial({side: THREE.BackSide, depthWrite:false, depthTest:true});\r\nconst boxOutlineMaterial = new THREE.MeshBasicMaterial({side: THREE.BackSide});\r\n\r\n/** @typedef OutlineParams @property {Number} color @property {Number} opacity @property {Number} offsetFactor @property {Number} offsetUnits */\r\n/** @type {OutlineParams} */\r\nconst defaultParams = {\r\n    color: 0x000000,\r\n    opacity: 1,\r\n    offsetFactor: 1,\r\n    offsetUnits: 1\r\n};\r\n\r\nvar tempBox3 = new THREE.Box3();\r\nvar tempMatrix4 = new THREE.Matrix4();\r\n\r\nclass Outline{\r\n\r\n    /** @param {OutlineParams} params */\r\n    constructor(params){\r\n\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        this.view = new THREE.Object3D();\r\n\r\n        /** @type {Map<THREE.Object3D, THREE.Object3D>} */\r\n        this.outlines = new Map();\r\n    }\r\n\r\n    /** @param {THREE.Object3D} value */\r\n    set object3d(value){\r\n        if(!value) return this.Disable();\r\n\r\n        this.view.visible = true;\r\n\r\n        if(this.material === undefined) this.material = outlineMaterial.clone();\r\n        let material = this.material;\r\n            material.color.setHex(this.params.color);\r\n            material.opacity = THREE.Math.clamp(this.params.opacity, 0, 1);\r\n            material.transparent = true;//material.opacity < .999;\r\n            material.polygonOffset = true;\r\n            material.polygonOffsetFactor = -this.params.offsetFactor;\r\n            material.polygonOffsetUnits = this.params.offsetUnits;\r\n\r\n        let outline = this.outlines.get(value);\r\n        if(!outline){\r\n            outline = value.clone(true);\r\n            if(outline instanceof THREE.Mesh){\r\n                outline.material = material;\r\n            }\r\n            else{\r\n                outline.children.forEach(oChild => oChild.traverse(function(child){\r\n                    if(child instanceof THREE.Mesh){\r\n                        let outlineReady = child.clone();\r\n                        outlineReady.material = material;\r\n                        if(child.parent){\r\n                            // Assuming end of hierarchical tree\r\n                            child.parent.add(outlineReady);\r\n                            child.parent.remove(child);\r\n                        }\r\n                    }\r\n                }));\r\n            }\r\n\r\n            this.outlines.set(value, outline);\r\n        }\r\n\r\n        value.updateMatrixWorld();\r\n        outline.matrixWorld.copy(value.matrixWorld);\r\n\r\n        while(this.view.children.length > 0) this.view.remove(this.view.children[this.view.children.length - 1]);\r\n        this.view.add(outline);\r\n    }\r\n\r\n    /** @param {THREE.Object3D} value */\r\n    set box(value){\r\n        if(!value) return this.Disable();\r\n\r\n        this.view.visible = true;\r\n\r\n        if(this.boxMaterial === undefined) this.boxMaterial = boxOutlineMaterial.clone();\r\n        this.boxMaterial.color.setHex(this.params.color);\r\n        this.boxMaterial.opacity = THREE.Math.clamp(this.params.opacity, 0, 1);\r\n        this.boxMaterial.transparent = this.boxMaterial.opacity < .999;\r\n\r\n        if(this.boxMesh === undefined){\r\n            this.boxMesh = new THREE.Mesh(cubeGeometry, this.boxMaterial);\r\n        }\r\n\r\n        value.updateMatrixWorld();\r\n        tempBox3.setFromObject(value);\r\n        tempBox3.getSize(this.view.scale);\r\n        this.view.scale.addScalar(this.params.offsetFactor);\r\n        tempBox3.getCenter(this.view.position);\r\n\r\n        let parent = this.view.parent;\r\n        if(parent){\r\n            parent.updateMatrixWorld();\r\n            let inverse = tempMatrix4.getInverse(parent.matrixWorld);\r\n            this.view.applyMatrix(inverse);\r\n        }\r\n\r\n        while(this.view.children.length > 0) this.view.remove(this.view.children[this.view.children.length - 1]);\r\n        this.view.add(this.boxMesh);\r\n    }\r\n\r\n    Disable(){\r\n        this.view.visible = false;\r\n    }\r\n    \r\n}\r\n\r\nexport default Outline;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/components/Outline.js","/**\r\n * @author arodic / https://github.com/arodic\r\n */\r\n\r\n( function () {\r\n\r\n\t'use strict';\r\n\r\n\tvar GizmoMaterial = function ( parameters ) {\r\n\r\n\t\tTHREE.MeshBasicMaterial.call( this );\r\n\r\n\t\tthis.depthTest = false;\r\n\t\tthis.depthWrite = false;\r\n\t\tthis.side = THREE.FrontSide;\r\n\t\tthis.transparent = true;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t\tthis.oldColor = this.color.clone();\r\n\t\tthis.oldOpacity = this.opacity;\r\n\r\n\t\tthis.highlight = function( highlighted ) {\r\n\r\n\t\t\tif ( highlighted ) {\r\n\r\n\t\t\t\tthis.color.setRGB( 1, 1, 0 );\r\n\t\t\t\tthis.opacity = 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.color.copy( this.oldColor );\r\n\t\t\t\tthis.opacity = this.oldOpacity;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tGizmoMaterial.prototype = Object.create( THREE.MeshBasicMaterial.prototype );\r\n\tGizmoMaterial.prototype.constructor = GizmoMaterial;\r\n\r\n\r\n\tvar GizmoLineMaterial = function ( parameters ) {\r\n\r\n\t\tTHREE.LineBasicMaterial.call( this );\r\n\r\n\t\tthis.depthTest = false;\r\n\t\tthis.depthWrite = false;\r\n\t\tthis.transparent = true;\r\n\t\tthis.linewidth = 1;\r\n\r\n\t\tthis.setValues( parameters );\r\n\r\n\t\tthis.oldColor = this.color.clone();\r\n\t\tthis.oldOpacity = this.opacity;\r\n\r\n\t\tthis.highlight = function( highlighted ) {\r\n\r\n\t\t\tif ( highlighted ) {\r\n\r\n\t\t\t\tthis.color.setRGB( 1, 1, 0 );\r\n\t\t\t\tthis.opacity = 1;\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tthis.color.copy( this.oldColor );\r\n\t\t\t\tthis.opacity = this.oldOpacity;\r\n\r\n\t\t\t}\r\n\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tGizmoLineMaterial.prototype = Object.create( THREE.LineBasicMaterial.prototype );\r\n\tGizmoLineMaterial.prototype.constructor = GizmoLineMaterial;\r\n\r\n\r\n\tvar pickerMaterial = new GizmoMaterial( { visible: false, transparent: false } );\r\n\r\n\r\n\tTHREE.TransformGizmo = function () {\r\n\r\n\t\tthis.init = function () {\r\n\r\n\t\t\tTHREE.Object3D.call( this );\r\n\r\n\t\t\tthis.handles = new THREE.Object3D();\r\n\t\t\tthis.pickers = new THREE.Object3D();\r\n\t\t\tthis.planes = new THREE.Object3D();\r\n\r\n\t\t\tthis.add( this.handles );\r\n\t\t\tthis.add( this.pickers );\r\n\t\t\tthis.add( this.planes );\r\n\r\n\t\t\t//// PLANES\r\n\r\n\t\t\tvar planeGeometry = new THREE.PlaneBufferGeometry( 50, 50, 2, 2 );\r\n\t\t\tvar planeMaterial = new THREE.MeshBasicMaterial( { visible: false, side: THREE.DoubleSide } );\r\n\r\n\t\t\tvar planes = {\r\n\t\t\t\t\"XY\":   new THREE.Mesh( planeGeometry, planeMaterial ),\r\n\t\t\t\t\"YZ\":   new THREE.Mesh( planeGeometry, planeMaterial ),\r\n\t\t\t\t\"XZ\":   new THREE.Mesh( planeGeometry, planeMaterial ),\r\n\t\t\t\t\"XYZE\": new THREE.Mesh( planeGeometry, planeMaterial )\r\n\t\t\t};\r\n\r\n\t\t\tthis.activePlane = planes[ \"XYZE\" ];\r\n\r\n\t\t\tplanes[ \"YZ\" ].rotation.set( 0, Math.PI / 2, 0 );\r\n\t\t\tplanes[ \"XZ\" ].rotation.set( - Math.PI / 2, 0, 0 );\r\n\r\n\t\t\tfor ( var i in planes ) {\r\n\r\n\t\t\t\tplanes[ i ].name = i;\r\n\t\t\t\tthis.planes.add( planes[ i ] );\r\n\t\t\t\tthis.planes[ i ] = planes[ i ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\t//// HANDLES AND PICKERS\r\n\r\n\t\t\tvar setupGizmos = function( gizmoMap, parent ) {\r\n\r\n\t\t\t\tfor ( var name in gizmoMap ) {\r\n\r\n\t\t\t\t\tfor ( i = gizmoMap[ name ].length; i --; ) {\r\n\r\n\t\t\t\t\t\tvar object = gizmoMap[ name ][ i ][ 0 ];\r\n\t\t\t\t\t\tvar position = gizmoMap[ name ][ i ][ 1 ];\r\n\t\t\t\t\t\tvar rotation = gizmoMap[ name ][ i ][ 2 ];\r\n\r\n\t\t\t\t\t\tobject.name = name;\r\n\r\n\t\t\t\t\t\tif ( position ) object.position.set( position[ 0 ], position[ 1 ], position[ 2 ] );\r\n\t\t\t\t\t\tif ( rotation ) object.rotation.set( rotation[ 0 ], rotation[ 1 ], rotation[ 2 ] );\r\n\r\n\t\t\t\t\t\tparent.add( object );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t\tsetupGizmos( this.handleGizmos, this.handles );\r\n\t\t\tsetupGizmos( this.pickerGizmos, this.pickers );\r\n\r\n\t\t\t// reset Transformations\r\n\r\n\t\t\tthis.traverse( function ( child ) {\r\n\r\n\t\t\t\tif ( child instanceof THREE.Mesh ) {\r\n\r\n\t\t\t\t\tchild.updateMatrix();\r\n\r\n\t\t\t\t\tvar tempGeometry = child.geometry.clone();\r\n\t\t\t\t\ttempGeometry.applyMatrix( child.matrix );\r\n\t\t\t\t\tchild.geometry = tempGeometry;\r\n\r\n\t\t\t\t\tchild.position.set( 0, 0, 0 );\r\n\t\t\t\t\tchild.rotation.set( 0, 0, 0 );\r\n\t\t\t\t\tchild.scale.set( 1, 1, 1 );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t};\r\n\r\n\t\tthis.highlight = function ( axis ) {\r\n\r\n\t\t\tthis.traverse( function( child ) {\r\n\r\n\t\t\t\tif ( child.material && child.material.highlight ) {\r\n\r\n\t\t\t\t\tif ( child.name === axis ) {\r\n\r\n\t\t\t\t\t\tchild.material.highlight( true );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tchild.material.highlight( false );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t};\r\n\r\n\t};\r\n\r\n\tTHREE.TransformGizmo.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.TransformGizmo.prototype.constructor = THREE.TransformGizmo;\r\n\r\n\tTHREE.TransformGizmo.prototype.update = function ( rotation, eye ) {\r\n\r\n\t\tvar vec1 = new THREE.Vector3( 0, 0, 0 );\r\n\t\tvar vec2 = new THREE.Vector3( 0, 1, 0 );\r\n\t\tvar lookAtMatrix = new THREE.Matrix4();\r\n\r\n\t\tthis.traverse( function( child ) {\r\n\r\n\t\t\tif ( child.name.search( \"E\" ) !== - 1 ) {\r\n\r\n\t\t\t\tchild.quaternion.setFromRotationMatrix( lookAtMatrix.lookAt( eye, vec1, vec2 ) );\r\n\r\n\t\t\t} else if ( child.name.search( \"X\" ) !== - 1 || child.name.search( \"Y\" ) !== - 1 || child.name.search( \"Z\" ) !== - 1 ) {\r\n\r\n\t\t\t\tchild.quaternion.setFromEuler( rotation );\r\n\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t};\r\n\r\n\tTHREE.TransformGizmoTranslate = function () {\r\n\r\n\t\tTHREE.TransformGizmo.call( this );\r\n\r\n\t\tvar arrowGeometry = new THREE.Geometry();\r\n\t\tvar mesh = new THREE.Mesh( new THREE.CylinderGeometry( 0, 0.05, 0.2, 12, 1, false ) );\r\n\t\tmesh.position.y = 0.5;\r\n\t\tmesh.updateMatrix();\r\n\r\n\t\tarrowGeometry.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t\tvar lineXGeometry = new THREE.BufferGeometry();\r\n\t\tlineXGeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0,  1, 0, 0 ], 3 ) );\r\n\r\n\t\tvar lineYGeometry = new THREE.BufferGeometry();\r\n\t\tlineYGeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0,  0, 1, 0 ], 3 ) );\r\n\r\n\t\tvar lineZGeometry = new THREE.BufferGeometry();\r\n\t\tlineZGeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0,  0, 0, 1 ], 3 ) );\r\n\r\n\t\tthis.handleGizmos = {\r\n\r\n\t\t\tX: [\r\n\t\t\t\t[ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0xff0000 } ) ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ] ],\r\n\t\t\t\t[ new THREE.Line( lineXGeometry, new GizmoLineMaterial( { color: 0xff0000 } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tY: [\r\n\t\t\t\t[ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x00ff00 } ) ), [ 0, 0.5, 0 ] ],\r\n\t\t\t\t[\tnew THREE.Line( lineYGeometry, new GizmoLineMaterial( { color: 0x00ff00 } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tZ: [\r\n\t\t\t\t[ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x0000ff } ) ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ] ],\r\n\t\t\t\t[ new THREE.Line( lineZGeometry, new GizmoLineMaterial( { color: 0x0000ff } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.OctahedronGeometry( 0.1, 0 ), new GizmoMaterial( { color: 0xffffff, opacity: 0.25 } ) ), [ 0, 0, 0 ], [ 0, 0, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tXY: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.29, 0.29 ), new GizmoMaterial( { color: 0xffff00, opacity: 0.25 } ) ), [ 0.15, 0.15, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tYZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.29, 0.29 ), new GizmoMaterial( { color: 0x00ffff, opacity: 0.25 } ) ), [ 0, 0.15, 0.15 ], [ 0, Math.PI / 2, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tXZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.29, 0.29 ), new GizmoMaterial( { color: 0xff00ff, opacity: 0.25 } ) ), [ 0.15, 0, 0.15 ], [ - Math.PI / 2, 0, 0 ] ]\r\n\t\t\t]\r\n\r\n\t\t};\r\n\r\n\t\tthis.pickerGizmos = {\r\n\r\n\t\t\tX: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), pickerMaterial ), [ 0.6, 0, 0 ], [ 0, 0, - Math.PI / 2 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tY: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), pickerMaterial ), [ 0, 0.6, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), pickerMaterial ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.OctahedronGeometry( 0.2, 0 ), pickerMaterial ) ]\r\n\t\t\t],\r\n\r\n\t\t\tXY: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), pickerMaterial ), [ 0.2, 0.2, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tYZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), pickerMaterial ), [ 0, 0.2, 0.2 ], [ 0, Math.PI / 2, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tXZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.PlaneBufferGeometry( 0.4, 0.4 ), pickerMaterial ), [ 0.2, 0, 0.2 ], [ - Math.PI / 2, 0, 0 ] ]\r\n\t\t\t]\r\n\r\n\t\t};\r\n\r\n\t\tthis.setActivePlane = function ( axis, eye ) {\r\n\r\n\t\t\tvar tempMatrix = new THREE.Matrix4();\r\n\t\t\teye.applyMatrix4( tempMatrix.getInverse( tempMatrix.extractRotation( this.planes[ \"XY\" ].matrixWorld ) ) );\r\n\r\n\t\t\tif ( axis === \"X\" ) {\r\n\r\n\t\t\t\tthis.activePlane = this.planes[ \"XY\" ];\r\n\r\n\t\t\t\tif ( Math.abs( eye.y ) > Math.abs( eye.z ) ) this.activePlane = this.planes[ \"XZ\" ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis === \"Y\" ) {\r\n\r\n\t\t\t\tthis.activePlane = this.planes[ \"XY\" ];\r\n\r\n\t\t\t\tif ( Math.abs( eye.x ) > Math.abs( eye.z ) ) this.activePlane = this.planes[ \"YZ\" ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis === \"Z\" ) {\r\n\r\n\t\t\t\tthis.activePlane = this.planes[ \"XZ\" ];\r\n\r\n\t\t\t\tif ( Math.abs( eye.x ) > Math.abs( eye.y ) ) this.activePlane = this.planes[ \"YZ\" ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis === \"XYZ\" ) this.activePlane = this.planes[ \"XYZE\" ];\r\n\r\n\t\t\tif ( axis === \"XY\" ) this.activePlane = this.planes[ \"XY\" ];\r\n\r\n\t\t\tif ( axis === \"YZ\" ) this.activePlane = this.planes[ \"YZ\" ];\r\n\r\n\t\t\tif ( axis === \"XZ\" ) this.activePlane = this.planes[ \"XZ\" ];\r\n\r\n\t\t};\r\n\r\n\t\tthis.init();\r\n\r\n\t};\r\n\r\n\tTHREE.TransformGizmoTranslate.prototype = Object.create( THREE.TransformGizmo.prototype );\r\n\tTHREE.TransformGizmoTranslate.prototype.constructor = THREE.TransformGizmoTranslate;\r\n\r\n\tTHREE.TransformGizmoRotate = function () {\r\n\r\n\t\tTHREE.TransformGizmo.call( this );\r\n\r\n\t\tvar CircleGeometry = function ( radius, facing, arc ) {\r\n\r\n\t\t\tvar geometry = new THREE.BufferGeometry();\r\n\t\t\tvar vertices = [];\r\n\t\t\tarc = arc ? arc : 1;\r\n\r\n\t\t\tfor ( var i = 0; i <= 64 * arc; ++ i ) {\r\n\r\n\t\t\t\tif ( facing === 'x' ) vertices.push( 0, Math.cos( i / 32 * Math.PI ) * radius, Math.sin( i / 32 * Math.PI ) * radius );\r\n\t\t\t\tif ( facing === 'y' ) vertices.push( Math.cos( i / 32 * Math.PI ) * radius, 0, Math.sin( i / 32 * Math.PI ) * radius );\r\n\t\t\t\tif ( facing === 'z' ) vertices.push( Math.sin( i / 32 * Math.PI ) * radius, Math.cos( i / 32 * Math.PI ) * radius, 0 );\r\n\r\n\t\t\t}\r\n\r\n\t\t\tgeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( vertices, 3 ) );\r\n\t\t\treturn geometry;\r\n\r\n\t\t};\r\n\r\n\t\tthis.handleGizmos = {\r\n\r\n\t\t\tX: [\r\n\t\t\t\t[ new THREE.Line( new CircleGeometry( 1, 'x', 0.5 ), new GizmoLineMaterial( { color: 0xff0000 } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tY: [\r\n\t\t\t\t[ new THREE.Line( new CircleGeometry( 1, 'y', 0.5 ), new GizmoLineMaterial( { color: 0x00ff00 } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tZ: [\r\n\t\t\t\t[ new THREE.Line( new CircleGeometry( 1, 'z', 0.5 ), new GizmoLineMaterial( { color: 0x0000ff } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tE: [\r\n\t\t\t\t[ new THREE.Line( new CircleGeometry( 1.25, 'z', 1 ), new GizmoLineMaterial( { color: 0xcccc00 } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tXYZE: [\r\n\t\t\t\t[ new THREE.Line( new CircleGeometry( 1, 'z', 1 ), new GizmoLineMaterial( { color: 0x787878 } ) ) ]\r\n\t\t\t]\r\n\r\n\t\t};\r\n\r\n\t\tthis.pickerGizmos = {\r\n\r\n\t\t\tX: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.12, 4, 12, Math.PI ), pickerMaterial ), [ 0, 0, 0 ], [ 0, - Math.PI / 2, - Math.PI / 2 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tY: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.12, 4, 12, Math.PI ), pickerMaterial ), [ 0, 0, 0 ], [ Math.PI / 2, 0, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1, 0.12, 4, 12, Math.PI ), pickerMaterial ), [ 0, 0, 0 ], [ 0, 0, - Math.PI / 2 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tE: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.TorusBufferGeometry( 1.25, 0.12, 2, 24 ), pickerMaterial ) ]\r\n\t\t\t],\r\n\r\n\t\t\tXYZE: [\r\n\t\t\t\t[ new THREE.Mesh() ]// TODO\r\n\t\t\t]\r\n\r\n\t\t};\r\n\r\n\t\tthis.setActivePlane = function ( axis ) {\r\n\r\n\t\t\tif ( axis === \"E\" ) this.activePlane = this.planes[ \"XYZE\" ];\r\n\r\n\t\t\tif ( axis === \"X\" ) this.activePlane = this.planes[ \"YZ\" ];\r\n\r\n\t\t\tif ( axis === \"Y\" ) this.activePlane = this.planes[ \"XZ\" ];\r\n\r\n\t\t\tif ( axis === \"Z\" ) this.activePlane = this.planes[ \"XY\" ];\r\n\r\n\t\t};\r\n\r\n\t\tthis.update = function ( rotation, eye2 ) {\r\n\r\n\t\t\tTHREE.TransformGizmo.prototype.update.apply( this, arguments );\r\n\r\n\t\t\tvar tempMatrix = new THREE.Matrix4();\r\n\t\t\tvar worldRotation = new THREE.Euler( 0, 0, 1 );\r\n\t\t\tvar tempQuaternion = new THREE.Quaternion();\r\n\t\t\tvar unitX = new THREE.Vector3( 1, 0, 0 );\r\n\t\t\tvar unitY = new THREE.Vector3( 0, 1, 0 );\r\n\t\t\tvar unitZ = new THREE.Vector3( 0, 0, 1 );\r\n\t\t\tvar quaternionX = new THREE.Quaternion();\r\n\t\t\tvar quaternionY = new THREE.Quaternion();\r\n\t\t\tvar quaternionZ = new THREE.Quaternion();\r\n\t\t\tvar eye = eye2.clone();\r\n\r\n\t\t\tworldRotation.copy( this.planes[ \"XY\" ].rotation );\r\n\t\t\ttempQuaternion.setFromEuler( worldRotation );\r\n\r\n\t\t\ttempMatrix.makeRotationFromQuaternion( tempQuaternion ).getInverse( tempMatrix );\r\n\t\t\teye.applyMatrix4( tempMatrix );\r\n\r\n\t\t\tthis.traverse( function( child ) {\r\n\r\n\t\t\t\ttempQuaternion.setFromEuler( worldRotation );\r\n\r\n\t\t\t\tif ( child.name === \"X\" ) {\r\n\r\n\t\t\t\t\tquaternionX.setFromAxisAngle( unitX, Math.atan2( - eye.y, eye.z ) );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX );\r\n\t\t\t\t\tchild.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( child.name === \"Y\" ) {\r\n\r\n\t\t\t\t\tquaternionY.setFromAxisAngle( unitY, Math.atan2( eye.x, eye.z ) );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionY );\r\n\t\t\t\t\tchild.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( child.name === \"Z\" ) {\r\n\r\n\t\t\t\t\tquaternionZ.setFromAxisAngle( unitZ, Math.atan2( eye.y, eye.x ) );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionZ );\r\n\t\t\t\t\tchild.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t};\r\n\r\n\t\tthis.init();\r\n\r\n\t};\r\n\r\n\tTHREE.TransformGizmoRotate.prototype = Object.create( THREE.TransformGizmo.prototype );\r\n\tTHREE.TransformGizmoRotate.prototype.constructor = THREE.TransformGizmoRotate;\r\n\r\n\tTHREE.TransformGizmoScale = function () {\r\n\r\n\t\tTHREE.TransformGizmo.call( this );\r\n\r\n\t\tvar arrowGeometry = new THREE.Geometry();\r\n\t\tvar mesh = new THREE.Mesh( new THREE.BoxGeometry( 0.125, 0.125, 0.125 ) );\r\n\t\tmesh.position.y = 0.5;\r\n\t\tmesh.updateMatrix();\r\n\r\n\t\tarrowGeometry.merge( mesh.geometry, mesh.matrix );\r\n\r\n\t\tvar lineXGeometry = new THREE.BufferGeometry();\r\n\t\tlineXGeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0,  1, 0, 0 ], 3 ) );\r\n\r\n\t\tvar lineYGeometry = new THREE.BufferGeometry();\r\n\t\tlineYGeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0,  0, 1, 0 ], 3 ) );\r\n\r\n\t\tvar lineZGeometry = new THREE.BufferGeometry();\r\n\t\tlineZGeometry.addAttribute( 'position', new THREE.Float32BufferAttribute( [ 0, 0, 0,  0, 0, 1 ], 3 ) );\r\n\r\n\t\tthis.handleGizmos = {\r\n\r\n\t\t\tX: [\r\n\t\t\t\t[ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0xff0000 } ) ), [ 0.5, 0, 0 ], [ 0, 0, - Math.PI / 2 ] ],\r\n\t\t\t\t[ new THREE.Line( lineXGeometry, new GizmoLineMaterial( { color: 0xff0000 } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tY: [\r\n\t\t\t\t[ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x00ff00 } ) ), [ 0, 0.5, 0 ] ],\r\n\t\t\t\t[ new THREE.Line( lineYGeometry, new GizmoLineMaterial( { color: 0x00ff00 } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tZ: [\r\n\t\t\t\t[ new THREE.Mesh( arrowGeometry, new GizmoMaterial( { color: 0x0000ff } ) ), [ 0, 0, 0.5 ], [ Math.PI / 2, 0, 0 ] ],\r\n\t\t\t\t[ new THREE.Line( lineZGeometry, new GizmoLineMaterial( { color: 0x0000ff } ) ) ]\r\n\t\t\t],\r\n\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.125, 0.125, 0.125 ), new GizmoMaterial( { color: 0xffffff, opacity: 0.25 } ) ) ]\r\n\t\t\t]\r\n\r\n\t\t};\r\n\r\n\t\tthis.pickerGizmos = {\r\n\r\n\t\t\tX: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), pickerMaterial ), [ 0.6, 0, 0 ], [ 0, 0, - Math.PI / 2 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tY: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), pickerMaterial ), [ 0, 0.6, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.CylinderBufferGeometry( 0.2, 0, 1, 4, 1, false ), pickerMaterial ), [ 0, 0, 0.6 ], [ Math.PI / 2, 0, 0 ] ]\r\n\t\t\t],\r\n\r\n\t\t\tXYZ: [\r\n\t\t\t\t[ new THREE.Mesh( new THREE.BoxBufferGeometry( 0.4, 0.4, 0.4 ), pickerMaterial ) ]\r\n\t\t\t]\r\n\r\n\t\t};\r\n\r\n\t\tthis.setActivePlane = function ( axis, eye ) {\r\n\r\n\t\t\tvar tempMatrix = new THREE.Matrix4();\r\n\t\t\teye.applyMatrix4( tempMatrix.getInverse( tempMatrix.extractRotation( this.planes[ \"XY\" ].matrixWorld ) ) );\r\n\r\n\t\t\tif ( axis === \"X\" ) {\r\n\r\n\t\t\t\tthis.activePlane = this.planes[ \"XY\" ];\r\n\t\t\t\tif ( Math.abs( eye.y ) > Math.abs( eye.z ) ) this.activePlane = this.planes[ \"XZ\" ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis === \"Y\" ) {\r\n\r\n\t\t\t\tthis.activePlane = this.planes[ \"XY\" ];\r\n\t\t\t\tif ( Math.abs( eye.x ) > Math.abs( eye.z ) ) this.activePlane = this.planes[ \"YZ\" ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis === \"Z\" ) {\r\n\r\n\t\t\t\tthis.activePlane = this.planes[ \"XZ\" ];\r\n\t\t\t\tif ( Math.abs( eye.x ) > Math.abs( eye.y ) ) this.activePlane = this.planes[ \"YZ\" ];\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( axis === \"XYZ\" ) this.activePlane = this.planes[ \"XYZE\" ];\r\n\r\n\t\t};\r\n\r\n\t\tthis.init();\r\n\r\n\t};\r\n\r\n\tTHREE.TransformGizmoScale.prototype = Object.create( THREE.TransformGizmo.prototype );\r\n\tTHREE.TransformGizmoScale.prototype.constructor = THREE.TransformGizmoScale;\r\n\r\n\tTHREE.TransformControls = function ( camera, domElement ) {\r\n\r\n\t\t// TODO: Make non-uniform scale and rotate play nice in hierarchies\r\n\t\t// TODO: ADD RXYZ contol\r\n\r\n\t\tTHREE.Object3D.call( this );\r\n\r\n\t\tdomElement = ( domElement !== undefined ) ? domElement : document;\r\n\r\n\t\tthis.camera = camera;\r\n\t\tthis.object = undefined;\r\n\t\tthis.visible = false;\r\n\t\tthis.translationSnap = null;\r\n\t\tthis.rotationSnap = null;\r\n\t\tthis.space = \"world\";\r\n\t\tthis.size = 1;\r\n\t\tthis.axis = null;\r\n\r\n\t\tvar scope = this;\r\n\r\n\t\tvar _mode = \"translate\";\r\n\t\tvar _dragging = false;\r\n\t\tvar _gizmo = {\r\n\r\n\t\t\t\"translate\": new THREE.TransformGizmoTranslate(),\r\n\t\t\t\"rotate\": new THREE.TransformGizmoRotate(),\r\n\t\t\t\"scale\": new THREE.TransformGizmoScale()\r\n\t\t};\r\n\r\n\t\tfor ( var type in _gizmo ) {\r\n\r\n\t\t\tvar gizmoObj = _gizmo[ type ];\r\n\r\n\t\t\tgizmoObj.visible = ( type === _mode );\r\n\t\t\tthis.add( gizmoObj );\r\n\r\n\t\t}\r\n\r\n\t\tvar changeEvent = { type: \"change\" };\r\n\t\tvar mouseDownEvent = { type: \"mouseDown\" };\r\n\t\tvar mouseUpEvent = { type: \"mouseUp\", mode: _mode };\r\n\t\tvar objectChangeEvent = { type: \"objectChange\" };\r\n\r\n\t\tvar ray = new THREE.Raycaster();\r\n\t\tvar pointerVector = new THREE.Vector2();\r\n\r\n\t\tvar point = new THREE.Vector3();\r\n\t\tvar offset = new THREE.Vector3();\r\n\r\n\t\tvar rotation = new THREE.Vector3();\r\n\t\tvar offsetRotation = new THREE.Vector3();\r\n\t\tvar scale = 1;\r\n\r\n\t\tvar lookAtMatrix = new THREE.Matrix4();\r\n\t\tvar eye = new THREE.Vector3();\r\n\r\n\t\tvar tempMatrix = new THREE.Matrix4();\r\n\t\tvar tempVector = new THREE.Vector3();\r\n\t\tvar tempQuaternion = new THREE.Quaternion();\r\n\t\tvar unitX = new THREE.Vector3( 1, 0, 0 );\r\n\t\tvar unitY = new THREE.Vector3( 0, 1, 0 );\r\n\t\tvar unitZ = new THREE.Vector3( 0, 0, 1 );\r\n\r\n\t\tvar quaternionXYZ = new THREE.Quaternion();\r\n\t\tvar quaternionX = new THREE.Quaternion();\r\n\t\tvar quaternionY = new THREE.Quaternion();\r\n\t\tvar quaternionZ = new THREE.Quaternion();\r\n\t\tvar quaternionE = new THREE.Quaternion();\r\n\r\n\t\tvar oldPosition = new THREE.Vector3();\r\n\t\tvar oldScale = new THREE.Vector3();\r\n\t\tvar oldRotationMatrix = new THREE.Matrix4();\r\n\r\n\t\tvar parentRotationMatrix  = new THREE.Matrix4();\r\n\t\tvar parentScale = new THREE.Vector3();\r\n\r\n\t\tvar worldPosition = new THREE.Vector3();\r\n\t\tvar worldRotation = new THREE.Euler();\r\n\t\tvar worldRotationMatrix  = new THREE.Matrix4();\r\n\t\tvar camPosition = new THREE.Vector3();\r\n\t\tvar camRotation = new THREE.Euler();\r\n\r\n\t\tdomElement.addEventListener( \"mousedown\", onPointerDown, false );\r\n\t\tdomElement.addEventListener( \"touchstart\", onPointerDown, false );\r\n\r\n\t\tdomElement.addEventListener( \"mousemove\", onPointerHover, false );\r\n\t\tdomElement.addEventListener( \"touchmove\", onPointerHover, false );\r\n\r\n\t\tdomElement.addEventListener( \"mousemove\", onPointerMove, false );\r\n\t\tdomElement.addEventListener( \"touchmove\", onPointerMove, false );\r\n\r\n\t\tdomElement.addEventListener( \"mouseup\", onPointerUp, false );\r\n\t\tdomElement.addEventListener( \"mouseout\", onPointerUp, false );\r\n\t\tdomElement.addEventListener( \"touchend\", onPointerUp, false );\r\n\t\tdomElement.addEventListener( \"touchcancel\", onPointerUp, false );\r\n\t\tdomElement.addEventListener( \"touchleave\", onPointerUp, false );\r\n\r\n\t\tthis.dispose = function () {\r\n\r\n\t\t\tdomElement.removeEventListener( \"mousedown\", onPointerDown );\r\n\t\t\tdomElement.removeEventListener( \"touchstart\", onPointerDown );\r\n\r\n\t\t\tdomElement.removeEventListener( \"mousemove\", onPointerHover );\r\n\t\t\tdomElement.removeEventListener( \"touchmove\", onPointerHover );\r\n\r\n\t\t\tdomElement.removeEventListener( \"mousemove\", onPointerMove );\r\n\t\t\tdomElement.removeEventListener( \"touchmove\", onPointerMove );\r\n\r\n\t\t\tdomElement.removeEventListener( \"mouseup\", onPointerUp );\r\n\t\t\tdomElement.removeEventListener( \"mouseout\", onPointerUp );\r\n\t\t\tdomElement.removeEventListener( \"touchend\", onPointerUp );\r\n\t\t\tdomElement.removeEventListener( \"touchcancel\", onPointerUp );\r\n\t\t\tdomElement.removeEventListener( \"touchleave\", onPointerUp );\r\n\r\n\t\t};\r\n\r\n\t\tthis.attach = function ( object ) {\r\n\r\n\t\t\tthis.object = object;\r\n\t\t\tthis.visible = true;\r\n\t\t\tthis.update();\r\n\r\n\t\t};\r\n\r\n\t\tthis.detach = function () {\r\n\r\n\t\t\tthis.object = undefined;\r\n\t\t\tthis.visible = false;\r\n\t\t\tthis.axis = null;\r\n\r\n\t\t};\r\n\r\n\t\tthis.getMode = function () {\r\n\r\n\t\t\treturn _mode;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setMode = function ( mode ) {\r\n\r\n\t\t\t_mode = mode ? mode : _mode;\r\n\r\n\t\t\tif ( _mode === \"scale\" ) scope.space = \"local\";\r\n\r\n\t\t\tfor ( var type in _gizmo ) _gizmo[ type ].visible = ( type === _mode );\r\n\r\n\t\t\tthis.update();\r\n\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setTranslationSnap = function ( translationSnap ) {\r\n\r\n\t\t\tscope.translationSnap = translationSnap;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setRotationSnap = function ( rotationSnap ) {\r\n\r\n\t\t\tscope.rotationSnap = rotationSnap;\r\n\r\n\t\t};\r\n\r\n\t\tthis.setSize = function ( size ) {\r\n\r\n\t\t\tscope.size = size;\r\n\t\t\tthis.update();\r\n\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t};\r\n\r\n\t\tthis.setSpace = function ( space ) {\r\n\r\n\t\t\tscope.space = space;\r\n\t\t\tthis.update();\r\n\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t};\r\n\r\n\t\tthis.update = function () {\r\n\r\n\t\t\tif ( scope.object === undefined ) return;\r\n\r\n\t\t\tscope.object.updateMatrixWorld();\r\n\t\t\tworldPosition.setFromMatrixPosition( scope.object.matrixWorld );\r\n\t\t\tworldRotation.setFromRotationMatrix( tempMatrix.extractRotation( scope.object.matrixWorld ) );\r\n\r\n\t\t\tscope.camera.updateMatrixWorld();\r\n\t\t\tcamPosition.setFromMatrixPosition( scope.camera.matrixWorld );\r\n\t\t\tcamRotation.setFromRotationMatrix( tempMatrix.extractRotation( scope.camera.matrixWorld ) );\r\n\r\n\t\t\tscale = worldPosition.distanceTo( camPosition ) / 6 * scope.size;\r\n\t\t\tthis.position.copy( worldPosition );\r\n\t\t\tthis.scale.set( scale, scale, scale );\r\n\r\n\t\t\tif ( scope.camera instanceof THREE.PerspectiveCamera ) {\r\n\r\n\t\t\t\teye.copy( camPosition ).sub( worldPosition ).normalize();\r\n\r\n\t\t\t} else if ( scope.camera instanceof THREE.OrthographicCamera ) {\r\n\r\n\t\t\t\teye.copy( camPosition ).normalize();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( scope.space === \"local\" ) {\r\n\r\n\t\t\t\t_gizmo[ _mode ].update( worldRotation, eye );\r\n\r\n\t\t\t} else if ( scope.space === \"world\" ) {\r\n\r\n\t\t\t\t_gizmo[ _mode ].update( new THREE.Euler(), eye );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_gizmo[ _mode ].highlight( scope.axis );\r\n\r\n\t\t};\r\n\r\n\t\tfunction onPointerHover( event ) {\r\n\r\n\t\t\tif ( scope.object === undefined || _dragging === true || ( event.button !== undefined && event.button !== 0 ) ) return;\r\n\r\n\t\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\r\n\r\n\t\t\tvar intersect = intersectObjects( pointer, _gizmo[ _mode ].pickers.children );\r\n\r\n\t\t\tvar axis = null;\r\n\r\n\t\t\tif ( intersect ) {\r\n\r\n\t\t\t\taxis = intersect.object.name;\r\n\r\n\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif ( scope.axis !== axis ) {\r\n\r\n\t\t\t\tscope.axis = axis;\r\n\t\t\t\tscope.update();\r\n\t\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction onPointerDown( event ) {\r\n\r\n\t\t\tif ( scope.object === undefined || _dragging === true || ( event.button !== undefined && event.button !== 0 ) ) return;\r\n\r\n\t\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\r\n\r\n\t\t\tif ( pointer.button === 0 || pointer.button === undefined ) {\r\n\r\n\t\t\t\tvar intersect = intersectObjects( pointer, _gizmo[ _mode ].pickers.children );\r\n\r\n\t\t\t\tif ( intersect ) {\r\n\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tevent.stopPropagation();\r\n\r\n\t\t\t\t\tscope.dispatchEvent( mouseDownEvent );\r\n\r\n\t\t\t\t\tscope.axis = intersect.object.name;\r\n\r\n\t\t\t\t\tscope.update();\r\n\r\n\t\t\t\t\teye.copy( camPosition ).sub( worldPosition ).normalize();\r\n\r\n\t\t\t\t\t_gizmo[ _mode ].setActivePlane( scope.axis, eye );\r\n\r\n\t\t\t\t\tvar planeIntersect = intersectObjects( pointer, [ _gizmo[ _mode ].activePlane ] );\r\n\r\n\t\t\t\t\tif ( planeIntersect ) {\r\n\r\n\t\t\t\t\t\toldPosition.copy( scope.object.position );\r\n\t\t\t\t\t\toldScale.copy( scope.object.scale );\r\n\r\n\t\t\t\t\t\toldRotationMatrix.extractRotation( scope.object.matrix );\r\n\t\t\t\t\t\tworldRotationMatrix.extractRotation( scope.object.matrixWorld );\r\n\r\n\t\t\t\t\t\tparentRotationMatrix.extractRotation( scope.object.parent.matrixWorld );\r\n\t\t\t\t\t\tparentScale.setFromMatrixScale( tempMatrix.getInverse( scope.object.parent.matrixWorld ) );\r\n\r\n\t\t\t\t\t\toffset.copy( planeIntersect.point );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_dragging = true;\r\n\r\n\t\t}\r\n\r\n\t\tfunction onPointerMove( event ) {\r\n\r\n\t\t\tif ( scope.object === undefined || scope.axis === null || _dragging === false || ( event.button !== undefined && event.button !== 0 ) ) return;\r\n\r\n\t\t\tvar pointer = event.changedTouches ? event.changedTouches[ 0 ] : event;\r\n\r\n\t\t\tvar planeIntersect = intersectObjects( pointer, [ _gizmo[ _mode ].activePlane ] );\r\n\r\n\t\t\tif ( planeIntersect === false ) return;\r\n\r\n\t\t\tevent.preventDefault();\r\n\t\t\tevent.stopPropagation();\r\n\r\n\t\t\tpoint.copy( planeIntersect.point );\r\n\r\n\t\t\tif ( _mode === \"translate\" ) {\r\n\r\n\t\t\t\tpoint.sub( offset );\r\n\t\t\t\tpoint.multiply( parentScale );\r\n\r\n\t\t\t\tif ( scope.space === \"local\" ) {\r\n\r\n\t\t\t\t\tpoint.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\r\n\r\n\t\t\t\t\tif ( scope.axis.search( \"X\" ) === - 1 ) point.x = 0;\r\n\t\t\t\t\tif ( scope.axis.search( \"Y\" ) === - 1 ) point.y = 0;\r\n\t\t\t\t\tif ( scope.axis.search( \"Z\" ) === - 1 ) point.z = 0;\r\n\r\n\t\t\t\t\tpoint.applyMatrix4( oldRotationMatrix );\r\n\r\n\t\t\t\t\tscope.object.position.copy( oldPosition );\r\n\t\t\t\t\tscope.object.position.add( point );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( scope.space === \"world\" || scope.axis.search( \"XYZ\" ) !== - 1 ) {\r\n\r\n\t\t\t\t\tif ( scope.axis.search( \"X\" ) === - 1 ) point.x = 0;\r\n\t\t\t\t\tif ( scope.axis.search( \"Y\" ) === - 1 ) point.y = 0;\r\n\t\t\t\t\tif ( scope.axis.search( \"Z\" ) === - 1 ) point.z = 0;\r\n\r\n\t\t\t\t\tpoint.applyMatrix4( tempMatrix.getInverse( parentRotationMatrix ) );\r\n\r\n\t\t\t\t\tscope.object.position.copy( oldPosition );\r\n\t\t\t\t\tscope.object.position.add( point );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ( scope.translationSnap !== null ) {\r\n\r\n\t\t\t\t\tif ( scope.space === \"local\" ) {\r\n\r\n\t\t\t\t\t\tscope.object.position.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( scope.axis.search( \"X\" ) !== - 1 ) scope.object.position.x = Math.round( scope.object.position.x / scope.translationSnap ) * scope.translationSnap;\r\n\t\t\t\t\tif ( scope.axis.search( \"Y\" ) !== - 1 ) scope.object.position.y = Math.round( scope.object.position.y / scope.translationSnap ) * scope.translationSnap;\r\n\t\t\t\t\tif ( scope.axis.search( \"Z\" ) !== - 1 ) scope.object.position.z = Math.round( scope.object.position.z / scope.translationSnap ) * scope.translationSnap;\r\n\r\n\t\t\t\t\tif ( scope.space === \"local\" ) {\r\n\r\n\t\t\t\t\t\tscope.object.position.applyMatrix4( worldRotationMatrix );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( _mode === \"scale\" ) {\r\n\r\n\t\t\t\tpoint.sub( offset );\r\n\t\t\t\tpoint.multiply( parentScale );\r\n\r\n\t\t\t\tif ( scope.space === \"local\" ) {\r\n\r\n\t\t\t\t\tif ( scope.axis === \"XYZ\" ) {\r\n\r\n\t\t\t\t\t\tscale = 1 + ( ( point.y ) / Math.max( oldScale.x, oldScale.y, oldScale.z ) );\r\n\r\n\t\t\t\t\t\tscope.object.scale.x = oldScale.x * scale;\r\n\t\t\t\t\t\tscope.object.scale.y = oldScale.y * scale;\r\n\t\t\t\t\t\tscope.object.scale.z = oldScale.z * scale;\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tpoint.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\r\n\r\n\t\t\t\t\t\tif ( scope.axis === \"X\" ) scope.object.scale.x = oldScale.x * ( 1 + point.x / oldScale.x );\r\n\t\t\t\t\t\tif ( scope.axis === \"Y\" ) scope.object.scale.y = oldScale.y * ( 1 + point.y / oldScale.y );\r\n\t\t\t\t\t\tif ( scope.axis === \"Z\" ) scope.object.scale.z = oldScale.z * ( 1 + point.z / oldScale.z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t} else if ( _mode === \"rotate\" ) {\r\n\r\n\t\t\t\tpoint.sub( worldPosition );\r\n\t\t\t\tpoint.multiply( parentScale );\r\n\t\t\t\ttempVector.copy( offset ).sub( worldPosition );\r\n\t\t\t\ttempVector.multiply( parentScale );\r\n\r\n\t\t\t\tif ( scope.axis === \"E\" ) {\r\n\r\n\t\t\t\t\tpoint.applyMatrix4( tempMatrix.getInverse( lookAtMatrix ) );\r\n\t\t\t\t\ttempVector.applyMatrix4( tempMatrix.getInverse( lookAtMatrix ) );\r\n\r\n\t\t\t\t\trotation.set( Math.atan2( point.z, point.y ), Math.atan2( point.x, point.z ), Math.atan2( point.y, point.x ) );\r\n\t\t\t\t\toffsetRotation.set( Math.atan2( tempVector.z, tempVector.y ), Math.atan2( tempVector.x, tempVector.z ), Math.atan2( tempVector.y, tempVector.x ) );\r\n\r\n\t\t\t\t\ttempQuaternion.setFromRotationMatrix( tempMatrix.getInverse( parentRotationMatrix ) );\r\n\r\n\t\t\t\t\tquaternionE.setFromAxisAngle( eye, rotation.z - offsetRotation.z );\r\n\t\t\t\t\tquaternionXYZ.setFromRotationMatrix( worldRotationMatrix );\r\n\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionE );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionXYZ );\r\n\r\n\t\t\t\t\tscope.object.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t} else if ( scope.axis === \"XYZE\" ) {\r\n\r\n\t\t\t\t\tquaternionE.setFromEuler( point.clone().cross( tempVector ).normalize() ); // rotation axis\r\n\r\n\t\t\t\t\ttempQuaternion.setFromRotationMatrix( tempMatrix.getInverse( parentRotationMatrix ) );\r\n\t\t\t\t\tquaternionX.setFromAxisAngle( quaternionE, - point.clone().angleTo( tempVector ) );\r\n\t\t\t\t\tquaternionXYZ.setFromRotationMatrix( worldRotationMatrix );\r\n\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX );\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionXYZ );\r\n\r\n\t\t\t\t\tscope.object.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t} else if ( scope.space === \"local\" ) {\r\n\r\n\t\t\t\t\tpoint.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\r\n\r\n\t\t\t\t\ttempVector.applyMatrix4( tempMatrix.getInverse( worldRotationMatrix ) );\r\n\r\n\t\t\t\t\trotation.set( Math.atan2( point.z, point.y ), Math.atan2( point.x, point.z ), Math.atan2( point.y, point.x ) );\r\n\t\t\t\t\toffsetRotation.set( Math.atan2( tempVector.z, tempVector.y ), Math.atan2( tempVector.x, tempVector.z ), Math.atan2( tempVector.y, tempVector.x ) );\r\n\r\n\t\t\t\t\tquaternionXYZ.setFromRotationMatrix( oldRotationMatrix );\r\n\r\n\t\t\t\t\tif ( scope.rotationSnap !== null ) {\r\n\r\n\t\t\t\t\t\tquaternionX.setFromAxisAngle( unitX, Math.round( ( rotation.x - offsetRotation.x ) / scope.rotationSnap ) * scope.rotationSnap );\r\n\t\t\t\t\t\tquaternionY.setFromAxisAngle( unitY, Math.round( ( rotation.y - offsetRotation.y ) / scope.rotationSnap ) * scope.rotationSnap );\r\n\t\t\t\t\t\tquaternionZ.setFromAxisAngle( unitZ, Math.round( ( rotation.z - offsetRotation.z ) / scope.rotationSnap ) * scope.rotationSnap );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tquaternionX.setFromAxisAngle( unitX, rotation.x - offsetRotation.x );\r\n\t\t\t\t\t\tquaternionY.setFromAxisAngle( unitY, rotation.y - offsetRotation.y );\r\n\t\t\t\t\t\tquaternionZ.setFromAxisAngle( unitZ, rotation.z - offsetRotation.z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( scope.axis === \"X\" ) quaternionXYZ.multiplyQuaternions( quaternionXYZ, quaternionX );\r\n\t\t\t\t\tif ( scope.axis === \"Y\" ) quaternionXYZ.multiplyQuaternions( quaternionXYZ, quaternionY );\r\n\t\t\t\t\tif ( scope.axis === \"Z\" ) quaternionXYZ.multiplyQuaternions( quaternionXYZ, quaternionZ );\r\n\r\n\t\t\t\t\tscope.object.quaternion.copy( quaternionXYZ );\r\n\r\n\t\t\t\t} else if ( scope.space === \"world\" ) {\r\n\r\n\t\t\t\t\trotation.set( Math.atan2( point.z, point.y ), Math.atan2( point.x, point.z ), Math.atan2( point.y, point.x ) );\r\n\t\t\t\t\toffsetRotation.set( Math.atan2( tempVector.z, tempVector.y ), Math.atan2( tempVector.x, tempVector.z ), Math.atan2( tempVector.y, tempVector.x ) );\r\n\r\n\t\t\t\t\ttempQuaternion.setFromRotationMatrix( tempMatrix.getInverse( parentRotationMatrix ) );\r\n\r\n\t\t\t\t\tif ( scope.rotationSnap !== null ) {\r\n\r\n\t\t\t\t\t\tquaternionX.setFromAxisAngle( unitX, Math.round( ( rotation.x - offsetRotation.x ) / scope.rotationSnap ) * scope.rotationSnap );\r\n\t\t\t\t\t\tquaternionY.setFromAxisAngle( unitY, Math.round( ( rotation.y - offsetRotation.y ) / scope.rotationSnap ) * scope.rotationSnap );\r\n\t\t\t\t\t\tquaternionZ.setFromAxisAngle( unitZ, Math.round( ( rotation.z - offsetRotation.z ) / scope.rotationSnap ) * scope.rotationSnap );\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tquaternionX.setFromAxisAngle( unitX, rotation.x - offsetRotation.x );\r\n\t\t\t\t\t\tquaternionY.setFromAxisAngle( unitY, rotation.y - offsetRotation.y );\r\n\t\t\t\t\t\tquaternionZ.setFromAxisAngle( unitZ, rotation.z - offsetRotation.z );\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tquaternionXYZ.setFromRotationMatrix( worldRotationMatrix );\r\n\r\n\t\t\t\t\tif ( scope.axis === \"X\" ) tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionX );\r\n\t\t\t\t\tif ( scope.axis === \"Y\" ) tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionY );\r\n\t\t\t\t\tif ( scope.axis === \"Z\" ) tempQuaternion.multiplyQuaternions( tempQuaternion, quaternionZ );\r\n\r\n\t\t\t\t\ttempQuaternion.multiplyQuaternions( tempQuaternion, quaternionXYZ );\r\n\r\n\t\t\t\t\tscope.object.quaternion.copy( tempQuaternion );\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tscope.update();\r\n\t\t\tscope.dispatchEvent( changeEvent );\r\n\t\t\tscope.dispatchEvent( objectChangeEvent );\r\n\r\n\t\t}\r\n\r\n\t\tfunction onPointerUp( event ) {\r\n\r\n\t\t\tevent.preventDefault(); // Prevent MouseEvent on mobile\r\n\r\n\t\t\tif ( event.button !== undefined && event.button !== 0 ) return;\r\n\r\n\t\t\tif ( _dragging && ( scope.axis !== null ) ) {\r\n\r\n\t\t\t\tmouseUpEvent.mode = _mode;\r\n\t\t\t\tscope.dispatchEvent( mouseUpEvent );\r\n\r\n\t\t\t}\r\n\r\n\t\t\t_dragging = false;\r\n\r\n\t\t\tif ( 'TouchEvent' in window && event instanceof TouchEvent ) {\r\n\r\n\t\t\t\t// Force \"rollover\"\r\n\r\n\t\t\t\tscope.axis = null;\r\n\t\t\t\tscope.update();\r\n\t\t\t\tscope.dispatchEvent( changeEvent );\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tonPointerHover( event );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tfunction intersectObjects( pointer, objects ) {\r\n\r\n\t\t\tvar rect = domElement.getBoundingClientRect();\r\n\t\t\tvar x = ( pointer.clientX - rect.left ) / rect.width;\r\n\t\t\tvar y = ( pointer.clientY - rect.top ) / rect.height;\r\n\r\n\t\t\tpointerVector.set( ( x * 2 ) - 1, - ( y * 2 ) + 1 );\r\n\t\t\tray.setFromCamera( pointerVector, scope.camera );\r\n\r\n\t\t\tvar intersections = ray.intersectObjects( objects, true );\r\n\t\t\treturn intersections[ 0 ] ? intersections[ 0 ] : false;\r\n\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tTHREE.TransformControls.prototype = Object.create( THREE.Object3D.prototype );\r\n\tTHREE.TransformControls.prototype.constructor = THREE.TransformControls;\r\n\r\n}() );\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/min-dependencies/lib/three/controls/TransformControls.js","import Dimensions from \"../../components/box/Dimensions\";\r\n\r\nconst type = 'Volume';\r\nconst _box3 = Symbol('box3');\r\n\r\nclass Volume {\r\n    constructor(){\r\n        /**\r\n         * @type {THREE.Vector3}\r\n         */\r\n        this.position = new THREE.Vector3();\r\n\r\n        /**\r\n         * @type {Dimensions}\r\n         */\r\n        this.dimensions = new Dimensions();\r\n\r\n        this[_box3] = new THREE.Box3();\r\n    }\r\n\r\n    /** @returns {THREE.Box3} */\r\n    get box3(){\r\n        /** @type {THREE.Box3} */\r\n        let b = this[_box3];\r\n        b.setFromCenterAndSize(this.position, this.dimensions.vec3);\r\n        return b;\r\n    }\r\n\r\n    toJSON(){\r\n        return {\r\n            type: type,\r\n            position: this.position,\r\n            dimensions: this.dimensions\r\n        };\r\n    }\r\n\r\n    ToString(){\r\n        return this.dimensions.ToString();\r\n    }\r\n\r\n    static FromJSON(data, volume){\r\n        if( ! volume ) {\r\n            if(data.type !== type) console.warn('Data supplied is not: ' + type);\r\n\r\n            volume = new Volume();\r\n        }\r\n\r\n        volume.position = new THREE.Vector3(data.position.x, data.position.y, data.position.z);\r\n        volume.dimensions = Dimensions.FromJSON(data.dimensions);\r\n\r\n        return volume;\r\n    }\r\n}\r\n\r\nexport default Volume;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/container/Volume.js","/** @author chadiik <http://chadiik.com/> */\r\n\r\nimport { Container, Item } from \"./Components\";\r\nimport Utils from \"../../utils/cik/Utils\";\r\nimport Region from \"./Region\";\r\nimport RegionsTree from \"./RegionsTree\";\r\nimport { PackedItem, PackedContainer } from \"./PackedComponents\";\r\n\r\nimport { debugging, debugClear, debugLog, debugRegion, sleep, format } from './CUBDebug';\r\nimport HeuLessWaste from \"./HeuLessWaste\";\r\nimport Heuristic from \"./Heuristic\";\r\nimport HeuRegular from \"./HeuRegular\";\r\nimport HeuParametric1 from \"./HeuParametric1\";\r\n\r\n//#region typedefs\r\n/** @typedef Vec2 @property {Number} x @property {Number} y */\r\n\r\n/**\r\n * @typedef CUBParams\r\n * @property {Number} minZ_weight score for tightly packing in length (Z)\r\n * @property {Number} minWaste_weight score for minimizing wasted space\r\n */\r\n\r\n/**\r\n * @typedef PackingAssistantParams extends CUBParams\r\n * @property {Array<Number>} minDimensionsNoWasteFactor\r\n * @property {Number} minZ_weight score for tightly packing in length (Z)\r\n * @property {Number} minWaste_weight score for minimizing wasted space\r\n */\r\n\r\n//#endregion \r\n\r\n/** @type {CUBParams} */\r\nconst defaultParams = {\r\n    minZ_weight: .9,\r\n    minWaste_weight: .1\r\n};\r\n\r\n/** @type {PackingAssistantParams} */\r\nconst defaultPackingAssitantParams = {\r\n    minDimensionsNoWasteFactor: [1, 1, 1]\r\n};\r\n\r\nconst epsilon = Math.pow(2, -52);\r\nconst smallValue = .000001;\r\n\r\nvar tempRegion = new Region();\r\nvar tempRegion2 = new Region();\r\n\r\nclass PackingAssistant{\r\n    /**\r\n     * \r\n     * @param {Container} container \r\n     * @param {PackingAssistantParams} params \r\n     */\r\n    constructor(container, params){\r\n        \r\n        this.params = Utils.AssignUndefined(Object.assign({}, params), defaultPackingAssitantParams);\r\n        this.container = container;\r\n        this.packedContainer = new PackedContainer(container);\r\n\r\n        let firstRegion = new Region(0, 0, 0, container.width, container.height, container.length, 0);\r\n            firstRegion.SetWeights(0, container.weightCapacity, 0);\r\n        this.regionsTree = new RegionsTree(firstRegion);\r\n\r\n\r\n\r\n        /** @type {Item} */\r\n        this.workingItem;\r\n    }\r\n\r\n    /** @param {PackedItem} packedItem @param {Boolean} [harsh] default = false */\r\n    ProcessRegionsPerPackedItem(packedItem, harsh){\r\n        let regions = this.regionsTree.regions;\r\n        let itemVolume = packedItem.ref.volume;\r\n        \r\n        // Creates temporary region for following calculations\r\n        let packedRegion = tempRegion.Set(packedItem.x, packedItem.y, packedItem.z, packedItem.packedWidth, packedItem.packedHeight, packedItem.packedLength, 0);\r\n        packedRegion.SetWeights(packedItem.ref.weight, 0, packedItem.ref.stackingCapacity);\r\n\r\n        for(let iRegion = 0; iRegion < regions.length; iRegion++){\r\n            let region = regions[iRegion];\r\n\r\n            if(itemVolume > region.volume && packedRegion.ContainsRegion(smallValue, region)){\r\n                regions.splice(iRegion, 1);\r\n                iRegion--;\r\n                console.log('Contained region' + iRegion + ' deleted');\r\n                continue;\r\n            }\r\n\r\n            if(packedRegion.Intersects(-smallValue, region)){\r\n\r\n                if(harsh){\r\n                    console.log('\\tIntersecting region' + iRegion + ' deleted (!)');\r\n                    regions.slice(iRegion, 1);\r\n                    iRegion--;\r\n                    continue;\r\n                }\r\n                \r\n                let regionRemains = this.regionsTree.Occupy(region, packedRegion);\r\n                iRegion --;\r\n            }\r\n        }\r\n    }\r\n\r\n    ProcessRegionsForPackedItems(harsh){\r\n        let packedItems = this.packedContainer.packedItems;\r\n        let numPackedItems = packedItems.length;\r\n\r\n        for(let iItem = 0; iItem < numPackedItems; iItem++){\r\n            let packedItem = packedItems[iItem];\r\n            this.ProcessRegionsPerPackedItem(packedItem, harsh);\r\n        }\r\n    }\r\n\r\n    ProcessRegions(){\r\n\r\n        let containerWidth = this.container.width,\r\n            containerHeight = this.container.height;\r\n\r\n        // Recalculate preferred insertion side per region (left or right)\r\n        this.regionsTree.ProcessRegionsPreferredX(containerWidth);\r\n\r\n        // Merge and expand free regions (can span several packed item tops)\r\n        this.regionsTree.ProcessRegionsMergeExpand(containerWidth, containerHeight);\r\n\r\n        // Removes regions that are completely enclosed in packed volumes, and correct any intersecting ones\r\n        this.ProcessRegionsForPackedItems(false);\r\n\r\n        // Removes unuseable regions\r\n        this.regionsTree.ProcessRegionsForZeroRegions();\r\n\r\n        // Removes regions that are completely enclosed in larger regions\r\n        this.regionsTree.ProcessRegionsEnclosed();\r\n\r\n        // Recalculate preferred insertion side per region (left or right)\r\n        this.regionsTree.ProcessRegionsPreferredX(containerWidth);\r\n\r\n        // Sort by z (first) and volume (second)\r\n        this.regionsTree.Sort(Region.SortDeepestSmallest);\r\n    }\r\n\r\n    /** @param {Item} item @param {Heuristic} heuristics */\r\n    FitUsingHeuristic(item, heuristics){\r\n        // General weight check\r\n        if(this.packedContainer.WeightPass(item.weight) === false) return false;\r\n                \r\n        let result = heuristics.Fit(item);\r\n\r\n        if(result){\r\n            let placement = result.packedRegion;\r\n            placement.SetWeights(item.weight, 0, item.stackingCapacity);\r\n\r\n            // Create a new packed item\r\n            let packedItem = new PackedItem(item, placement.x, placement.y, placement.z, placement.width, placement.height, placement.length, result.orientation);\r\n\r\n            // Reserve the tested sub region: regionFitTest from the containing region: region\r\n            let regionRemains = this.regionsTree.Occupy(result.containingRegion, placement);\r\n\r\n            return packedItem;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /** @param {Array<Item>} items @param {Heuristic} heuristics */\r\n    async Solve(items, heuristics){\r\n        let packedContainer = this.packedContainer;\r\n        let iItem = items.length - 1;\r\n\r\n        // Helper function\r\n        function unpackItem(index){\r\n            let item = items[index];\r\n            packedContainer.Unpack(item);\r\n            items.splice(index, 1);\r\n            iItem--;\r\n        }\r\n\r\n        // Helper function\r\n        /** @param {Number} index * @param {PackedItem} item */\r\n        function packItem(index, item){\r\n            packedContainer.Pack(item);\r\n            \r\n            item.ref.quantity--;\r\n            if(item.ref.quantity === 0){\r\n                items.splice(index, 1);\r\n                iItem--;\r\n            }\r\n        }\r\n\r\n        const workingSet = {\r\n            items: items,\r\n            packedContainer: packedContainer,\r\n            regionsTree: this.regionsTree\r\n        };\r\n\r\n        heuristics.workingSet = workingSet;\r\n\r\n        let heuRegular = new HeuRegular(Object.assign({}, this.params));\r\n            heuRegular.workingSet = workingSet;\r\n\r\n        while(items.length > 0){\r\n            let item = items[iItem];\r\n\r\n            this.ProcessRegions();\r\n            packedContainer.packedItems.sort(PackedItem.Sort);\r\n\r\n            // Try to pack item\r\n            let packedItem = this.FitUsingHeuristic(item, heuristics);\r\n            if( packedItem === false ){\r\n                // Fallback to regular fitting if failed\r\n                packedItem = this.FitUsingHeuristic(item, heuRegular);\r\n            }\r\n\r\n            if( packedItem === false ){\r\n\r\n                /**/debugLog('item fitting failed.');\r\n                unpackItem(iItem);\r\n            }\r\n            else{\r\n\r\n                packItem(iItem, packedItem);\r\n            }\r\n\r\n            /**/await sleep(16);\r\n        }\r\n\r\n        return packedContainer;\r\n    }\r\n\r\n}\r\n\r\n/**\r\n * \r\n * @param {Container} container \r\n * @param {Array<Item>} items // this array (and content) will be changed/emptied\r\n * @param {CUBParams} params \r\n */\r\nasync function pack(container, items, params){\r\n\r\n    params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n    let packingAssistant = new PackingAssistant(container, params);\r\n\r\n    function heuLessWaste(){\r\n        return new HeuLessWaste(Object.assign({}, packingAssistant.params));\r\n    }\r\n\r\n    function heuParametric1(){\r\n        let heuParams = new HeuParametric1.Params(params);\r\n        return new HeuParametric1(heuParams);\r\n    }\r\n\r\n    let heuristics = heuLessWaste();\r\n    let result = await packingAssistant.Solve(items, heuristics);\r\n    \r\n    return result;\r\n}\r\n\r\nexport {\r\n    pack\r\n};\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/CUB.js","import Item from \"./components/Item\";\r\nimport Container from \"./components/Container\";\r\n\r\n\r\n/**\r\n * @param {Array<Object>} objects \r\n * @param {Array<string>} m - mapping to Item.constructor, ie: [ID, Length, ...]\r\n */\r\nfunction toItems(objects, m){\r\n    var items = [];\r\n    objects.forEach(o => {\r\n        items.push(new Item(o[m[0]], o[m[1]], o[m[2]], o[m[3]], o[m[4]]));\r\n    });\r\n    return items;\r\n}\r\n\r\nclass TestData{\r\n    /**\r\n     * @param {Container} container \r\n     * @param {Array<Item>} items \r\n     */\r\n    constructor(container, items){\r\n        this.container = container;\r\n        this.items = items;\r\n    }\r\n}\r\n\r\nclass AFitTest{\r\n\r\n    static GenerateDataSample1(){\r\n        var containerData = { ID: 1000, Name: 'Box1', Length: 15, Width: 13, Height: 9 };\r\n        var itemsData = [\r\n            { ID: 1000, Name: 'Item1', Length: 5,  Width: 4, Height: 2, Quantity: 1 },\r\n\t\t    { ID: 1001, Name: 'Item2', Length: 2,  Width: 1, Height: 1, Quantity: 3 },\r\n\t\t    { ID: 1002, Name: 'Item3', Length: 9,  Width: 7, Height: 3, Quantity: 4 },\r\n\t\t    { ID: 1003, Name: 'Item4', Length: 13, Width: 6, Height: 3, Quantity: 8 },\r\n\t\t    { ID: 1004, Name: 'Item5', Length: 17, Width: 8, Height: 6, Quantity: 1 },\r\n            { ID: 1005, Name: 'Item6', Length: 3,  Width: 3, Height: 2, Quantity: 2 }\r\n        ];\r\n\r\n        var container = Object.assign(new Container(), containerData);\r\n        var items = toItems(itemsData, ['ID', 'Length', 'Width', 'Height', 'Quantity']);\r\n\r\n        var data = new TestData(container, items);\r\n        return data;\r\n    }\r\n\r\n    static GenerateDataSample2(){\r\n        var containerData = { ID: 1000, Name: 'Box1', Length: 60, Width: 35, Height: 25 };\r\n        var itemsData = [\r\n            { ID: 1000, Name: 'Item1', Length: 30,  Width: 50, Height: 20, Quantity: 1 },\r\n\t\t    { ID: 1003, Name: 'Item4', Length: 13, Width: 6, Height: 3, Quantity: 6 },\r\n\t\t    { ID: 1004, Name: 'Item5', Length: 17, Width: 8, Height: 6, Quantity: 3 },\r\n            { ID: 1005, Name: 'Item6', Length: 5,  Width: 5, Height: 2, Quantity: 16 }\r\n        ];\r\n\r\n        var container = Object.assign(new Container(), containerData);\r\n        var items = toItems(itemsData, ['ID', 'Length', 'Width', 'Height', 'Quantity']);\r\n\r\n        var data = new TestData(container, items);\r\n        return data;\r\n    }\r\n\r\n    static GenerateDataSampleFlatdeck(){\r\n        var containerData = { ID: 1000, Name: 'Box1', Length: 576, Width: 102, Height: 102 };\r\n        var itemsData = [\r\n            { ID: 1000, Name: 'Item1', Length: 100,  Width: 70, Height: 90, Quantity: 3 },\r\n\t\t    { ID: 1003, Name: 'Item4', Length: 60, Width: 60, Height: 60, Quantity: 7 },\r\n\t\t    { ID: 1004, Name: 'Item5', Length: 40, Width: 20, Height: 30, Quantity: 4 },\r\n            { ID: 1005, Name: 'Item6', Length: 30,  Width: 20, Height: 30, Quantity: 20 }\r\n        ];\r\n\r\n        var container = Object.assign(new Container(), containerData);\r\n        var items = toItems(itemsData, ['ID', 'Length', 'Width', 'Height', 'Quantity']);\r\n\r\n        var data = new TestData(container, items);\r\n        return data;\r\n    }\r\n\r\n    static GenerateDataSampleFlatdeck2(){\r\n        var containerData = { ID: 1000, Name: 'Box1', Length: 576, Width: 102, Height: 102, WeightCapacity: 48000 };\r\n        var itemsData = [\r\n            { ID: 1000, Name: 'Item1', Length: 100,  Width: 70, Height: 90, Quantity: 3 },\r\n\t\t    { ID: 1003, Name: 'Item4', Length: 60, Width: 60, Height: 60, Quantity: 7, StackingCapacity: 0 },\r\n\t\t    { ID: 1004, Name: 'Item5', Length: 40, Width: 28, Height: 30, Quantity: 4 },\r\n            { ID: 1005, Name: 'Item6', Length: 30,  Width: 23, Height: 34, Quantity: 20 },\r\n            { ID: 1005, Name: 'Item6', Length: 45,  Width: 20, Height: 30, Quantity: 30 },\r\n            { ID: 1005, Name: 'Item6', Length: 35,  Width: 22, Height: 18, Quantity: 27 }\r\n        ];\r\n\r\n        var container = Object.assign(new Container(), containerData);\r\n        var items = toItems(itemsData, ['ID', 'Length', 'Width', 'Height', 'Quantity']);\r\n\r\n        var data = new TestData(container, items);\r\n        return data;\r\n    }\r\n}\r\n\r\nexport default AFitTest;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/afit/AFitTest.js","\r\nfunction almost(n1, n2){\r\n    return Math.abs(n1 - n2) < .01;\r\n}\r\n\r\nclass Item{\r\n    /**\r\n     * @param {Object} id \r\n     * @param {Number} dim1 \r\n     * @param {Number} dim2 \r\n     * @param {Number} dim3 \r\n     * @param {Number} quantity \r\n     */\r\n    constructor(id, dim1, dim2, dim3, quantity){\r\n        this.ID = id;\r\n        this.IsPacked = false;\r\n        this.Dim1 = dim2;\r\n        this.Dim2 = dim1;\r\n        this.Dim3 = dim3;\r\n        this.CoordX = 0;\r\n        this.CoordY = 0;\r\n        this.CoordZ = 0;\r\n        this.Quantity = quantity;\r\n        this.PackDimX = 0;\r\n        this.PackDimY = 0;\r\n        this.PackDimZ = 0;\r\n        this.Volume = this.Dim1 * this.Dim2 * this.Dim3;\r\n    }\r\n\r\n    /** \r\n     * @param {Item} item\r\n     * @returns {string} - axis order (xyz, xzy, yxz, yzx, zxy or zyx)\r\n     */\r\n    static ResolveOrientation(item){\r\n        var w = item.Dim1, l = item.Dim2, h = item.Dim3;\r\n\r\n        if(almost(item.PackDimX, w)){ // x\r\n            if(almost(item.PackDimY, h)){ // y\r\n                return 'xyz';\r\n            }\r\n            else if(almost(item.PackDimY, l)){ // z\r\n                return 'xzy';\r\n            }\r\n        }\r\n        else if(almost(item.PackDimX, h)){ // y\r\n            if(almost(item.PackDimY, w)){ // x\r\n                return 'yxz';\r\n            }\r\n            else if(almost(item.PackDimY, l)){ // z\r\n                return 'yzx';\r\n            }\r\n        }\r\n        else if(almost(item.PackDimX, l)){ // z\r\n            if(almost(item.PackDimY, w)){ // x\r\n                return 'zxy';\r\n            }\r\n            else if(almost(item.PackDimY, h)){ // y\r\n                return 'zyx';\r\n            }\r\n        }\r\n\r\n        return 'xyz';\r\n    }\r\n}\r\n\r\nexport default Item;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/afit/components/Item.js","\r\nclass Container{\r\n    /**\r\n     * @param {Object} id \r\n     * @param {Number} width \r\n     * @param {Number} length \r\n     * @param {Number} height \r\n     */\r\n    constructor(id, width, length, height){\r\n        this.ID = id;\r\n\r\n        this.Width = length || 0;\r\n        this.Length = width || 0;\r\n        this.Height = height || 0;\r\n    }\r\n}\r\n\r\nexport default Container;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/afit/components/Container.js","import Heuristic from \"./Heuristic\";\r\nimport Utils from \"../../utils/cik/Utils\";\r\nimport { Item, Container } from \"./Components\";\r\nimport Region from \"./Region\";\r\nimport { PackedItem, PackedContainer } from \"./PackedComponents\";\r\nimport RegionsTree from \"./RegionsTree\";\r\n\r\n/** @typedef {import('./Heuristic').HeuristicParams HeuLessWasteParams} */\r\n/** @typedef HeuLessWasteSet @property {HeuLessWasteParams} params @property {Array<Item>} items @property {PackedContainer} packedContainer @property {RegionsTree} regionsTree */\r\n\r\nconst smallValue = .000001;\r\nconst minRegionAxis = smallValue;\r\n\r\nvar tempRegion = new Region();\r\nvar tempRegion2 = new Region();\r\n\r\nfunction sortByN(a, b){\r\n    if(isNaN(a.n) || isNaN(b.n)) return 0;\r\n\r\n    if(a.n < b.n) return -1;\r\n    if(a.n > b.n) return 1;\r\n    return 0;\r\n}\r\n\r\n/**\r\n * @param {Region} fit \r\n * @param {Array<Region>} newRegions \r\n */\r\nfunction rateFit(fit, newRegions){\r\n\r\n    /** @type {HeuLessWasteSet} */\r\n    const w = this;\r\n    \r\n    // Try out a recursive deep rate fit\r\n    var containerLength = w.packedContainer.container.length;\r\n    var minDimensions = w.minDimensions;\r\n    var minDimensionsNoWasteFactor = w.minDimensionsNoWasteFactor;\r\n    var minZScore = 1 - (fit.z + fit.length) / containerLength; // 0-1\r\n    // new regions usability score\r\n    var minWasteScore = 1; // have completely filled the region if newRegions.length === 0\r\n    if(newRegions.length > 0){\r\n        minWasteScore = 0;\r\n        for(let iRegion = 0; iRegion < newRegions.length; iRegion++){\r\n            let region = newRegions[iRegion];\r\n            \r\n            let scoreW = 0, scoreH = 0, scoreL = 0;\r\n            if(region.width >= minDimensions[0] && (region.width - minDimensions[0]) < minDimensions[0] * minDimensionsNoWasteFactor[0]) scoreW += 1;\r\n            if(region.height >= minDimensions[1] && (region.width - minDimensions[1]) < minDimensions[1] * minDimensionsNoWasteFactor[1]) scoreH += 1;\r\n            if(region.length >= minDimensions[2] && (region.width - minDimensions[2]) < minDimensions[2] * minDimensionsNoWasteFactor[2]) scoreL += 1;\r\n            \r\n            minWasteScore += scoreW * .5 + scoreH * .3 + scoreL * .2;\r\n        }\r\n        minWasteScore /= newRegions.length;\r\n    }\r\n    var minZ_weight = w.params.minZ_weight;\r\n    var minWaste_weight = w.params.minWaste_weight;\r\n    var score = minZScore * minZ_weight + minWasteScore * minWaste_weight;\r\n    return score;\r\n}\r\n\r\n/** @param {Region} region */\r\nfunction highestScoreFunction(region){\r\n    /** @type {Item} */ \r\n    let item = this.workingItem;\r\n    \r\n    /** @typedef PlacementScore @property {Region} region region @property {Number} orientation orientation index @property {Number} n score */\r\n    /** @type {Array<PlacementScore>} */ \r\n    let regionScoreTable = this.regionScoreTable;\r\n    \r\n    let orientationScoreTable = this.orientationScoreTable;\r\n\r\n    let volumeItem = item.volume,\r\n        validOrientations = item.validOrientations;\r\n    \r\n    if(region.volume > volumeItem){\r\n        let dummyRegion = tempRegion2.Copy(region);\r\n\r\n        orientationScoreTable.length = 0;\r\n        for(let iOrient = 0; iOrient < validOrientations.length; iOrient++){\r\n            let orientation = validOrientations[iOrient];\r\n\r\n            let dimensions = item.GetOrientedDimensions(orientation);\r\n            let regionFitTest = region.FitTest(smallValue, \r\n                dimensions[0], dimensions[1], dimensions[2], \r\n                item.weight, item.grounded);\r\n            \r\n            if(regionFitTest !== false){\r\n\r\n                // Subtracts fit from region and calculates new bounding regions\r\n                let newRegions = dummyRegion.Subtract(regionFitTest, minRegionAxis);\r\n                if(newRegions === undefined) newRegions = [];\r\n                if(dummyRegion.length > minRegionAxis)\r\n                    newRegions.push(dummyRegion);\r\n\r\n                let orientationScore = {\r\n                    region: region,\r\n                    orientation: orientation, \r\n                    n: rateFit.call(this, regionFitTest, newRegions)\r\n                };\r\n                orientationScoreTable.push(orientationScore);\r\n            }\r\n        }\r\n\r\n        if(orientationScoreTable.length > 0){\r\n            orientationScoreTable.sort(sortByN);\r\n            let regionScore = orientationScoreTable.pop();\r\n            regionScoreTable.push(regionScore);\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nclass HeuLessWaste extends Heuristic{\r\n    /** @param {HeuLessWasteParams} params */\r\n    constructor(params){\r\n        super(params);\r\n\r\n        /** @type {HeuLessWasteSet} */\r\n        this.workingSet;\r\n    }\r\n\r\n    /** @param {Array<Item>} items */\r\n    GetMinDimensionsOverall(items){\r\n        var minDimensions = [Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER];\r\n\r\n        for(let iItem = 0, numItems = items.length; iItem < numItems; iItem++){\r\n            let item = items[iItem];\r\n            let validOrientations = item.validOrientations;\r\n            for(let iOrient = 0; iOrient < validOrientations.length; iOrient++){\r\n                let orientation = validOrientations[iOrient];\r\n                let dimensions = item.GetOrientedDimensions(orientation);\r\n                if(dimensions[0] < minDimensions[0]) minDimensions[0] = dimensions[0];\r\n                if(dimensions[1] < minDimensions[1]) minDimensions[1] = dimensions[1];\r\n                if(dimensions[2] < minDimensions[2]) minDimensions[2] = dimensions[2];\r\n            }\r\n        }\r\n\r\n        return minDimensions;\r\n    }\r\n\r\n    Init(){\r\n        super.Init();\r\n\r\n        const minDimensionsNoWasteFactor = [1, 1, 1];\r\n\r\n        let w = this.workingSet;\r\n        let workingItems = w.items.slice();\r\n            workingItems.sort(Item.VolumeSort);\r\n        let minDimensions = this.GetMinDimensionsOverall(workingItems);\r\n        \r\n        w.params = this.params;\r\n        w.minDimensions = minDimensions;\r\n        w.minDimensionsNoWasteFactor = minDimensionsNoWasteFactor;\r\n    }\r\n\r\n    /** @param {Item} item */\r\n    GetPlacementWithHighestScore(item){\r\n\r\n        /** @typedef PlacementScore @property {Number} region region index @property {Number} orientation orientation index @property {Number} n score */\r\n        /** @type {Array<PlacementScore>} */\r\n        let regionScoreTable = [],\r\n            orientationScoreTable = [];\r\n        let testSuccessfulRegions = 4;\r\n\r\n        let w = this.workingSet;\r\n            w.workingItem = item;\r\n            w.regionScoreTable = regionScoreTable;\r\n            w.orientationScoreTable = orientationScoreTable;\r\n            w.testSuccessfulRegions = testSuccessfulRegions;\r\n\r\n        // Try to fit in sorted regions\r\n        w.regionsTree.Find(highestScoreFunction, w);\r\n\r\n        if(regionScoreTable.length === 0){\r\n            return false;\r\n        }\r\n\r\n        regionScoreTable.sort(sortByN);\r\n        let highestScore = regionScoreTable.pop();\r\n        let containingRegion = highestScore.region,\r\n            orientation = item.validOrientations[highestScore.orientation];\r\n\r\n        let dimensions = item.GetOrientedDimensions(orientation);\r\n\r\n        // Fit test (success: Region, failure: false)\r\n        let regionFitTest = containingRegion.FitTest(smallValue, \r\n            dimensions[0], dimensions[1], dimensions[2],\r\n            item.weight, item.grounded,\r\n            tempRegion);\r\n        if(regionFitTest !== false){\r\n    \r\n            // Stacking & weight test \r\n    \r\n            let result = new Heuristic.Result(containingRegion, regionFitTest, orientation);\r\n            return result;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    /** @param {Item} item */\r\n    Fit(item){\r\n        let result = super.Fit(item);\r\n        \r\n        let w = this.workingSet;\r\n\r\n        // General weight check\r\n        if(w.packedContainer.WeightPass(item.weight) === false) return false;\r\n        \r\n        let highestScored = this.GetPlacementWithHighestScore(item);\r\n\r\n        if(highestScored){\r\n            if(result === undefined) result = new Heuristic.Result(highestScored.containingRegion, highestScored.packedRegion, highestScored.orientation);\r\n            else result.Copy(highestScored);\r\n        }\r\n\r\n        return result || false;\r\n    }\r\n\r\n}\r\n\r\nexport default HeuLessWaste;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/HeuLessWaste.js","import Heuristic from \"./Heuristic\";\r\nimport Utils from \"../../utils/cik/Utils\";\r\nimport { Item, Container } from \"./Components\";\r\nimport Region from \"./Region\";\r\nimport { PackedItem, PackedContainer } from \"./PackedComponents\";\r\nimport RegionsTree from \"./RegionsTree\";\r\n\r\n/** @typedef {import('./Heuristic').HeuristicParams HeuRegularParams} */\r\n/** @typedef HeuRegularSet @property {Array<Item>} items @property {PackedContainer} packedContainer @property {RegionsTree} regionsTree */\r\n\r\nconst epsilon = Math.pow(2, -52);\r\nconst smallValue = .000001;\r\n\r\nvar tempRegion = new Region();\r\n\r\n/** @param {Region} region */\r\nfunction firstFitFunction(region){\r\n    let item = this.workingItem;\r\n    let validOrientations = item.validOrientations;\r\n    for(let iOrient = 0; iOrient < validOrientations.length; iOrient++){\r\n        let orientation = validOrientations[iOrient];\r\n\r\n        let dimensions = item.GetOrientedDimensions(orientation);\r\n\r\n        // Fit test (success: Region, failure: false)\r\n        let regionFitTest = region.FitTest(smallValue, \r\n            dimensions[0], dimensions[1], dimensions[2],\r\n            item.weight, item.grounded,\r\n            tempRegion);\r\n        if(regionFitTest !== false){\r\n\r\n            // Stacking & weight test \r\n\r\n            let result = new Heuristic.Result(region, regionFitTest, orientation);\r\n            return result;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nclass HeuRegular extends Heuristic{\r\n    /** @param {HeuRegularParams} params */\r\n    constructor(params){\r\n        super(params);\r\n\r\n        /** @type {HeuRegularSet} */\r\n        this.workingSet;\r\n    }\r\n\r\n    /** @param {Item} item */\r\n    Fit(item){\r\n        let result = super.Fit(item);\r\n        \r\n        let w = this.workingSet;\r\n\r\n        // General weight check\r\n        if(w.packedContainer.WeightPass(item.weight) === false) return false;\r\n\r\n        w.workingItem = item;\r\n        /** @type {Heuristic.Result} */\r\n        let firstFit = w.regionsTree.Find(firstFitFunction, w);\r\n        if(firstFit){\r\n            if(result === undefined) result = new Heuristic.Result(firstFit.containingRegion, firstFit.packedRegion, firstFit.orientation);\r\n            else result.Copy(firstFit);\r\n        }\r\n\r\n        return result || false;\r\n    }\r\n\r\n}\r\n\r\nexport default HeuRegular;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/HeuRegular.js","import Heuristic from \"./Heuristic\";\r\nimport Utils from \"../../utils/cik/Utils\";\r\nimport { Item } from \"./Components\";\r\nimport { PackedContainer } from \"./PackedComponents\";\r\nimport RegionsTree from \"./RegionsTree\";\r\n\r\n/** @typedef {import('./CUB').CUBParams} CUBParams */\r\n\r\nclass HeuParametric1Params{\r\n    /** @param {CUBParams} cubParams */\r\n    constructor(cubParams){\r\n        this.cub = cubParams;\r\n    }\r\n}\r\n\r\nclass HeuParametric1Set{\r\n    /**\r\n     * \r\n     * @param {Array<Item>} items \r\n     * @param {PackedContainer} packedContainer \r\n     * @param {RegionsTree} regionsTree \r\n     */\r\n    constructor(items, packedContainer, regionsTree){\r\n        this.items = items;\r\n        this.packedContainer = packedContainer;\r\n        this.regionsTree = regionsTree;\r\n    }\r\n}\r\n\r\nclass HeuParametric1 extends Heuristic{\r\n    /** @param {HeuParametric1Params} params */\r\n    constructor(params){\r\n        super(params);\r\n\r\n        /** @type {HeuParametric1Params} */\r\n        this.params;\r\n        /** @type {HeuParametric1Set} */\r\n        this.workingSet;\r\n    }\r\n\r\n    Init(){\r\n        if( (this.workingSet instanceof HeuParametric1Set) === false ){\r\n            super.Init();\r\n\r\n            this.workingSet = new HeuParametric1Set(this.workingSet.items, this.workingSet.packedContainer, this.workingSet.regionsTree);\r\n\r\n\r\n        }\r\n    }\r\n\r\n    /** @param {Item} item */\r\n    GetBestFit(item){\r\n        if(false) return new Heuristic.Result();\r\n        return false;\r\n    }\r\n\r\n    /** @param {Item} item */\r\n    Fit(item){\r\n        let result = super.Fit(item);\r\n        \r\n        let w = this.workingSet;\r\n\r\n        // General weight check\r\n        if(w.packedContainer.WeightPass(item.weight) === false) return false;\r\n        \r\n        let bestFit = this.GetBestFit(item);\r\n\r\n        if(bestFit){\r\n            if(result === undefined) result = new Heuristic.Result(bestFit.containingRegion, bestFit.packedRegion, bestFit.orientation);\r\n            else result.Copy(bestFit);\r\n        }\r\n\r\n        return result || false;\r\n    }\r\n}\r\n\r\nHeuParametric1.Params = HeuParametric1Params;\r\nHeuParametric1.Set = HeuParametric1Set;\r\n\r\nexport default HeuParametric1;\n\n\n// WEBPACK FOOTER //\n// ./src/api/packer/cub/HeuParametric1.js","import CargoListView from \"./CargoListView\";\r\nimport Packer from \"../packer/Packer\";\r\nimport CargoList from \"../packer/CargoList\";\r\nimport PackingSpaceView from \"./PackingSpaceView\";\r\nimport PackingSpace from \"../packer/PackingSpace\";\r\nimport SceneSetup from \"../view/SceneSetup\";\r\nimport Utils from \"../utils/cik/Utils\";\r\nimport PackResultView from \"./PackResultView\";\r\nimport UpdateComponent from \"../utils/cik/input/UpdateComponent\";\r\nimport Container from \"../packer/container/Container\";\r\nimport BoxEntry from \"../components/box/BoxEntry\";\r\nimport DomUI from \"./dom/DomUI\";\r\nimport OrthoviewsNavigator from \"./OrthoviewsNavigator\";\r\nimport Camera from \"../scene/Camera\";\r\n\r\n/**\r\n * @typedef {Object} ViewParams\r\n * @property {import('../UX').default} ux\r\n * @property {Number} transitionDuration\r\n * @property {Object} cargoListView\r\n * @property {Number} cargoListView.paddingZ\r\n * @property {Number} cargoListView.paddingY\r\n * @property {import('./CargoListView').CargoListViewParams} cargoListView.params\r\n * @property {Object} packResultView\r\n * @property {import('./PackResultView').PackResultViewParams} packResultView.params\r\n */\r\n\r\n /** @type {ViewParams} */\r\nconst defaultParams = {\r\n    ux: undefined,\r\n    transitionDuration: 1.5,\r\n    cargoListView: {\r\n        paddingZ: 120,\r\n        paddingY: 40,\r\n        params: {}\r\n    },\r\n    packResultView: {\r\n        params: {\r\n            animationDuration: 1\r\n        }\r\n    }\r\n};\r\n\r\nvar tempBox3 = new THREE.Box3();\r\nvar tempVec = new THREE.Vector3();\r\n\r\nclass View {\r\n    /**\r\n     * Constructor\r\n     * @param {Packer} packer \r\n     * @param {DomUI} domUI; \r\n     * @param {SceneSetup} sceneSetup \r\n     * @param {ViewParams} params \r\n     */\r\n    constructor(packer, sceneSetup, domUI, params){\r\n\r\n        this.sceneSetup = sceneSetup;\r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n\r\n        this.domUI = domUI;\r\n        this.domUI.CreateOrthoViewsIcons();\r\n        this.domUI.On(DomUI.signals.orthoViewSelected, this.OnOrthoViewSelected.bind(this));\r\n\r\n        var scope = this;\r\n        var units = this.params.ux.params.units;\r\n\r\n        // Fill lights\r\n        if(true){\r\n            let lights = this.sceneSetup.DefaultLights(this.sceneSetup.sceneController, true, true);\r\n\r\n            let dl = lights.filter(light => light instanceof THREE.DirectionalLight)[0];\r\n            let dlData = {\"color\":\"0xfceeee\",\"intensity\":1,\"castShadow\":true,\"shadow.bias\":0.00001,\"shadow.radius\":4,\"shadow.mapSize.x\":4096,\"shadow.mapSize.y\":4096,\"shadow.camera.left\":-400,\"shadow.camera.top\":300,\"shadow.camera.right\":400,\"shadow.camera.bottom\":-300,\"shadow.camera.near\":20,\"shadow.camera.far\":800};\r\n            let Config = require('../utils/cik/config/Config').default;\r\n            Config.Load(dl, dlData);\r\n\r\n            if(this.sceneSetup.ux.params.hud){\r\n                this.sceneSetup.DefaultLights(this.sceneSetup.hud);\r\n            }\r\n\r\n            let dlComp = lights.filter(light => light instanceof THREE.DirectionalLight)[1];\r\n            dlComp.castShadow = true;\r\n        }\r\n\r\n        let orthoviewsNavParams = {ux: this.params.ux};\r\n        this.orthoviewsNavigator = new OrthoviewsNavigator(this.sceneSetup.cameraController, orthoviewsNavParams);\r\n\r\n        // Packing space\r\n        this.packingSpaceView = new PackingSpaceView();\r\n        this.sceneSetup.sceneController.AddDefault(this.packingSpaceView.view);\r\n        /** @param {Container} container */\r\n        function onContainerAdded(container){\r\n            /** @type {THREE.Box3} */\r\n            let box3 = container.combinedVolume.box3;\r\n            scope.sceneSetup.cameraController.TransitionToFrame(1, box3, scope.params.transitionDuration);\r\n\r\n            scope.packingSpaceView.Add(container);\r\n\r\n            tempBox3.setFromObject(scope.packingSpaceView.view);\r\n            tempBox3.getSize(tempVec);\r\n\r\n            let containerSize = Math.max(tempVec.x, tempVec.y, tempVec.z);\r\n            scope.cargoListView.view.position.z = containerSize / 2 + scope.params.cargoListView.paddingZ * units;\r\n            scope.cargoListView.view.position.y = scope.params.cargoListView.paddingY * units;\r\n        }\r\n        packer.packingSpace.On(PackingSpace.signals.containerAdded, onContainerAdded);\r\n\r\n        // Cargo list\r\n        this.params.cargoListView.params.ux = this.params.ux;\r\n        this.cargoListView = new CargoListView(this.params.cargoListView.params);\r\n\r\n        this.sceneSetup.input.AddRaycastGroup('OnClick', 'cargoListView', this.cargoListView.raycastGroup);\r\n\r\n        this.sceneSetup.sceneController.AddDefault(this.cargoListView.view);\r\n\r\n        function onCargoListViewChanged(){\r\n            tempBox3.setFromObject(scope.cargoListView.view);\r\n            tempBox3.getCenter(tempVec);\r\n            let listViewCenterX = tempVec.x;\r\n            scope.cargoListView.view.getWorldPosition(tempVec);\r\n            let offsetX = listViewCenterX - tempVec.x;\r\n\r\n            /** @type {THREE.Box3} */\r\n            let box3 = tempBox3;\r\n            scope.sceneSetup.cameraController.TransitionToFrame(1, box3, scope.params.transitionDuration);\r\n\r\n            tempBox3.setFromObject(scope.packingSpaceView.view);\r\n            tempBox3.getCenter(tempVec);\r\n            let centerX = tempVec.x;\r\n\r\n            scope.cargoListView.view.position.x = centerX - offsetX;\r\n        }\r\n        function onCargoGroupAdded(group){\r\n            scope.cargoListView.Add(group);\r\n            onCargoListViewChanged();\r\n        }\r\n        packer.cargoList.On(CargoList.signals.groupAdded, onCargoGroupAdded);\r\n        function onCargoGroupRemoved(group){\r\n            scope.cargoListView.Remove(group);\r\n            onCargoListViewChanged();\r\n        }\r\n        packer.cargoList.On(CargoList.signals.groupRemoved, onCargoGroupRemoved);\r\n        function onCargoGroupModified(group){\r\n            scope.cargoListView.UpdateGroup(group);\r\n            onCargoListViewChanged();\r\n        }\r\n        packer.cargoList.On(CargoList.signals.groupModified, onCargoGroupModified);\r\n\r\n        // Packing result\r\n        this.params.packResultView.params.ux = this.params.ux;\r\n        this.packResultView = new PackResultView(this.cargoListView, this.packingSpaceView, this.params.packResultView.params);\r\n        this.sceneSetup.sceneController.AddDefault(this.packResultView.view);\r\n\r\n        /** @param {Packer.PackingResult} packingResult */\r\n        async function onPackUpdate(packingResult){\r\n            scope.orthoviewsNavigator.Navigate(OrthoviewsNavigator.orthoviews.home, false);\r\n            await scope.packResultView.DisplayPackingResult(packingResult);\r\n        }\r\n        packer.On(Packer.signals.packUpdate, onPackUpdate);\r\n\r\n        var updateComponent = new UpdateComponent(true, 1/30, this.Update.bind(this));\r\n        this.sceneSetup.input.updateComponents.push(updateComponent);\r\n\r\n        this.orthoviewsNavigator.boundingView = this.packingSpaceView.view;\r\n        this.orthoviewsNavigator.cargoListView = this.cargoListView;\r\n\r\n        if(this.params.ux.params.hud){\r\n            this.HUDSetup();\r\n        }\r\n\r\n        if(this.params.ux.params.configure){\r\n            this.Configure();\r\n        }\r\n    }\r\n\r\n    /** @param {Number} now */\r\n    Update(now){\r\n        this.packResultView.Update();\r\n        this.cargoListView.Update();\r\n    }\r\n\r\n    HUDSetup(){\r\n        var units = this.params.ux.params.units;\r\n        var input = this.sceneSetup.input;\r\n        var hud = this.sceneSetup.hud;\r\n        var scope = this;\r\n\r\n\r\n    }\r\n\r\n    ClearPackingResults(){\r\n        this.packResultView.Clear();\r\n    }\r\n\r\n    /** @param {DomUI.orthoviews} viewType */\r\n    OnOrthoViewSelected(viewType){\r\n        switch(viewType){\r\n            case DomUI.orthoviews.home:     this.orthoviewsNavigator.Navigate(OrthoviewsNavigator.orthoviews.home);     break;\r\n            case DomUI.orthoviews.top:      this.orthoviewsNavigator.Navigate(OrthoviewsNavigator.orthoviews.top);      break;\r\n            case DomUI.orthoviews.front:    this.orthoviewsNavigator.Navigate(OrthoviewsNavigator.orthoviews.front);    break;\r\n            case DomUI.orthoviews.side:     this.orthoviewsNavigator.Navigate(OrthoviewsNavigator.orthoviews.side);     break;\r\n        }\r\n    }\r\n\r\n    Configure(){\r\n\r\n        var Smart = require('../utils/cik/config/Smart').default;\r\n        var Config = require('../utils/cik/config/Config').default;\r\n        var Control3D = require('../utils/cik/config/Control3D').default;\r\n\r\n        var scope = this;\r\n        var input = this.sceneSetup.input;\r\n\r\n        if(this.params.ux.params.hud){\r\n            var hudControl3D = Control3D.Request('hud');\r\n\r\n            Config.MakeShortcut('Configure', 'Show HUDControl3D', function(){\r\n                hudControl3D.Toggle(scope.cargoListView.view);\r\n            });\r\n        }\r\n    }\r\n}\r\n\r\nexport default View;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/View.js","import CargoBoxView from \"./CargoBoxView\";\r\nimport BoxEntry from \"../components/box/BoxEntry\";\r\nimport Asset from \"../components/assets/Asset\";\r\n\r\nconst unitCubeEdgeGeometry = new THREE.EdgesGeometry(new THREE.BoxBufferGeometry(1, 1, 1, 1, 1, 1));\r\nconst wireframeMaterialTemplate = new THREE.LineBasicMaterial({color: 0xffffff, flatShading: true});\r\n\r\nconst _wireMaterialSettings = Symbol('wireMatSet');\r\n\r\nclass PackedCargoBoxView extends CargoBoxView {\r\n    /**\r\n     * @param {BoxEntry} boxEntry \r\n     */\r\n    constructor(boxEntry){\r\n        super(boxEntry);\r\n\r\n        var meshMaterial = this.mesh.material;\r\n        meshMaterial.polygonOffset = true;\r\n        meshMaterial.polygonOffsetFactor = 1;\r\n        meshMaterial.polygonOffsetUnits = 1;\r\n        meshMaterial.transparent = true;\r\n        meshMaterial.opacity = .5;\r\n        meshMaterial.blending = THREE.NormalBlending;\r\n        meshMaterial.depthTest = true;\r\n        meshMaterial.depthWrite = false;\r\n\r\n        this.mesh.castShadow = this.mesh.receiveShadow = true;\r\n\r\n        var material = wireframeMaterialTemplate.clone();\r\n        this.wireMesh = new THREE.LineSegments(unitCubeEdgeGeometry, material);\r\n        this.wireMesh.renderOrder = Number.MAX_SAFE_INTEGER - 1;\r\n        this.wireMesh.scale.copy(boxEntry.dimensions.vec3);\r\n\r\n        this.view.add(this.wireMesh);\r\n    }\r\n\r\n    /** @returns {BoxEntry} */\r\n    get entry(){ return super.entry; }\r\n    set entry(value){\r\n        super.entry = value;\r\n        this.scale = value.dimensions.vec3;\r\n    }\r\n\r\n    /** @param {Number} value */\r\n    set focus(value){\r\n        super.focus = value;\r\n\r\n        if(this[_wireMaterialSettings]) Asset.RestoreMaterial(this.wireMesh.material, this[_wireMaterialSettings]);\r\n\r\n        if(Math.abs(1 - value) > .0001){\r\n            if(this[_wireMaterialSettings] === undefined){\r\n                this.wireMesh.material = this.wireMesh.material.clone();\r\n                this[_wireMaterialSettings] = {};\r\n                Asset.SetMaterialFocus(this.wireMesh.material, value, this[_wireMaterialSettings]);\r\n            }\r\n            else{\r\n                Asset.SetMaterialFocus(this.wireMesh.material, value);\r\n            }\r\n        }\r\n    }\r\n\r\n    get focus(){ return super.focus; }\r\n\r\n    /**\r\n     * @param {Number} x \r\n     * @param {Number} y \r\n     * @param {Number} z \r\n     */\r\n    SetScale(x, y, z){\r\n        this.mesh.scale.set(x, y, z);\r\n        this.wireMesh.scale.set(x, y, z);\r\n    }\r\n\r\n    /**\r\n     * @param {Number} x in radians\r\n     * @param {Number} y in radians\r\n     * @param {Number} z in radians\r\n     */\r\n    SetRotationAngles(x, y, z){\r\n        this.mesh.rotation.set(x, y, z);\r\n        this.wireMesh.rotation.set(x, y, z);\r\n    }\r\n\r\n    /**\r\n     * @param {CargoBoxView} cargoView \r\n     */\r\n    Extend(cargoView){\r\n        this.entry = cargoView.entry;\r\n        this.mesh.material.color = cargoView.mesh.material.color;\r\n    }\r\n}\r\n\r\nexport default PackedCargoBoxView;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/PackedCargoBoxView.js","import PackResultView from \"../PackResultView\";\r\nimport Packer from \"../../packer/Packer\";\r\nimport Pool from \"../../utils/cik/Pool\";\r\n\r\nvar tempRange = [];\r\n\r\nclass Range{\r\n    /**\r\n     * \r\n     * @param {Array<Number>} args [min,max...] pairs\r\n     */\r\n    constructor(...args){\r\n        /** @type {Array<Number>} */\r\n        this.min = [];\r\n        /** @type {Array<Number>} */\r\n        this.max = [];\r\n\r\n        for(let i = 0, halfLength = args.length; i < halfLength; i++){\r\n            this.min.push(args[i * 2]);\r\n            this.max.push(args[i * 2 + 1]);\r\n        }\r\n    }\r\n\r\n    /** @param {Array<Number>} args */\r\n    Min(...args){\r\n        this.min.length = 0;\r\n        this.min.push(...args);\r\n        return this;\r\n    }\r\n\r\n    /** @param {Array<Number>} args */\r\n    Max(...args){\r\n        this.max.length = 0;\r\n        this.max.push(...args);\r\n        return this;\r\n    }\r\n\r\n    /** @param {Number} index @returns {Number} */\r\n    Length(index){\r\n        return this.max[index] - this.min[index];\r\n    }\r\n\r\n    /** @param {Array<Number>} args */\r\n    Evaluate(...args){\r\n        tempRange.length = 0;\r\n        for(let i = 0; i < args.length; i++){\r\n            let min = this.min[i],\r\n                max = this.max[i],\r\n                v = args[i];\r\n            let value = v * (max - min) + min;\r\n            tempRange.push(value);\r\n        }\r\n        return tempRange;\r\n    }\r\n}\r\n\r\nconst range = {\r\n    frequency: 0,\r\n    volume: 1\r\n};\r\n\r\nconst _playing = Symbol('playing');\r\nconst _iid = Symbol('iid');\r\n\r\nclass Note{\r\n    constructor(){\r\n        this.wave = new Pizzicato.Sound({ \r\n            source: 'wave', \r\n            options: {\r\n                type: 'sine',\r\n                frequency: 440\r\n            }\r\n        });\r\n\r\n        this[_playing] = false;\r\n    }\r\n\r\n    /** @param {Number} value */\r\n    set frequency(value){\r\n        this.wave.frequency = value;\r\n    }\r\n\r\n    /** @returns {Boolean} */\r\n    get playing(){ return this[_playing]; }\r\n\r\n    Play(duration){\r\n        this[_playing] = true;\r\n        this.wave.play();\r\n        let scope = this;\r\n        function onNoteComplete(){ scope.Stop(); }\r\n        this[_iid] = window.setTimeout(onNoteComplete, Math.floor(duration * 1000));\r\n    }\r\n\r\n    Stop(){\r\n        if(this[_iid] !== undefined) window.clearTimeout(this[_iid]);\r\n        this[_iid] = undefined;\r\n\r\n        this.wave.stop();\r\n        this[_playing] = false;\r\n    }\r\n}\r\n\r\n/**\r\n * @returns {Note}\r\n */\r\nfunction poolNewFN(){\r\n    let note = new Note();\r\n    return note;\r\n}\r\n\r\n/**\r\n * @param {Note} object \r\n * @returns {Note}\r\n */\r\nfunction poolResetFN(object){\r\n    return object;\r\n}\r\n\r\nclass Toner{\r\n    constructor(){\r\n\r\n        this.pool = new Pool(poolNewFN, poolResetFN);\r\n        \r\n        this.ranges = new Range(\r\n            100, 900, // freq\r\n            0, 1, // volume\r\n            0.2, 0.8 // duration\r\n        );\r\n\r\n        window.Toner = this;\r\n    }\r\n\r\n    GetNote(){\r\n        /** @type {Note} */\r\n        let note = this.pool.Request();\r\n        return note;\r\n    }\r\n\r\n    RelaseNote(note){\r\n        this.pool.Return(note);\r\n    }\r\n\r\n    /** @param {Number} x @param {Number} y @param {Number} z */\r\n    Coords(x, y, z){\r\n\r\n        const divs = 6;\r\n        let divLength = this.ranges.Length(range.frequency) / divs;\r\n        let values = this.ranges.Evaluate(x, y, z);\r\n\r\n        let frequency = Math.floor(values[0]),\r\n            volume = values[1],\r\n            duration = values[2];\r\n\r\n        let note = this.GetNote();\r\n        note.frequency = frequency;\r\n        note.Play(duration);\r\n\r\n        let scope = this;\r\n        function onNoteComplete(){\r\n            scope.RelaseNote(note);\r\n        }\r\n        window.setInterval(onNoteComplete, Math.floor(duration * 1000));\r\n    }\r\n}\r\n\r\nclass Musipack{\r\n    /**\r\n     * \r\n     * @param {PackResultView} packResultView \r\n     */\r\n    constructor(packResultView){\r\n\r\n        console.log('Musicpack hooked in!');\r\n\r\n        this.toner = new Toner();\r\n\r\n        packResultView.Once(PackResultView.signals.packVizStart, function(){\r\n            packResultView.params.animationDuration = 8;\r\n        });\r\n        \r\n        packResultView.On(PackResultView.signals.cargoVizPack, this.OnItemPacked.bind(this));\r\n        packResultView.On(PackResultView.signals.cargoVizUnpack, this.OnItemUnpacked.bind(this));\r\n    }\r\n\r\n    /** @param {Packer.PackedCargo} item */\r\n    OnItemPacked(item){\r\n        this.EvaluateItem(item);\r\n    }\r\n\r\n    /** @param {Packer.PackedCargo} item */\r\n    OnItemUnpacked(item){\r\n        this.EvaluateItem(item);\r\n    }\r\n\r\n    /** @param {Packer.PackedCargo} item */\r\n    EvaluateItem(item){\r\n        if(item && item.position){\r\n            let x = item.position.x,\r\n                y = item.position.y,\r\n                z = item.position.z;\r\n\r\n            let w = item.containingVolume.dimensions.width,\r\n                h = item.containingVolume.dimensions.height,\r\n                l = item.containingVolume.dimensions.length;\r\n            \r\n            this.toner.Coords(x / w, y / h, z / l);\r\n        }\r\n    }\r\n}\r\n\r\nexport default Musipack;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/components/Musipack.js","import UX from \"../UX\";\r\nimport Camera from \"../scene/Camera\";\r\nimport Utils from \"../utils/cik/Utils\";\r\nimport CargoListView from \"./CargoListView\";\r\n\r\n/** @typedef OrthoviewsNavigatorParams @property {UX} ux @property {Number} transitionDuration */\r\n/** @type {OrthoviewsNavigatorParams} */\r\nconst defaultParams = {\r\n    transitionDuration: 1\r\n};\r\n\r\nconst orthoviews = {\r\n    home: 'home',\r\n    top: 'top',\r\n    front: 'front',\r\n    side: 'side'\r\n};\r\n\r\nvar tempBox3 = new THREE.Box3(),\r\n    tempVec3 = new THREE.Vector3(),\r\n    tempCamOffset = new THREE.Vector3();\r\n\r\n/** @type {import('../scene/Camera').FrameCoords} */\r\nvar tempCoords = {position: new THREE.Vector3(), center: new THREE.Vector3()};\r\n\r\nconst _cargoListView = Symbol('cargoListView'),\r\n    _boundingView = Symbol('boundingView');\r\n\r\nclass OrthoviewsNavigator{\r\n    /** @param {Camera} cameraController @param {OrthoviewsNavigatorParams} params */\r\n    constructor(cameraController, params){\r\n        \r\n        this.params = Utils.AssignUndefined(params, defaultParams);\r\n        this.cameraController = cameraController;\r\n\r\n        const Smart = require('../utils/cik/config/Smart').default;\r\n        const Config = require('../utils/cik/config/Config').default;\r\n        const Control3D = require('../utils/cik/config/Control3D').default;\r\n\r\n        let scope = this;\r\n        let smart = new Smart(this.cameraController.camera, 'FOV');\r\n        smart.MakeShortcut('Configure');\r\n        function onChange(){\r\n            scope.cameraController.camera.updateProjectionMatrix();\r\n        }\r\n        smart.Config(null, this.cameraController.camera, onChange, Smart.serializeModes.none,\r\n            'fov'\r\n        );\r\n    }\r\n\r\n    /** @param {THREE.Object3D} boundingView */\r\n    set boundingView(value){\r\n        this[_boundingView] = value;\r\n    }\r\n\r\n    get boundingView(){ return this[_boundingView]; }\r\n\r\n    /** @param {CargoListView} value */\r\n    set cargoListView(value){\r\n        this[_cargoListView] = value;\r\n    }\r\n\r\n    get cargoListView(){ return this[_cargoListView]; }\r\n\r\n    /** @param {orthoviews} viewType @param {Boolean} changeFOV */\r\n    Navigate(viewType, changeFOV){\r\n\r\n        const duration = 1;\r\n\r\n        var distanceMultiplier = .3;\r\n        var fov = changeFOV === undefined || changeFOV === true ? 8 : this.params.ux.params.fov;\r\n        var slideDown = true;\r\n\r\n        tempBox3.setFromObject(this.boundingView);\r\n        \r\n        let orientation = tempCamOffset;\r\n        switch(viewType){\r\n            case orthoviews.home:  \r\n                orientation.set(1, -1, 1);\r\n                fov = this.params.ux.params.fov;\r\n                distanceMultiplier = .5;\r\n                break;\r\n\r\n            case orthoviews.top:\r\n                orientation.set(0.01, -1, 0);\r\n                distanceMultiplier = .3;\r\n                break;\r\n\r\n            case orthoviews.front:\r\n                this.cargoListView.SlideUp(tempBox3.max.y + 40 * this.params.ux.params.units, duration);\r\n                distanceMultiplier = .2;\r\n                slideDown = false;\r\n                orientation.set(0, 0, 1);\r\n                break;\r\n\r\n            case orthoviews.side:\r\n                distanceMultiplier = .3;\r\n                orientation.set(1, 0, 0);\r\n                break;\r\n        }\r\n\r\n        if(slideDown) this.cargoListView.SlideDown(duration);\r\n\r\n        this.cameraController.TransitionToFOV(duration * 1.5, fov);\r\n\r\n        let endCoords = this.cameraController.CalcFrameCoords(tempBox3, distanceMultiplier, orientation, fov);\r\n        this.cameraController.TransitionFromToCoords(this.params.transitionDuration, undefined, endCoords);\r\n    }\r\n\r\n    static get orthoviews(){\r\n        return orthoviews;\r\n    }\r\n}\r\n\r\nexport default OrthoviewsNavigator;\n\n\n// WEBPACK FOOTER //\n// ./src/api/view/OrthoviewsNavigator.js"],"sourceRoot":""}